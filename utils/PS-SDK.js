const a0_0x49dc72=a0_0x3e29;(function(_0x66a72c,_0x42cc66){const _0x3d14af=a0_0x3e29,_0x574f83=_0x66a72c();while(!![]){try{const _0x46ae57=parseInt(_0x3d14af(0x203))/0x1*(parseInt(_0x3d14af(0x1ec))/0x2)+parseInt(_0x3d14af(0x1d4))/0x3+-parseInt(_0x3d14af(0x21b))/0x4+parseInt(_0x3d14af(0x1ef))/0x5+-parseInt(_0x3d14af(0x234))/0x6*(parseInt(_0x3d14af(0x1d3))/0x7)+parseInt(_0x3d14af(0x220))/0x8*(parseInt(_0x3d14af(0x1e3))/0x9)+-parseInt(_0x3d14af(0x1c9))/0xa*(parseInt(_0x3d14af(0x1ca))/0xb);if(_0x46ae57===_0x42cc66)break;else _0x574f83['push'](_0x574f83['shift']());}catch(_0x2c3822){_0x574f83['push'](_0x574f83['shift']());}}}(a0_0x1f7d,0xda377));const {app,action,core,imaging}=require('photoshop'),{batchPlay}=action,fs=require('uxp')['storage'][a0_0x49dc72(0x1fa)],formats=require(a0_0x49dc72(0x1d0))[a0_0x49dc72(0x1fd)][a0_0x49dc72(0x1cf)],executeAsModal=core[a0_0x49dc72(0x1b9)],PngEncoder=require(a0_0x49dc72(0x1f8));let isProcessing=![];const val=_0x47a4dc=>{const _0x193b16=a0_0x49dc72;if(_0x47a4dc===null||_0x47a4dc===undefined)return 0x0;if(typeof _0x47a4dc===_0x193b16(0x22f))return _0x47a4dc;if(typeof _0x47a4dc===_0x193b16(0x211)){if(typeof _0x47a4dc['value']===_0x193b16(0x22f))return _0x47a4dc[_0x193b16(0x1fe)];if(_0x47a4dc[_0x193b16(0x1eb)]!==undefined)return _0x47a4dc[_0x193b16(0x1eb)];for(let _0x4f1165 in _0x47a4dc){if(typeof _0x47a4dc[_0x4f1165]===_0x193b16(0x211)){const _0x5a6bcf=val(_0x47a4dc[_0x4f1165]);if(typeof _0x5a6bcf===_0x193b16(0x22f))return _0x5a6bcf;}}}const _0x3cdf8f=parseFloat(_0x47a4dc);return isNaN(_0x3cdf8f)?0x0:_0x3cdf8f;};async function getSelectionInfo(){const _0xab6a17=a0_0x49dc72;try{const _0x315303=require(_0xab6a17(0x1ff))[_0xab6a17(0x235)][_0xab6a17(0x1f7)];if(_0x315303&&_0x315303[_0xab6a17(0x1e8)]){const _0xf04344=_0x315303[_0xab6a17(0x1e8)][_0xab6a17(0x21e)];if(_0xf04344&&val(_0xf04344[_0xab6a17(0x1bb)])-val(_0xf04344[_0xab6a17(0x1cd)])>0x0)return _0xf04344;}}catch(_0x2b318e){}try{const _0x18e936=await action[_0xab6a17(0x1db)]([{'_obj':_0xab6a17(0x1d9),'_target':[{'_ref':_0xab6a17(0x1fc),'_property':'selection'},{'_ref':_0xab6a17(0x1bd),'_enum':_0xab6a17(0x20d),'_value':'targetEnum'}]}],{'synchronousExecution':!![]});if(_0x18e936&&_0x18e936[0x0]&&_0x18e936[0x0][_0xab6a17(0x1e8)]){const _0x1c20e1=_0x18e936[0x0]['selection'];return _0x1c20e1;}}catch(_0x30495d){}return null;}async function fetchPixels(_0x3b5303,{layerID:_0x40ef39,targetSize:_0x5c5a18,applyAlpha:applyAlpha=!![]}={}){const _0x496c1b=a0_0x49dc72,_0x5d8a46={'documentID':_0x3b5303['id'],'applyAlpha':applyAlpha};if(_0x40ef39)_0x5d8a46[_0x496c1b(0x1bc)]=_0x40ef39;if(_0x5c5a18)_0x5d8a46[_0x496c1b(0x1d8)]=_0x5c5a18;const _0x229a52=await imaging[_0x496c1b(0x22d)](_0x5d8a46),_0x115a4d=await _0x229a52['imageData'][_0x496c1b(0x1dc)](),_0x242bcd=_0x115a4d&&_0x115a4d[_0x496c1b(0x1f5)]?new Uint8Array(_0x115a4d[_0x496c1b(0x1f5)],_0x115a4d['byteOffset'],_0x115a4d['byteLength']):_0x115a4d;return{'data':_0x242bcd,'w':_0x229a52['imageData'][_0x496c1b(0x233)],'h':_0x229a52['imageData'][_0x496c1b(0x1cc)],'cC':_0x229a52[_0x496c1b(0x1ce)][_0x496c1b(0x1b7)],'dispose':()=>_0x229a52[_0x496c1b(0x1e9)]?.()};}async function saveBufferToTemp(_0x4ee326,_0x4ab737){const _0x984f0e=a0_0x49dc72;if(!_0x4ee326||_0x4ee326[_0x984f0e(0x216)]===0x0||!_0x4ab737)return null;try{const _0x56daa2=await fs['getTemporaryFolder'](),_0x947c7b=await _0x56daa2[_0x984f0e(0x1ee)](_0x4ab737,{'overwrite':!![]});return await _0x947c7b[_0x984f0e(0x1e1)](_0x4ee326,{'format':formats[_0x984f0e(0x232)]}),_0x947c7b[_0x984f0e(0x214)];}catch(_0x25c64c){return null;}}async function getTempFilesInfo(){const _0x384e09=a0_0x49dc72;try{const _0x524615=await fs['getTemporaryFolder'](),_0x2fe9ca=await _0x524615[_0x384e09(0x20b)]();return{'success':!![],'files':_0x2fe9ca[_0x384e09(0x1e4)](_0x40a184=>_0x40a184['isFile'])[_0x384e09(0x1c5)](_0x5209cf=>({'name':_0x5209cf[_0x384e09(0x1f1)],'nativePath':_0x5209cf[_0x384e09(0x214)],'modDate':_0x5209cf[_0x384e09(0x1f2)],'url':'file://'+_0x5209cf[_0x384e09(0x214)]}))};}catch(_0x35bc0e){return{'success':![],'error':_0x35bc0e['message']};}}async function deleteFile(_0x584aae){const _0x1279f3=a0_0x49dc72;try{if(!_0x584aae)return{'success':![],'error':_0x1279f3(0x227)};let _0x4569f8=decodeURIComponent(_0x584aae['replace'](/^(file|uxp-file):\/\/\/?/,''));const _0x52fb20=_0x4569f8[_0x1279f3(0x1fb)](/[\\\/]/)[_0x1279f3(0x207)](),_0x109319=await fs['getTemporaryFolder'](),_0x36f2e1=await _0x109319[_0x1279f3(0x1ba)](_0x52fb20);if(_0x36f2e1)await _0x36f2e1[_0x1279f3(0x1f3)]();return{'success':!![]};}catch(_0x2fa9e8){return{'success':![],'error':_0x2fa9e8[_0x1279f3(0x1e0)]};}}async function readBinaryFile(_0x2e8799){const _0x3dfddc=a0_0x49dc72;try{if(!_0x2e8799)return{'success':![],'error':_0x3dfddc(0x227)};let _0x3739c2;try{if(_0x2e8799[_0x3dfddc(0x221)]('file:')||_0x2e8799[_0x3dfddc(0x221)]('uxp-file:'))_0x3739c2=await fs[_0x3dfddc(0x20a)](_0x2e8799);}catch(_0x2add29){}if(!_0x3739c2){let _0x333d6c=decodeURIComponent(_0x2e8799[_0x3dfddc(0x217)](/^(file|uxp-file):\/\/\/?/,''));const _0x27bf24=_0x333d6c[_0x3dfddc(0x1fb)](/[\\\/]/)[_0x3dfddc(0x207)](),_0x17163f=await fs[_0x3dfddc(0x22e)]();_0x3739c2=await _0x17163f[_0x3dfddc(0x1ba)](_0x27bf24);}if(!_0x3739c2)throw new Error(_0x3dfddc(0x228)+_0x2e8799);const _0x48c19a=await _0x3739c2[_0x3dfddc(0x1cb)]({'format':formats[_0x3dfddc(0x232)]});return{'success':!![],'buffer':Array[_0x3dfddc(0x1c4)](new Uint8Array(_0x48c19a))};}catch(_0x2b95d8){return{'success':![],'error':_0x2b95d8[_0x3dfddc(0x1e0)]};}}async function getActiveDocumentImage(_0x1f526e={}){const _0x113cb4=a0_0x49dc72,{baseMode:baseMode='canvas',namePrefix:namePrefix='',nodeId:nodeId=_0x113cb4(0x1c0),appId:appId=_0x113cb4(0x235)}=_0x1f526e;if(!app[_0x113cb4(0x1f7)])return{'success':![],'error':_0x113cb4(0x1c8)};if(!imaging||!imaging[_0x113cb4(0x22d)])return{'success':![],'error':_0x113cb4(0x223)};isProcessing=!![];try{const _0x5d2dac=app[_0x113cb4(0x1f7)];let _0xfd9a58=null,_0x4576a4=null,_0x47b428=null,_0x321aa1=null;try{_0x321aa1=await getSelectionInfo();}catch(_0x495d43){}const _0x580d70=parseInt(val(_0x5d2dac['width']))||0x0,_0x3c24fa=parseInt(val(_0x5d2dac['height']))||0x0;let _0x31fc9b=_0x580d70,_0x546c64=_0x3c24fa,_0x456fa5=0x0,_0x112c6f=0x0;_0x1f526e[_0x113cb4(0x21f)]&&_0x321aa1&&(_0x456fa5=Math[_0x113cb4(0x1b2)](val(_0x321aa1['left'])),_0x112c6f=Math[_0x113cb4(0x1b2)](val(_0x321aa1[_0x113cb4(0x1f0)])),_0x31fc9b=Math[_0x113cb4(0x1b2)](val(_0x321aa1['right']))-_0x456fa5,_0x546c64=Math[_0x113cb4(0x1b2)](val(_0x321aa1[_0x113cb4(0x215)]))-_0x112c6f);let _0xb188b=null,_0x2aaca7=null;return await executeAsModal(async _0x43d11c=>{const _0x2aba3e=_0x113cb4;_0xb188b=new Uint8Array(_0x31fc9b*_0x546c64*0x4);for(let _0x34a5bd=0x3;_0x34a5bd<_0xb188b[_0x2aba3e(0x1ed)];_0x34a5bd+=0x4)_0xb188b[_0x34a5bd]=0x0;if(baseMode===_0x2aba3e(0x1bf)){const _0x4ff44b=await fetchPixels(_0x5d2dac,{'targetSize':{'width':_0x580d70,'height':_0x3c24fa}});for(let _0x9508e6=0x0;_0x9508e6<_0x546c64;_0x9508e6++){const _0x1b8729=_0x112c6f+_0x9508e6;if(_0x1b8729<0x0||_0x1b8729>=_0x3c24fa)continue;for(let _0x8a7e7=0x0;_0x8a7e7<_0x31fc9b;_0x8a7e7++){const _0x108ab2=_0x456fa5+_0x8a7e7;if(_0x108ab2<0x0||_0x108ab2>=_0x580d70)continue;const _0x1b2727=(_0x1b8729*_0x580d70+_0x108ab2)*_0x4ff44b['cC'],_0x28c02a=(_0x9508e6*_0x31fc9b+_0x8a7e7)*0x4;_0xb188b[_0x28c02a]=_0x4ff44b[_0x2aba3e(0x1d7)][_0x1b2727],_0xb188b[_0x28c02a+0x1]=_0x4ff44b[_0x2aba3e(0x1d7)][_0x1b2727+0x1],_0xb188b[_0x28c02a+0x2]=_0x4ff44b[_0x2aba3e(0x1d7)][_0x1b2727+0x2],_0xb188b[_0x28c02a+0x3]=_0x4ff44b['cC']===0x4?_0x4ff44b[_0x2aba3e(0x1d7)][_0x1b2727+0x3]:0xff;}}_0x4ff44b[_0x2aba3e(0x1e9)]();}else{const _0x451f4f=_0x5d2dac[_0x2aba3e(0x201)][0x0];if(!_0x451f4f)throw new Error(_0x2aba3e(0x1da));const _0x498721=_0x451f4f[_0x2aba3e(0x22b)],_0x1a9061=Math['round'](val(_0x498721['top'])),_0x379dae=Math[_0x2aba3e(0x1b2)](val(_0x498721['left'])),_0x3cc9e2=await fetchPixels(_0x5d2dac,{'layerID':_0x451f4f['id'],'applyAlpha':![]});for(let _0x25a679=0x0;_0x25a679<_0x546c64;_0x25a679++){const _0x2e96e6=_0x112c6f+_0x25a679,_0x6a88ce=_0x2e96e6-_0x1a9061;if(_0x6a88ce<0x0||_0x6a88ce>=_0x3cc9e2['h'])continue;for(let _0x39c54e=0x0;_0x39c54e<_0x31fc9b;_0x39c54e++){const _0x5d9bd8=_0x456fa5+_0x39c54e,_0x121e9e=_0x5d9bd8-_0x379dae;if(_0x121e9e<0x0||_0x121e9e>=_0x3cc9e2['w'])continue;const _0x2cb650=(_0x6a88ce*_0x3cc9e2['w']+_0x121e9e)*_0x3cc9e2['cC'],_0xaf555=(_0x25a679*_0x31fc9b+_0x39c54e)*0x4,_0x416686=_0x3cc9e2['cC']===0x4?_0x3cc9e2['data'][_0x2cb650+0x3]:0xff;_0x416686>0x0&&(_0xb188b[_0xaf555]=_0x3cc9e2[_0x2aba3e(0x1d7)][_0x2cb650],_0xb188b[_0xaf555+0x1]=_0x3cc9e2[_0x2aba3e(0x1d7)][_0x2cb650+0x1],_0xb188b[_0xaf555+0x2]=_0x3cc9e2[_0x2aba3e(0x1d7)][_0x2cb650+0x2],_0xb188b[_0xaf555+0x3]=_0x416686);}}_0x3cc9e2[_0x2aba3e(0x1e9)]();}const _0x185f59=appId?String(appId)[_0x2aba3e(0x217)](/[^a-zA-Z0-9_-]/g,'_'):'app',_0x579fb6=nodeId?String(nodeId)['replace'](/\.(image|mask|text)$/,'')[_0x2aba3e(0x217)](/[^a-zA-Z0-9_-]/g,'_'):_0x2aba3e(0x1c0),_0xe905d2=''+(namePrefix?namePrefix+'_':'')+_0x185f59+'_'+_0x579fb6;if(_0x321aa1){let _0x20c338=null;try{const _0x2533ac=await action[_0x2aba3e(0x1db)]([{'_obj':_0x2aba3e(0x1e6),'_target':[{'_ref':'layer'}]}],{});_0x20c338=_0x2533ac[0x0]?.[_0x2aba3e(0x1bc)],await action[_0x2aba3e(0x1db)]([{'_obj':_0x2aba3e(0x1b8),'mode':{'_enum':_0x2aba3e(0x1d5),'_value':_0x2aba3e(0x1dd)},'using':{'_enum':_0x2aba3e(0x21d),'_value':_0x2aba3e(0x1f9)}}],{});const _0x363a4c=await fetchPixels(_0x5d2dac,{'layerID':_0x20c338,'applyAlpha':![]}),_0xb73c37=await action[_0x2aba3e(0x1db)]([{'_obj':_0x2aba3e(0x1d9),'_target':[{'_ref':_0x2aba3e(0x1fc),'_property':_0x2aba3e(0x21e)},{'_ref':_0x2aba3e(0x210),'_id':_0x20c338}],'_options':{'dialogOptions':_0x2aba3e(0x1e5)}}],{'synchronousExecution':!![]}),_0x269ac4=_0xb73c37[0x0][_0x2aba3e(0x21e)],_0x59c51f=Math[_0x2aba3e(0x1b2)](val(_0x269ac4[_0x2aba3e(0x1f0)])),_0x169023=Math[_0x2aba3e(0x1b2)](val(_0x269ac4[_0x2aba3e(0x1cd)]));_0x2aaca7=new Uint8Array(_0x31fc9b*_0x546c64*0x4);for(let _0x42e3b4=0x3;_0x42e3b4<_0x2aaca7[_0x2aba3e(0x1ed)];_0x42e3b4+=0x4)_0x2aaca7[_0x42e3b4]=0x0;for(let _0x67124c=0x0;_0x67124c<_0x363a4c['h'];_0x67124c++){const _0x66c3a1=_0x59c51f+_0x67124c,_0x3100d7=_0x66c3a1-_0x112c6f;if(_0x3100d7<0x0||_0x3100d7>=_0x546c64)continue;for(let _0x69427e=0x0;_0x69427e<_0x363a4c['w'];_0x69427e++){const _0x2c10b1=_0x169023+_0x69427e,_0x5988d2=_0x2c10b1-_0x456fa5;if(_0x5988d2<0x0||_0x5988d2>=_0x31fc9b)continue;const _0x14c009=(_0x67124c*_0x363a4c['w']+_0x69427e)*_0x363a4c['cC'],_0x1f0ee4=(_0x3100d7*_0x31fc9b+_0x5988d2)*0x4,_0x466e53=_0x363a4c['cC']===0x4?_0x363a4c['data'][_0x14c009+0x3]:_0x363a4c['data'][_0x14c009];_0x466e53>0x20&&(_0x2aaca7[_0x1f0ee4]=0xff,_0x2aaca7[_0x1f0ee4+0x1]=0x0,_0x2aaca7[_0x1f0ee4+0x2]=0x0,_0x2aaca7[_0x1f0ee4+0x3]=_0x466e53);}}if(!_0x1f526e[_0x2aba3e(0x21f)]){const _0x193304=new PngEncoder(_0x31fc9b,_0x546c64,0x4);_0x4576a4=await saveBufferToTemp(_0x193304[_0x2aba3e(0x204)](_0x2aaca7),_0xe905d2+_0x2aba3e(0x1c1));}_0x363a4c[_0x2aba3e(0x1e9)]();}catch(_0x797536){throw _0x797536;}finally{if(_0x20c338)try{await action[_0x2aba3e(0x1db)]([{'_obj':_0x2aba3e(0x1f3),'_target':[{'_ref':'layer','_id':_0x20c338}]}],{});}catch(_0x3cadcb){}}}const _0xe2d9=new PngEncoder(_0x31fc9b,_0x546c64,0x4);_0xfd9a58=await saveBufferToTemp(_0xe2d9[_0x2aba3e(0x204)](_0xb188b),_0xe905d2+_0x2aba3e(0x21a));if(_0xb188b){const _0x558951=new Uint8Array(_0x31fc9b*_0x546c64*0x4);for(let _0x1b2983=0x0;_0x1b2983<_0x558951[_0x2aba3e(0x1ed)];_0x1b2983+=0x4){_0x558951[_0x1b2983]=_0xb188b[_0x1b2983],_0x558951[_0x1b2983+0x1]=_0xb188b[_0x1b2983+0x1],_0x558951[_0x1b2983+0x2]=_0xb188b[_0x1b2983+0x2],_0x558951[_0x1b2983+0x3]=_0x2aaca7?Math[_0x2aba3e(0x224)](0x0,_0xb188b[_0x1b2983+0x3]-_0x2aaca7[_0x1b2983+0x3]):_0xb188b[_0x1b2983+0x3];}const _0x2020c2=new PngEncoder(_0x31fc9b,_0x546c64,0x4);_0x47b428=await saveBufferToTemp(_0x2020c2[_0x2aba3e(0x204)](_0x558951),_0xe905d2+_0x2aba3e(0x20f));}},{'commandName':_0x113cb4(0x209)}),{'success':!![],'image':_0xfd9a58?_0x113cb4(0x200)+_0xfd9a58:null,'mask':_0x4576a4?_0x113cb4(0x200)+_0x4576a4:null,'rgba':_0x47b428?_0x113cb4(0x200)+_0x47b428:null,'width':_0x31fc9b,'height':_0x546c64,'isLocal':!![]};}catch(_0x541741){return{'success':![],'error':_0x113cb4(0x22a)+_0x541741[_0x113cb4(0x1e0)]};}finally{isProcessing=![];}}async function pickLocalFile(){const _0x59db48=a0_0x49dc72;try{const _0x4130d0=await fs[_0x59db48(0x1d6)]({'types':['png',_0x59db48(0x1c2),_0x59db48(0x1b1),'webp'],'allowMultiple':![]});if(!_0x4130d0)return{'success':![],'error':_0x59db48(0x212)};const _0x298ee6=await fs[_0x59db48(0x22e)](),_0x28ed5c=await _0x4130d0[_0x59db48(0x218)](_0x298ee6,{'newName':_0x4130d0[_0x59db48(0x1f1)],'overwrite':!![]});return{'success':!![],'image':_0x28ed5c[_0x59db48(0x214)],'name':_0x4130d0[_0x59db48(0x1f1)],'isLocal':!![]};}catch(_0x449f76){return{'success':![],'error':_0x449f76[_0x59db48(0x1e0)]};}}async function pickFolder(){const _0x3fdc6f=a0_0x49dc72;try{const _0x213acd=await fs[_0x3fdc6f(0x20e)]();if(!_0x213acd)return{'success':![],'error':_0x3fdc6f(0x212)};const _0xe2bd8=await fs[_0x3fdc6f(0x229)](_0x213acd);return{'success':!![],'path':_0x213acd[_0x3fdc6f(0x214)],'token':_0xe2bd8};}catch(_0x1affd7){return{'success':![],'error':_0x1affd7[_0x3fdc6f(0x1e0)]};}}async function getFolderTokenFromPath(_0x38394f){const _0x43dbf5=a0_0x49dc72;try{if(!_0x38394f)return{'success':![],'error':_0x43dbf5(0x227)};let _0x119b33=await fs[_0x43dbf5(0x20a)](_0x43dbf5(0x200)+_0x38394f);if(!_0x119b33||!_0x119b33[_0x43dbf5(0x1f6)])return{'success':![],'error':_0x43dbf5(0x222)};const _0x48da6e=await fs[_0x43dbf5(0x229)](_0x119b33);return{'success':!![],'path':_0x119b33[_0x43dbf5(0x214)],'token':_0x48da6e};}catch(_0x482728){return{'success':![],'error':_0x43dbf5(0x1b0)};}}async function listFiles(_0xaaf170){const _0x2aea35=a0_0x49dc72;try{if(!_0xaaf170)return{'success':![],'error':_0x2aea35(0x1f4)};const _0x3587a8=await fs[_0x2aea35(0x1c3)](_0xaaf170);if(!_0x3587a8||!_0x3587a8['isFolder'])return{'success':![],'error':_0x2aea35(0x1df)};const _0x72cdf1=await _0x3587a8[_0x2aea35(0x20b)](),_0x4fb658=_0x72cdf1[_0x2aea35(0x1e4)](_0x6a2c14=>_0x6a2c14[_0x2aea35(0x205)]&&/\.(png|jpg|jpeg|webp)$/i[_0x2aea35(0x231)](_0x6a2c14[_0x2aea35(0x1f1)]))['map'](_0x141b39=>({'name':_0x141b39[_0x2aea35(0x1f1)],'nativePath':_0x141b39[_0x2aea35(0x214)]}));return{'success':!![],'files':_0x4fb658};}catch(_0x56a880){return{'success':![],'error':_0x56a880[_0x2aea35(0x1e0)]};}}async function loadFileByPath(_0x3d1b52,_0x59ae59){const _0x250525=a0_0x49dc72;try{if(!_0x3d1b52||!_0x59ae59)return{'success':![],'error':'Missing\x20token\x20or\x20fileName'};const _0x3ec265=await fs[_0x250525(0x1c3)](_0x3d1b52),_0x3d3242=await _0x3ec265[_0x250525(0x1ba)](_0x59ae59);if(!_0x3d3242||!_0x3d3242['isFile'])return{'success':![],'error':'File\x20not\x20found'};const _0x537bdb=await fs[_0x250525(0x22e)](),_0x1e23ac=await _0x3d3242[_0x250525(0x218)](_0x537bdb,{'newName':_0x250525(0x1b4)+Date[_0x250525(0x22c)]()+'_'+_0x59ae59,'overwrite':!![]});return{'success':!![],'image':_0x1e23ac[_0x250525(0x214)],'name':_0x59ae59,'isLocal':!![]};}catch(_0x34660f){return{'success':![],'error':_0x34660f[_0x250525(0x1e0)]};}}async function downloadUrlToTemp(_0x479b21,_0x47428f){const _0x28e999=a0_0x49dc72;if(!_0x47428f)_0x47428f=_0x28e999(0x1d2)+Date[_0x28e999(0x22c)]()+_0x28e999(0x208);const _0x279752=await fetch(_0x479b21),_0x48125d=await _0x279752[_0x28e999(0x1de)](),_0xba87f8=await fs[_0x28e999(0x22e)](),_0x5629ef=await _0xba87f8[_0x28e999(0x1ee)](_0x47428f,{'overwrite':!![]});return await _0x5629ef[_0x28e999(0x1e1)](_0x48125d,{'format':formats[_0x28e999(0x232)]}),{'success':!![],'nativePath':_0x5629ef[_0x28e999(0x214)]};}function a0_0x1f7d(){const _0x226a80=['z2v0rgf0yq','BM9YBwfS','yxjYyxLcDwzMzxi','sw52ywXPzcbMB2XKzxiGDg9Rzw4','BwvZC2fNzq','D3jPDgu','C2rRx3rLBxbFBgf5zxiUCg5N','nJm5uMnwAvPU','zMLSDgvY','zg9UDerPC3bSyxK','BwfRzq','DgfYz2v0rw51Bq','C2vSzwn0Aw9U','zgLZCg9Zzq','Bw92zq','x3zHBhvL','mNnrC0fvtq','BgvUz3rO','y3jLyxrLrMLSzq','otyYotK1A3jythHW','Dg9W','BMfTzq','Bw9Krgf0zq','zgvSzxrL','tM8GDg9Rzw4','yNvMzMvY','AxngB2XKzxi','ywn0AxzLrg9JDw1LBNq','lI91DgLSCY9qtKCTu0rllMPZ','D2HPDgu','Bg9JywXgAwXLu3LZDgvT','C3bSAxq','ChjVCgvYDhK','C3rVCMfNzq','DMfSDwu','CgHVDg9ZAg9W','zMLSztOVlW','ywn0AxzLtgf5zxjZ','C2vSzwn0','nZG3mti5vfDPAuH6','zw5JB2rL','AxngAwXL','DhjHBNnMB3jT','Cg9W','lNbUzW','u0rloIbpChrPBwL6zwqGq2fWDhvYzq','z2v0rw50CNLxAxrOvxjS','z2v0rw50CMLLCW','u0rloIbqBgfJzsbHBMqGqwrHChrPDMuGrML0','B3jKAw5HBa','z2v0rM9SzgvY','x3jNyMeUCg5N','Bgf5zxi','B2jQzwn0','vxnLCIbJyw5JzwXSzwq','CMfZDgvYAxPLtgf5zxi','BMf0AxzLugf0Aa','yM90Dg9T','yNL0zuXLBMD0Aa','CMvWBgfJzq','y29WEvrV','Aw5JBhvKzxm','x2LTywDLlNbUzW','mJq2mJqYne9HC0XuvW','AgLKzq','zMLSBenVBNrLBNrZ','yM91BMrZ','y3jVCa','mtqWoda4EhjOy2DZ','C3rHCNrZv2L0Aa','ugvYBwLZC2LVBIbKzw5PzwqGB3iGzM9SzgvYig5VDcbMB3vUzc4GugXLyxnLihvZzsbcCM93C2uGyNv0Dg9UihrVigf1DgHVCML6zsb0AgLZigzVBgrLCI4','ugHVDg9ZAg9WieLTywDPBMCGqvbjig5VDcbHDMfPBgfIBgu','Bwf4','Aw50zxjWB2XHDgLVBLr5Cgu','CMvZzxq','rw1WDhKGCgf0Aa','q291BgqGBM90igXVy2f0zsbMAwXLievUDhj5igzVCIbWyxrOoIa','y3jLyxrLu2vZC2LVBLrVA2vU','rxHLy3v0Aw9UigvYCM9YoIa','yM91BMrZtM9fzMzLy3rZ','BM93','z2v0ugL4zwXZ','z2v0vgvTCg9Yyxj5rM9SzgvY','BNvTyMvY','CgHVDg9ZAg9Wqvbj','DgvZDa','yMLUyxj5','D2LKDgG','mtm5nZCWvKHbvgjJ','yxbW','CxvHzenLBNrLCLn0yxrL','tMvLzcbHDxrOB3jPEMf0Aw9UlIbqBgvHC2uGDxnLicjcCM93C2uIihrVihnLBgvJDcb0AgLZigzVBgrLCI4','ANbLzW','CM91BMq','C2HVDW','CgLJA18','C2v0','yMLJDwjPyW','y29TCg9Uzw50CW','zMLSBa','zxHLy3v0zufZtw9KywW','z2v0rw50CNK','CMLNAhq','Bgf5zxjjra','zg9JDw1LBNq','CgL4zwXZvw5PDa','y2fUDMfZ','BM9Kzq','x21HC2SUCg5N','ANbN','z2v0rw50CNLgB3jtzxnZAw9Uvg9Rzw4','zNjVBq','BwfW','ywrKtM90AwzPy2f0Aw9UtgLZDgvUzxi','Bg9JywW','tM8Gywn0AxzLigrVy3vTzw50','mJbSDwvpzgy','mJK3ody3ouzPqNz0DW','CMvHza','AgvPz2H0','BgvMDa','Aw1Hz2veyxrH','zM9YBwf0CW','DxHW','uuntqxzLCMfNzq','zgXF','mZuWC2HUrMvT','mJK1ota1me1wwMPNyq','Aw50zxjWB2XHDgLVBG','z2v0rMLSzuzVCK9Wzw5PBMC','zgf0yq','DgfYz2v0u2L6zq','z2v0','tM8Gywn0AxzLigXHEwvY','yMf0y2HqBgf5'];a0_0x1f7d=function(){return _0x226a80;};return a0_0x1f7d();}function a0_0x3e29(_0x5e8fea,_0x7c64c5){_0x5e8fea=_0x5e8fea-0x1af;const _0x1f7d01=a0_0x1f7d();let _0x3e29cc=_0x1f7d01[_0x5e8fea];if(a0_0x3e29['mKLZQD']===undefined){var _0x5a6376=function(_0x1b76b7){const _0x5911e6='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x47a4dc='',_0x3cdf8f='';for(let _0x4f1165=0x0,_0x5a6bcf,_0x315303,_0xf04344=0x0;_0x315303=_0x1b76b7['charAt'](_0xf04344++);~_0x315303&&(_0x5a6bcf=_0x4f1165%0x4?_0x5a6bcf*0x40+_0x315303:_0x315303,_0x4f1165++%0x4)?_0x47a4dc+=String['fromCharCode'](0xff&_0x5a6bcf>>(-0x2*_0x4f1165&0x6)):0x0){_0x315303=_0x5911e6['indexOf'](_0x315303);}for(let _0x2b318e=0x0,_0x18e936=_0x47a4dc['length'];_0x2b318e<_0x18e936;_0x2b318e++){_0x3cdf8f+='%'+('00'+_0x47a4dc['charCodeAt'](_0x2b318e)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x3cdf8f);};a0_0x3e29['PZdtic']=_0x5a6376,a0_0x3e29['oAlUen']={},a0_0x3e29['mKLZQD']=!![];}const _0x37cdfa=_0x1f7d01[0x0],_0x574fd0=_0x5e8fea+_0x37cdfa,_0x46e044=a0_0x3e29['oAlUen'][_0x574fd0];return!_0x46e044?(_0x3e29cc=a0_0x3e29['PZdtic'](_0x3e29cc),a0_0x3e29['oAlUen'][_0x574fd0]=_0x3e29cc):_0x3e29cc=_0x46e044,_0x3e29cc;}async function createDocFromUrl(_0x1dba5d){const _0x2ef09a=a0_0x49dc72;try{let _0x45f60f;if(_0x1dba5d[_0x2ef09a(0x221)](_0x2ef09a(0x200)))_0x45f60f=await fs[_0x2ef09a(0x20a)](_0x1dba5d);else{const _0x2d37d2=await downloadUrlToTemp(_0x1dba5d,'sdk_temp_doc.png');_0x45f60f=await fs[_0x2ef09a(0x20a)](_0x2ef09a(0x200)+_0x2d37d2[_0x2ef09a(0x214)]);}return await executeAsModal(async()=>{await app['open'](_0x45f60f);},{'commandName':'SDK:\x20Open\x20Doc'}),{'success':!![]};}catch(_0x238a73){return{'success':![],'error':_0x238a73[_0x2ef09a(0x1e0)]};}}async function placeImageFromUrl(_0x416457,_0x389a27=![]){const _0x454cbd=a0_0x49dc72;try{let _0x165edd;if(_0x416457['startsWith'](_0x454cbd(0x200)))_0x165edd=await fs['getEntryWithUrl'](_0x416457);else{const _0x43c68f=await downloadUrlToTemp(_0x416457,_0x454cbd(0x1e2));_0x165edd=await fs[_0x454cbd(0x20a)](_0x454cbd(0x200)+_0x43c68f[_0x454cbd(0x214)]);}return await executeAsModal(async()=>{const _0x1d3437=_0x454cbd,_0x424cd0=app[_0x1d3437(0x1f7)],_0x207dc8=Number(val(_0x424cd0['width'])),_0x166482=Number(val(_0x424cd0[_0x1d3437(0x1cc)]));let _0x56be7a={'left':0x0,'top':0x0,'right':_0x207dc8,'bottom':_0x166482};const _0x4f9d6d=await getSelectionInfo();if(_0x4f9d6d){const _0x369df0=Number(val(_0x4f9d6d[_0x1d3437(0x1cd)])),_0x33224e=Number(val(_0x4f9d6d[_0x1d3437(0x1f0)])),_0x377c7d=Number(val(_0x4f9d6d[_0x1d3437(0x1bb)])),_0x899c4d=Number(val(_0x4f9d6d[_0x1d3437(0x215)]));_0x377c7d-_0x369df0>0x1&&_0x899c4d-_0x33224e>0x1&&(_0x56be7a={'left':_0x369df0,'top':_0x33224e,'right':_0x377c7d,'bottom':_0x899c4d});}const _0x330cdb=await fs[_0x1d3437(0x229)](_0x165edd);await batchPlay([{'_obj':'placeEvent','target':{'_path':_0x330cdb,'_kind':_0x1d3437(0x1c7)},'linked':!![]}],{});const _0x769bad=_0x424cd0[_0x1d3437(0x201)][0x0],_0x18edba=_0x769bad[_0x1d3437(0x22b)],_0x1d7215=Number(val(_0x18edba[_0x1d3437(0x1cd)])),_0x4dfd51=Number(val(_0x18edba[_0x1d3437(0x1f0)])),_0x481657=Number(val(_0x18edba[_0x1d3437(0x1bb)])),_0x3fe997=Number(val(_0x18edba['bottom'])),_0x31e105=_0x481657-_0x1d7215,_0xe4e01=_0x3fe997-_0x4dfd51,_0x4c29a9=(_0x1d7215+_0x481657)/0x2,_0x2e9fd6=(_0x4dfd51+_0x3fe997)/0x2,_0x317dc1=_0x56be7a['right']-_0x56be7a['left'],_0x253554=_0x56be7a[_0x1d3437(0x215)]-_0x56be7a['top'],_0x9c53a0=(_0x56be7a['left']+_0x56be7a['right'])/0x2,_0x58ee97=(_0x56be7a['top']+_0x56be7a['bottom'])/0x2;let _0x42b1a7=0x64,_0x2013d6=0x64,_0x1b8030=_0x9c53a0,_0x3a61c2=_0x58ee97;_0x389a27?(_0x1b8030=_0x207dc8/0x2,_0x3a61c2=_0x166482/0x2,_0x42b1a7=0x64,_0x2013d6=0x64):(_0x42b1a7=_0x317dc1/_0x31e105*0x64,_0x2013d6=_0x253554/_0xe4e01*0x64);const _0x45c119=_0x1b8030-_0x4c29a9,_0x36a8ed=_0x3a61c2-_0x2e9fd6;await action[_0x1d3437(0x1db)]([{'_obj':_0x1d3437(0x206),'_target':[{'_ref':'layer','_enum':_0x1d3437(0x20d),'_value':_0x1d3437(0x1e7)}],'freeTransformCenterState':{'_enum':_0x1d3437(0x1af),'_value':_0x1d3437(0x1d1)},'offset':{'_obj':'offset','horizontal':{'_unit':_0x1d3437(0x1be),'_value':_0x45c119},'vertical':{'_unit':'pixelsUnit','_value':_0x36a8ed}},'width':{'_unit':'percentUnit','_value':_0x42b1a7},'height':{'_unit':'percentUnit','_value':_0x2013d6},'interpolation':{'_enum':_0x1d3437(0x225),'_value':_0x1d3437(0x1b6)}}],{}),await action[_0x1d3437(0x1db)]([{'_obj':_0x1d3437(0x213),'_target':[{'_ref':_0x1d3437(0x210),'_enum':'ordinal','_value':_0x1d3437(0x1e7)}]}],{});},{'commandName':_0x454cbd(0x20c)}),{'success':!![]};}catch(_0x5acdbe){return{'success':![],'error':_0x5acdbe[_0x454cbd(0x1e0)]};}}function getDocumentInfo(){const _0x3a2ccf=a0_0x49dc72;if(!app||!app[_0x3a2ccf(0x1f7)])return{'hasDocument':![]};const _0x188ce9=app[_0x3a2ccf(0x1f7)];return{'hasDocument':!![],'width':val(_0x188ce9[_0x3a2ccf(0x233)]),'height':val(_0x188ce9[_0x3a2ccf(0x1cc)])};}function startSelectionListener(_0x4654cf){const _0x576c07=a0_0x49dc72;if(!action||!action[_0x576c07(0x1c6)])return;let _0x4f6574=null;action[_0x576c07(0x1c6)](['all'],(_0x490bdc,_0x570071)=>{const _0x48653f=_0x576c07,_0x4b40d9=[_0x48653f(0x1b5),_0x48653f(0x226),_0x48653f(0x202),_0x48653f(0x1e6),_0x48653f(0x1ea),'transform',_0x48653f(0x1b3),_0x48653f(0x21c),_0x48653f(0x1f3)];if(_0x4b40d9[_0x48653f(0x219)](_0x490bdc)){if(_0x4f6574)clearTimeout(_0x4f6574);_0x4f6574=setTimeout(()=>{if(!isProcessing&&_0x4654cf)_0x4654cf();},0x258);}});}window[a0_0x49dc72(0x230)]={'getActiveDocumentImage':getActiveDocumentImage,'createDocFromUrl':createDocFromUrl,'placeImageFromUrl':placeImageFromUrl,'downloadUrlToTemp':downloadUrlToTemp,'getDocumentInfo':getDocumentInfo,'startSelectionListener':startSelectionListener,'deleteFile':deleteFile,'getTempFilesInfo':getTempFilesInfo,'pickLocalFile':pickLocalFile,'pickFolder':pickFolder,'getFolderTokenFromPath':getFolderTokenFromPath,'listFiles':listFiles,'loadFileByPath':loadFileByPath,'readBinaryFile':readBinaryFile,'showAlert':_0x3b0ad2=>app['showAlert'](_0x3b0ad2)};
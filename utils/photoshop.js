function a0_0x1abf(){const _0x33c6e8=['BgvMDa','Dg9W','CMfZDgvYAxPLtgf5zxi','AxngAwXL','C2vSzwn0','lI91DgLSCY9WBMDFzw5JB2rLCI5QCW','y2HHBM5LBa','rMLSzsbUB3qGzM91BMq','BMfTzq','C3rVCMfNzq','ANbN','CgXHy2vfDMvUDa','y2fUDMfZ','otK0otq4D05MzK1Z','z2v0rgf0yq','Aw50zxjWB2XHDgLVBLr5Cgu','ywn0AxzLrg9JDw1LBNq','yMf0y2HqBgf5','zw5KC1DPDgG','yM90Dg9T','y29TCg9Uzw50CW','rMfPBgvKihrVihjLDhjPzxzLigLTywDLigrHDgeU','Aw5JBhvKzxm','BwfW','D2vICa','zgLZCg9Zzq','q3jLyxrLie5LDYbeB2n1BwvUDa','ywXS','mZKZntzpyxDUy3u','Bw92zq','zg9UDerPC3bSyxK','z2v0rMLSzuzVCK9Wzw5PBMC','AxnbCNjHEq','x3zHBhvL','z2v0rw50CNLxAxrOvxjS','mJDKv1PXCKG','A2v5CW','ywn0AxzLtgf5zxjZ','w0jPENLbAxjDie1HC2SGy2fWDhvYzsbMywLSzwq','tM8Gywn0AxzLigXHEwvYihnLBgvJDgvK','zw5JB2rL','zNjVBq','CgL4zwXZvw5PDa','x3jLzG','D2LKDgG','y3jLyxrLrMLSzq','odq2Eufcvfjh','mJe5ntLPBfHitg4','BMf0AxzLugf0Aa','qML6EufPCIbjBwfNzsbby3f1AxnPDgLVBG','zxHLy3v0zufZtw9KywW','yM91BMrZ','CgHVDg9ZAg9Wqvbj','zMLSBenVBNrLBNrZ','z2v0','y3jLyxrLu2vZC2LVBLrVA2vU','zw5JB2rLsw1Hz2veyxrH','rw1WDhKGCgf0Aa','nJqZotC2ohnKvMfitG','B3bLBG','BM93','CMvWBgfJzq','CgvYy2vUDfvUAxq','yM91BMrZtM9fzMzLy3rZ','CMDIyq','zMLSztOVlW','z2v0vgvTCg9Yyxj5rM9SzgvY','ywrKtM90AwzPy2f0Aw9UtgLZDgvUzxi','CxvHzenLBNrLCLn0yxrL','zxjYB3i','lNbUzW','mteXndK3ngnkvxbpBq','ndKXmtqWyvjsBMv2','Aw1Hz2u','Bg9JywXLq29TCgfYzq','B2zMC2v0','C29YDa','AgLKzq','BwvZC2fNzq','DhjHBNnMB3jT','Bg9JywW','BgvUz3rO','zgf0yq','zMLSBa','ChjVCgvYDhK','Bg9JywXgAwXLu3LZDgvT','B2jQzwn0','C3bSAxq','Cg9W','CMLNAhq','zg9JDw1LBNq','yML6EwfPCL9Yzxn1BhrF','zgvSzxrL','BM9YBwfS','Cg5N','D2HPDgu','yML6EwfPCL8','B3jKAw5HBa','C3rHCNrZv2L0Aa','z2v0qwn0AxzLrg9JDw1LBNrjBwfNzsbfCNjVCG','D3jPDgu','z2v0rw50CNK','y29WEvrV','DxHWx2rVD25SB2fKxW','otu5mJblq21ez20','C2vSzwn0Aw9U','x3bYB3bLCNr5','CgHVDg9ZAg9W','otyWEvDrChzP','yMXHy2S','yxjYyxLcDwzMzxi','BwfZA19WCMv2Awv3','DMfSDwu','CM91BMq','tM8Gywn0AxzLigrVy3vTzw50','DgfYz2v0rw51Bq','Aw50zxjWB2XHDgLVBG','CgLJA0XVy2fSrMLSzsbfCNjVCG','zMLSDgvY','C29Tzq','DxHW','AgvPz2H0','C2HVDW','Aw1Hz2veyxrH','BwfRzq','CMvZzxq','z2v0ugL4zwXZ','Bgf5zxi','zg93BMXVywrF','vxnLCIbJyw5JzwXSzwq','x3rHCMDLDa','zMLSzq','ugXHy2uGyw5KiefSAwDUieLTywDL','yMLUyxj5','BwLU'];a0_0x1abf=function(){return _0x33c6e8;};return a0_0x1abf();}const a0_0x1ce289=a0_0x22f9;(function(_0x14d80c,_0x58c324){const _0x5b346d=a0_0x22f9,_0x396a1f=_0x14d80c();while(!![]){try{const _0x2d2188=parseInt(_0x5b346d(0x7a))/0x1+parseInt(_0x5b346d(0xb4))/0x2+-parseInt(_0x5b346d(0x90))/0x3*(parseInt(_0x5b346d(0x89))/0x4)+-parseInt(_0x5b346d(0xb5))/0x5+-parseInt(_0x5b346d(0xd9))/0x6*(parseInt(_0x5b346d(0x9c))/0x7)+parseInt(_0x5b346d(0xa7))/0x8+parseInt(_0x5b346d(0x9b))/0x9*(-parseInt(_0x5b346d(0xd5))/0xa);if(_0x2d2188===_0x58c324)break;else _0x396a1f['push'](_0x396a1f['shift']());}catch(_0x5162bf){_0x396a1f['push'](_0x396a1f['shift']());}}}(a0_0x1abf,0xbb453));const {app,action,core,imaging}=require(a0_0x1ce289(0xd8)),{batchPlay}=action,fs=require(a0_0x1ce289(0xe5))[a0_0x1ce289(0xfd)][a0_0x1ce289(0xc2)],formats=require(a0_0x1ce289(0xe5))['storage']['formats'],executeAsModal=core[a0_0x1ce289(0x9f)],PngEncoder=require(a0_0x1ce289(0xf9));let isProcessing=![];const val=_0x4d9fa5=>{const _0x260b8e=a0_0x1ce289;if(_0x4d9fa5===null||_0x4d9fa5===undefined)return 0x0;if(typeof _0x4d9fa5===_0x260b8e(0xc3)){if(_0x4d9fa5[_0x260b8e(0xdd)]!==undefined)return _0x4d9fa5[_0x260b8e(0xdd)];if(_0x4d9fa5[_0x260b8e(0x8e)]!==undefined)return _0x4d9fa5[_0x260b8e(0x8e)];if(Object['keys'](_0x4d9fa5)[_0x260b8e(0xbe)]===0x1){const _0x45117b=Object[_0x260b8e(0x91)](_0x4d9fa5)[0x0];return val(_0x4d9fa5[_0x45117b]);}}return _0x4d9fa5;};async function getSelectionInfo(){const _0x4f23f0=a0_0x1ce289;try{const _0x282917=await action[_0x4f23f0(0x7e)]([{'_obj':_0x4f23f0(0xa3),'_target':[{'_ref':_0x4f23f0(0xc1),'_property':_0x4f23f0(0xd6)},{'_ref':_0x4f23f0(0xc7),'_enum':_0x4f23f0(0xce),'_value':'targetEnum'}],'_options':{'dialogOptions':_0x4f23f0(0x8b)}}],{'synchronousExecution':!![]});if(_0x282917&&_0x282917[0x0]&&_0x282917[0x0]['selection'])return _0x282917[0x0]['selection'];return null;}catch(_0x3fe12b){return null;}}function calculateTargetSize(_0x3c9ce1,_0x2cff42){const _0x598a0f=a0_0x1ce289;let _0x40c7dd=_0x3c9ce1[_0x598a0f(0x99)],_0x5844f0=_0x3c9ce1[_0x598a0f(0xe6)],_0x2770f6=_0x40c7dd,_0x448d19=_0x5844f0;if(_0x2cff42&&(_0x40c7dd>_0x2cff42||_0x5844f0>_0x2cff42)){const _0x51113d=Math['min'](_0x2cff42/_0x40c7dd,_0x2cff42/_0x5844f0);_0x2770f6=Math[_0x598a0f(0xde)](_0x40c7dd*_0x51113d),_0x448d19=Math[_0x598a0f(0xde)](_0x5844f0*_0x51113d);}return{'width':_0x2770f6,'height':_0x448d19};}async function encodeToPng(_0x1a5485){const _0x4ef0c8=a0_0x1ce289;if(!_0x1a5485||!_0x1a5485[_0x4ef0c8(0xe8)])throw new Error(_0x4ef0c8(0x82));try{const _0x5c1da6=await imaging[_0x4ef0c8(0xa5)]({'imageData':_0x1a5485[_0x4ef0c8(0xe8)],'format':_0x4ef0c8(0xcb),'base64':![]});return _0x5c1da6;}finally{_0x1a5485[_0x4ef0c8(0x86)]&&_0x1a5485[_0x4ef0c8(0x86)]();}}async function saveBufferToTemp(_0x34a1df,_0x5e6e45,_0x1805d7,_0x1a2ebb){const _0x5ec0ec=a0_0x1ce289,_0x35b3a6=_0x1a2ebb?String(_0x1a2ebb)['replace'](/[^a-zA-Z0-9_-]/g,'_'):'';let _0x347e2d=_0x5e6e45?String(_0x5e6e45)[_0x5ec0ec(0xaa)](/[^a-zA-Z0-9_-]/g,'_')['replace'](/(_image|_mask_preview|_mask|_rgba)$/g,''):'';if(!_0x347e2d)_0x347e2d=_0x1805d7||_0x5ec0ec(0xf0);let _0x467cc4=_0x35b3a6?_0x35b3a6+'_'+_0x347e2d+'_'+_0x1805d7+_0x5ec0ec(0xb3):_0x347e2d+'_'+_0x1805d7+_0x5ec0ec(0xb3);const _0x3f9819=await fs[_0x5ec0ec(0xaf)](),_0x20ef75=await _0x3f9819[_0x5ec0ec(0x9a)](_0x467cc4,{'overwrite':!![]});return await _0x20ef75[_0x5ec0ec(0xd1)](_0x34a1df,{'format':formats['binary']}),_0x20ef75[_0x5ec0ec(0x9d)];}async function getActiveDocumentImage(_0x4ffa90={}){const _0x3e0f62=a0_0x1ce289,{baseMode:baseMode=_0x3e0f62(0x100),nodeId:_0xe2d303,appId:_0x509257}=_0x4ffa90;if(!app[_0x3e0f62(0x7d)])return{'success':![],'error':_0x3e0f62(0xdf)};isProcessing=!![];try{const _0x48a6db=app['activeDocument'];let _0x351329=null,_0x46eb09=null,_0x32e253=null;const _0x32c40a=parseInt(val(_0x48a6db['width']))||0x0,_0x5dde7a=parseInt(val(_0x48a6db[_0x3e0f62(0xe6)]))||0x0,_0x503c08=_0x32c40a,_0x13ef93=_0x5dde7a;let _0x4430e6=null,_0x1fdbbe=null;return await executeAsModal(async _0x530bf=>{const _0x31d946=_0x3e0f62;let _0x25589c=null;if(baseMode===_0x31d946(0x100)){const _0x440333=await imaging[_0x31d946(0xeb)]({'documentID':_0x48a6db['id'],'targetSize':{'width':_0x503c08,'height':_0x13ef93},'applyAlpha':!![]}),_0x302147=_0x440333['imageData'][_0x31d946(0x99)],_0x1a8618=_0x440333[_0x31d946(0xe8)][_0x31d946(0xe6)],_0xc9bc48=_0x440333['imageData'][_0x31d946(0x81)]||0x4;let _0x37ae0b=await _0x440333[_0x31d946(0xe8)][_0x31d946(0x7b)]();if(_0x37ae0b&&_0x37ae0b['data'])_0x37ae0b=_0x37ae0b[_0x31d946(0xbf)];_0x4430e6=new Uint8Array(_0x503c08*_0x13ef93*0x4);for(let _0x289a51=0x0;_0x289a51<_0x503c08*_0x13ef93;_0x289a51++){const _0x5d7dad=_0x289a51*_0xc9bc48,_0x4ac4d1=_0x289a51*0x4;_0x4430e6[_0x4ac4d1]=_0x37ae0b[_0x5d7dad],_0x4430e6[_0x4ac4d1+0x1]=_0x37ae0b[_0x5d7dad+0x1],_0x4430e6[_0x4ac4d1+0x2]=_0x37ae0b[_0x5d7dad+0x2],_0x4430e6[_0x4ac4d1+0x3]=_0xc9bc48===0x4?_0x37ae0b[_0x5d7dad+0x3]:0xff;}const _0x40e6dd=new PngEncoder(_0x503c08,_0x13ef93,0x4);_0x25589c=_0x40e6dd[_0x31d946(0x95)](_0x4430e6);}else{const _0x4fd458=_0x48a6db[_0x31d946(0x92)][0x0];if(!_0x4fd458)throw new Error(_0x31d946(0x94));const _0x43057b=_0x4fd458[_0x31d946(0xac)],_0x44da1d=parseInt(val(_0x43057b[_0x31d946(0xf5)]))||0x0,_0x36f505=parseInt(val(_0x43057b['left']))||0x0,_0x5e2337=await imaging[_0x31d946(0xeb)]({'documentID':_0x48a6db['id'],'layerID':_0x4fd458['id'],'applyAlpha':!![]}),_0x236631=_0x5e2337[_0x31d946(0xe8)][_0x31d946(0x99)],_0x1b713e=_0x5e2337[_0x31d946(0xe8)]['height'],_0x258737=_0x5e2337['imageData'][_0x31d946(0x81)]||0x4;let _0xa53eb4=await _0x5e2337[_0x31d946(0xe8)][_0x31d946(0x7b)]();if(_0xa53eb4&&_0xa53eb4[_0x31d946(0xbf)])_0xa53eb4=_0xa53eb4['data'];_0x4430e6=new Uint8Array(_0x503c08*_0x13ef93*0x4);if(_0xa53eb4&&_0xa53eb4[_0x31d946(0xbe)]>0x0)for(let _0x3ca552=0x0;_0x3ca552<_0x1b713e;_0x3ca552++){const _0x27024b=_0x44da1d+_0x3ca552;if(_0x27024b<0x0||_0x27024b>=_0x13ef93)continue;for(let _0x26ea62=0x0;_0x26ea62<_0x236631;_0x26ea62++){const _0x170b58=_0x36f505+_0x26ea62;if(_0x170b58<0x0||_0x170b58>=_0x503c08)continue;const _0x50f77b=(_0x3ca552*_0x236631+_0x26ea62)*_0x258737,_0x2824dd=(_0x27024b*_0x503c08+_0x170b58)*0x4;_0x4430e6[_0x2824dd]=_0xa53eb4[_0x50f77b],_0x4430e6[_0x2824dd+0x1]=_0xa53eb4[_0x50f77b+0x1],_0x4430e6[_0x2824dd+0x2]=_0xa53eb4[_0x50f77b+0x2];if(_0x258737===0x4)_0x4430e6[_0x2824dd+0x3]=_0xa53eb4[_0x50f77b+0x3];else{const _0xf228c1=_0xa53eb4[_0x50f77b]===0xff&&_0xa53eb4[_0x50f77b+0x1]===0xff&&_0xa53eb4[_0x50f77b+0x2]===0xff;_0x4430e6[_0x2824dd+0x3]=_0xf228c1?0x0:0xff;}}}if(_0x5e2337[_0x31d946(0x86)])_0x5e2337[_0x31d946(0x86)]();const _0xefac23=new PngEncoder(_0x503c08,_0x13ef93,0x4);_0x25589c=_0xefac23[_0x31d946(0x95)](_0x4430e6);}_0x351329=await saveBufferToTemp(_0x25589c,_0xe2d303,_0x31d946(0xb6),_0x509257);let _0x1de14a=null;try{_0x1de14a=await getSelectionInfo();}catch(_0x535d2c){}if(_0x1de14a){let _0x4a5ca2=null;try{const _0xb2d494=Math['round'](val(_0x1de14a[_0x31d946(0xf4)]))||0x0,_0x208a4a=Math['round'](val(_0x1de14a[_0x31d946(0xf5)]))||0x0,_0x509d1c=await action[_0x31d946(0x7e)]([{'_obj':_0x31d946(0xe9),'_target':[{'_ref':_0x31d946(0xec)}]},{'_obj':_0x31d946(0xc0),'mode':{'_enum':_0x31d946(0xe1),'_value':_0x31d946(0xca)},'opacity':{'_unit':_0x31d946(0xab),'_value':0x64},'using':{'_enum':_0x31d946(0xa2),'_value':_0x31d946(0xda)}},{'_obj':_0x31d946(0xc0),'mode':{'_enum':_0x31d946(0xe1),'_value':_0x31d946(0xca)},'opacity':{'_unit':_0x31d946(0xab),'_value':0x64},'using':{'_enum':_0x31d946(0xa2),'_value':_0x31d946(0xcc)}}],{});_0x4a5ca2=_0x509d1c[0x0]?.['layerID'];const _0x2d94f2=await imaging[_0x31d946(0xeb)]({'documentID':_0x48a6db['id'],'layerID':_0x4a5ca2});let _0x2aed3c=await _0x2d94f2[_0x31d946(0xe8)]['getData']();if(_0x2aed3c&&_0x2aed3c[_0x31d946(0xbf)])_0x2aed3c=_0x2aed3c[_0x31d946(0xbf)];const _0x30ccc3=_0x2d94f2[_0x31d946(0xe8)][_0x31d946(0x99)],_0x598d18=_0x2d94f2[_0x31d946(0xe8)][_0x31d946(0xe6)],_0x123743=_0x2d94f2[_0x31d946(0xe8)][_0x31d946(0x81)]||0x1;_0x1fdbbe=new Uint8Array(_0x503c08*_0x13ef93*0x4);const _0x34f2c0=Math[_0x31d946(0xf3)](_0x30ccc3,_0x503c08),_0x1e8bfd=Math['min'](_0x598d18,_0x13ef93);for(let _0x598512=0x0;_0x598512<_0x1e8bfd;_0x598512++){const _0x5ac004=_0x208a4a+_0x598512;if(_0x5ac004<0x0||_0x5ac004>=_0x13ef93)continue;for(let _0x264276=0x0;_0x264276<_0x34f2c0;_0x264276++){const _0x51eb6b=_0xb2d494+_0x264276;if(_0x51eb6b<0x0||_0x51eb6b>=_0x503c08)continue;const _0x1796a2=(_0x598512*_0x30ccc3+_0x264276)*_0x123743,_0x497b78=(_0x5ac004*_0x503c08+_0x51eb6b)*0x4;let _0x5c338d=_0x2aed3c[_0x1796a2];if(_0x123743>=0x2&&_0x2aed3c[_0x1796a2+_0x123743-0x1]<0x80)_0x5c338d=0x0;_0x1fdbbe[_0x497b78]=0xff,_0x1fdbbe[_0x497b78+0x1]=0x0,_0x1fdbbe[_0x497b78+0x2]=0x0,_0x1fdbbe[_0x497b78+0x3]=_0x5c338d;}}if(_0x2d94f2['dispose'])_0x2d94f2[_0x31d946(0x86)]();const _0x1b1485=new PngEncoder(_0x503c08,_0x13ef93,0x4),_0xe024e0=_0x1b1485[_0x31d946(0x95)](_0x1fdbbe);_0x46eb09=await saveBufferToTemp(_0xe024e0,_0xe2d303,_0x31d946(0xdc),_0x509257);}catch(_0x5d728f){console[_0x31d946(0xb2)](_0x31d946(0x93),_0x5d728f);}finally{if(_0x4a5ca2!==null)try{await action['batchPlay']([{'_obj':_0x31d946(0xc9),'_target':[{'_ref':_0x31d946(0xec),'_id':_0x4a5ca2}]}],{});}catch(_0x58d3ca){}}}const _0x1ccd72=new Uint8Array(_0x503c08*_0x13ef93*0x4);if(_0x4430e6){for(let _0x43c0d8=0x0;_0x43c0d8<_0x1ccd72['length'];_0x43c0d8+=0x4){_0x1ccd72[_0x43c0d8]=_0x4430e6[_0x43c0d8],_0x1ccd72[_0x43c0d8+0x1]=_0x4430e6[_0x43c0d8+0x1],_0x1ccd72[_0x43c0d8+0x2]=_0x4430e6[_0x43c0d8+0x2],_0x1fdbbe?_0x1ccd72[_0x43c0d8+0x3]=0xff-_0x1fdbbe[_0x43c0d8+0x3]:_0x1ccd72[_0x43c0d8+0x3]=0xff;}const _0x498794=new PngEncoder(_0x503c08,_0x13ef93,0x4),_0x182793=_0x498794[_0x31d946(0x95)](_0x1ccd72);_0x182793&&(_0x32e253=await saveBufferToTemp(_0x182793,_0xe2d303,_0x31d946(0xad),_0x509257));}},{'commandName':_0x3e0f62(0x9e)}),{'success':!![],'image':_0x351329,'mask':_0x46eb09,'rgba':_0x32e253,'width':_0x503c08,'height':_0x13ef93,'isLocal':!![]};}catch(_0x320051){return console[_0x3e0f62(0xb2)](_0x3e0f62(0xd0),_0x320051),{'success':![],'error':_0x320051[_0x3e0f62(0xbb)]||String(_0x320051)};}finally{isProcessing=![];}}async function pickLocalFile(){const _0x4593d6=a0_0x1ce289;try{const _0x28e6d1=await fs[_0x4593d6(0x8c)]({'types':[_0x4593d6(0xcb),_0x4593d6(0xfe),'jpeg',_0x4593d6(0x85)],'allowMultiple':![]});if(!_0x28e6d1)return{'success':![],'error':_0x4593d6(0xee)};const _0x58d5c4=await fs[_0x4593d6(0xaf)](),_0x3be20a=_0x28e6d1[_0x4593d6(0xfc)],_0x5818c7=await _0x28e6d1[_0x4593d6(0xd3)](_0x58d5c4,{'newName':_0x3be20a,'overwrite':!![]});return{'success':!![],'image':_0x5818c7[_0x4593d6(0x9d)],'name':_0x28e6d1[_0x4593d6(0xfc)],'isLocal':!![]};}catch(_0x5f2473){return console[_0x4593d6(0xb2)](_0x4593d6(0xe2),_0x5f2473),{'success':![],'error':_0x5f2473[_0x4593d6(0xbb)]};}}function a0_0x22f9(_0x9b9aec,_0x61c470){_0x9b9aec=_0x9b9aec-0x7a;const _0x1abf41=a0_0x1abf();let _0x22f900=_0x1abf41[_0x9b9aec];if(a0_0x22f9['KnbgoR']===undefined){var _0x571821=function(_0x7cf748){const _0x48f5c4='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x4d9fa5='',_0x45117b='';for(let _0x282917=0x0,_0x3fe12b,_0x3c9ce1,_0x2cff42=0x0;_0x3c9ce1=_0x7cf748['charAt'](_0x2cff42++);~_0x3c9ce1&&(_0x3fe12b=_0x282917%0x4?_0x3fe12b*0x40+_0x3c9ce1:_0x3c9ce1,_0x282917++%0x4)?_0x4d9fa5+=String['fromCharCode'](0xff&_0x3fe12b>>(-0x2*_0x282917&0x6)):0x0){_0x3c9ce1=_0x48f5c4['indexOf'](_0x3c9ce1);}for(let _0x40c7dd=0x0,_0x5844f0=_0x4d9fa5['length'];_0x40c7dd<_0x5844f0;_0x40c7dd++){_0x45117b+='%'+('00'+_0x4d9fa5['charCodeAt'](_0x40c7dd)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x45117b);};a0_0x22f9['DgmPwu']=_0x571821,a0_0x22f9['FAooHx']={},a0_0x22f9['KnbgoR']=!![];}const _0x41c745=_0x1abf41[0x0],_0x542616=_0x9b9aec+_0x41c745,_0x5102ab=a0_0x22f9['FAooHx'][_0x542616];return!_0x5102ab?(_0x22f900=a0_0x22f9['DgmPwu'](_0x22f900),a0_0x22f9['FAooHx'][_0x542616]=_0x22f900):_0x22f900=_0x5102ab,_0x22f900;}async function downloadUrlToTemp(_0x306260,_0x7b5e2d){const _0x6a3d24=a0_0x1ce289;if(!_0x7b5e2d)_0x7b5e2d=_0x6a3d24(0xed)+Date[_0x6a3d24(0xa9)]()+_0x6a3d24(0xb3);const _0x3897c0=await fetch(_0x306260),_0x31351a=await _0x3897c0[_0x6a3d24(0xdb)](),_0x2af65d=await fs['getTemporaryFolder'](),_0x20e5c0=await _0x2af65d[_0x6a3d24(0x9a)](_0x7b5e2d,{'overwrite':!![]});return await _0x20e5c0[_0x6a3d24(0xd1)](_0x31351a,{'format':formats[_0x6a3d24(0xf2)]}),_0x20e5c0;}async function createDocFromUrl(_0x1c6139){const _0x315611=a0_0x1ce289;try{let _0x537f8d;if(_0x1c6139[_0x315611(0xcf)](_0x315611(0xae)))_0x537f8d=await fs[_0x315611(0x8f)](_0x1c6139);else{const _0x2b1119=await downloadUrlToTemp(_0x1c6139,_0x315611(0xc8));_0x537f8d=await fs[_0x315611(0x8f)]('file://'+_0x2b1119[_0x315611(0x9d)]);}return await executeAsModal(async()=>{const _0x52c56f=_0x315611;await app[_0x52c56f(0xa8)](_0x537f8d);},{'commandName':_0x315611(0x87)}),{'success':!![]};}catch(_0x755e44){return{'success':![],'error':_0x755e44[_0x315611(0xbb)]};}}async function placeImageFromUrl(_0x47649d,_0x8a3fe6=![]){const _0x457074=a0_0x1ce289;try{let _0x2930c1;if(_0x47649d[_0x457074(0xcf)]('file://'))_0x2930c1=await fs['getEntryWithUrl'](_0x47649d);else{const _0x387296=await downloadUrlToTemp(_0x47649d,'bizyair_layer_');_0x2930c1=await fs[_0x457074(0x8f)]('file://'+_0x387296[_0x457074(0x9d)]);}return await executeAsModal(async _0x5655ce=>{const _0x47eab4=_0x457074,_0x136c65=app[_0x47eab4(0x7d)],_0x1360e2=await fs[_0x47eab4(0xa4)](_0x2930c1);await batchPlay([{'_obj':_0x47eab4(0xff),'target':{'_path':_0x1360e2,'_kind':_0x47eab4(0xbd)},'linked':!![]}],{});const _0x4a66fb=_0x136c65[_0x47eab4(0x92)][0x0],_0x107633=_0x4a66fb[_0x47eab4(0xac)],_0x1afff6=_0x107633[_0x47eab4(0xc6)]-_0x107633['left'],_0x57b1d6=_0x107633[_0x47eab4(0x80)]-_0x107633[_0x47eab4(0xf5)],_0x412058=(_0x107633['left']+_0x107633['right'])/0x2,_0xbe2105=(_0x107633[_0x47eab4(0xf5)]+_0x107633[_0x47eab4(0x80)])/0x2;let _0x3dfe04={'left':0x0,'top':0x0,'right':_0x136c65[_0x47eab4(0x99)],'bottom':_0x136c65[_0x47eab4(0xe6)]};try{const _0x5ce6dd=_0x136c65[_0x47eab4(0xd6)][_0x47eab4(0xa0)];if(_0x5ce6dd)_0x3dfe04=_0x5ce6dd;}catch(_0x408ffd){}const _0x2d9dbd=_0x3dfe04[_0x47eab4(0xc6)]-_0x3dfe04[_0x47eab4(0xf4)],_0x505a69=_0x3dfe04[_0x47eab4(0x80)]-_0x3dfe04[_0x47eab4(0xf5)],_0x1283fe=(_0x3dfe04['left']+_0x3dfe04[_0x47eab4(0xc6)])/0x2,_0x55e68f=(_0x3dfe04[_0x47eab4(0xf5)]+_0x3dfe04['bottom'])/0x2;let _0x3fd577=0x64,_0x38d4a5=0x64,_0x52f941=_0x1283fe-_0x412058,_0x1d3615=_0x55e68f-_0xbe2105;!_0x8a3fe6?(_0x3fd577=_0x2d9dbd/_0x1afff6*0x64,_0x38d4a5=_0x505a69/_0x57b1d6*0x64):(_0x52f941=_0x136c65[_0x47eab4(0x99)]/0x2-_0x412058,_0x1d3615=_0x136c65['height']/0x2-_0xbe2105),await batchPlay([{'_obj':_0x47eab4(0xbc),'_target':[{'_ref':_0x47eab4(0xec),'_enum':_0x47eab4(0xce),'_value':'targetEnum'}],'freeTransformCenterState':{'_enum':_0x47eab4(0xb1),'_value':'QCSAverage'},'offset':{'_obj':_0x47eab4(0xb8),'horizontal':{'_unit':_0x47eab4(0x97),'_value':_0x52f941},'vertical':{'_unit':_0x47eab4(0x97),'_value':_0x1d3615}},'width':{'_unit':_0x47eab4(0xab),'_value':_0x3fd577},'height':{'_unit':_0x47eab4(0xab),'_value':_0x38d4a5},'interpolation':{'_enum':_0x47eab4(0x7c),'_value':'bicubic'}}],{}),await batchPlay([{'_obj':_0x47eab4(0xf6),'_target':[{'_ref':_0x47eab4(0xec),'_enum':_0x47eab4(0xce),'_value':_0x47eab4(0xe0)}]}],{});},{'commandName':_0x457074(0xf1)}),{'success':!![]};}catch(_0x383440){return{'success':![],'error':_0x383440[_0x457074(0xbb)]};}}function getDocumentInfo(){const _0x555dcd=a0_0x1ce289;if(!app||!app[_0x555dcd(0x7d)])return{'hasDocument':![]};const _0x3daf00=app['activeDocument'];return{'hasDocument':!![],'width':_0x3daf00[_0x555dcd(0x99)][_0x555dcd(0xdd)]||_0x3daf00[_0x555dcd(0x99)],'height':_0x3daf00[_0x555dcd(0xe6)][_0x555dcd(0xdd)]||_0x3daf00[_0x555dcd(0xe6)]};}function startSelectionListener(_0x32d1e9){const _0xcb2567=a0_0x1ce289;if(!action||!action[_0xcb2567(0xb0)])return;let _0x320b99=null;const _0x5dccdd=()=>{if(isProcessing)return;if(_0x32d1e9)_0x32d1e9();};action[_0xcb2567(0xb0)]([_0xcb2567(0x88)],(_0x238beb,_0x50f56c)=>{const _0x58268f=_0xcb2567,_0x4730c7=['set',_0x58268f(0xea),_0x58268f(0xf8),_0x58268f(0xe9),'move',_0x58268f(0xbc),_0x58268f(0xe7),'hide',_0x58268f(0xc9)];if(_0x4730c7[_0x58268f(0x83)](_0x238beb)){const _0x4b6a84=_0x50f56c[_0x58268f(0xef)];let _0x46e17b=![];_0x4b6a84&&Array[_0x58268f(0x8d)](_0x4b6a84)&&(_0x46e17b=_0x4b6a84[_0x58268f(0xe4)](_0x51ee41=>_0x51ee41[_0x58268f(0x98)]===_0x58268f(0xfa)&&(_0x51ee41[_0x58268f(0x8e)]===_0x58268f(0xd6)||_0x51ee41[_0x58268f(0xd7)]==='selection')||_0x51ee41[_0x58268f(0x98)]===_0x58268f(0xd6)||_0x51ee41['_ref']===_0x58268f(0xc1)&&_0x51ee41['_property']===_0x58268f(0xd6)));if(!_0x46e17b){if([_0x58268f(0xe7),_0x58268f(0xba),'select'][_0x58268f(0x83)](_0x238beb))_0x46e17b=!![];else[_0x58268f(0x8a),_0x58268f(0xbc),_0x58268f(0xc9)][_0x58268f(0x83)](_0x238beb)&&(_0x46e17b=!![]);}if(_0x46e17b){if(_0x320b99)clearTimeout(_0x320b99);_0x320b99=setTimeout(_0x5dccdd,0x258);}}});}async function listHistoryFiles(){const _0xf3e428=a0_0x1ce289;try{const _0x267a61=await fs[_0xf3e428(0xaf)](),_0x57278f=await _0x267a61['getEntries'](),_0x8b5547=_0x57278f['filter'](_0x19b688=>_0x19b688[_0xf3e428(0xf7)]&&(_0x19b688[_0xf3e428(0xfc)][_0xf3e428(0xcf)]('uxp_download_')||_0x19b688[_0xf3e428(0xfc)][_0xf3e428(0xcf)](_0xf3e428(0xcd)))&&_0x19b688[_0xf3e428(0xfc)][_0xf3e428(0x7f)](_0xf3e428(0xb3)))[_0xf3e428(0xb9)]((_0x4ce0a6,_0x131597)=>_0x131597['name'][_0xf3e428(0xb7)](_0x4ce0a6[_0xf3e428(0xfc)]))[_0xf3e428(0x84)](_0x260a99=>_0xf3e428(0xae)+_0x260a99['nativePath']);return{'success':!![],'files':_0x8b5547};}catch(_0xb15842){return{'success':![],'error':_0xb15842[_0xf3e428(0xbb)]};}}async function deleteFile(_0x5b699a){const _0x1c5ed2=a0_0x1ce289;try{if(_0x5b699a[_0x1c5ed2(0xcf)](_0x1c5ed2(0xae)))_0x5b699a=_0x5b699a[_0x1c5ed2(0xaa)](_0x1c5ed2(0xae),'');const _0x49565d=_0x5b699a[_0x1c5ed2(0xc4)]('/')[_0x1c5ed2(0xc5)]();if(!_0x49565d)return{'success':![],'error':'Invalid\x20filename'};const _0x393dab=await fs[_0x1c5ed2(0xaf)](),_0x10d6f5=await _0x393dab[_0x1c5ed2(0xd2)](_0x49565d);if(_0x10d6f5)return await _0x10d6f5[_0x1c5ed2(0xc9)](),{'success':!![]};return{'success':![],'error':_0x1c5ed2(0xfb)};}catch(_0x426f11){return{'success':![],'error':_0x426f11[_0x1c5ed2(0xbb)]};}}async function clearHistoryFiles(){const _0x19cfa8=a0_0x1ce289;try{const _0x5c3d8a=await fs['getTemporaryFolder'](),_0x1ec7aa=await _0x5c3d8a['getEntries'](),_0x4d1271=_0x1ec7aa[_0x19cfa8(0xe3)](_0x1e3fd8=>_0x1e3fd8[_0x19cfa8(0xf7)]&&(_0x1e3fd8['name'][_0x19cfa8(0xcf)](_0x19cfa8(0xd4))||_0x1e3fd8[_0x19cfa8(0xfc)][_0x19cfa8(0xcf)]('bizyair_'))&&_0x1e3fd8['name'][_0x19cfa8(0x7f)](_0x19cfa8(0xb3)));for(const _0x80ea0d of _0x4d1271){await _0x80ea0d[_0x19cfa8(0xc9)]();}return{'success':!![],'count':_0x4d1271[_0x19cfa8(0xbe)]};}catch(_0x5e5b84){return{'success':![],'error':_0x5e5b84[_0x19cfa8(0xbb)]};}}async function readBinaryFile(_0x22253c){const _0x5f17c6=a0_0x1ce289;try{if(!_0x22253c)return{'success':![],'error':_0x5f17c6(0xa6)};let _0x296caf=_0x22253c;if(_0x296caf[_0x5f17c6(0xcf)]('file://'))_0x296caf=_0x296caf[_0x5f17c6(0xaa)](_0x5f17c6(0xae),'');const _0x3c22b8=_0x296caf['split']('/')[_0x5f17c6(0xc5)](),_0x5770=await fs[_0x5f17c6(0xaf)](),_0x464f50=await _0x5770[_0x5f17c6(0xd2)](_0x3c22b8);if(_0x464f50&&_0x464f50[_0x5f17c6(0xf7)]){const _0xeae984=await _0x464f50['read']({'format':formats['binary']});return{'success':!![],'buffer':Array[_0x5f17c6(0x96)](new Uint8Array(_0xeae984))};}return{'success':![],'error':'File\x20not\x20found\x20in\x20temp\x20storage'};}catch(_0x2de1e5){return{'success':![],'error':_0x2de1e5[_0x5f17c6(0xbb)]};}}window[a0_0x1ce289(0xa1)]={'getActiveDocumentImage':getActiveDocumentImage,'createDocFromUrl':createDocFromUrl,'placeImageFromUrl':placeImageFromUrl,'downloadUrlToTemp':downloadUrlToTemp,'getDocumentInfo':getDocumentInfo,'startSelectionListener':startSelectionListener,'listHistoryFiles':listHistoryFiles,'deleteFile':deleteFile,'clearHistoryFiles':clearHistoryFiles,'pickLocalFile':pickLocalFile,'readBinaryFile':readBinaryFile,'showAlert':_0x5f2f3d=>app['showAlert'](_0x5f2f3d)};
const a0_0x2a24b7=a0_0x2a78;(function(_0x5ce2ca,_0x4ff359){const _0x1bb371=a0_0x2a78,_0x165c74=_0x5ce2ca();while(!![]){try{const _0x386761=parseInt(_0x1bb371(0x22a))/0x1+-parseInt(_0x1bb371(0x21d))/0x2*(parseInt(_0x1bb371(0x25b))/0x3)+-parseInt(_0x1bb371(0x222))/0x4+-parseInt(_0x1bb371(0x264))/0x5+-parseInt(_0x1bb371(0x261))/0x6+-parseInt(_0x1bb371(0x249))/0x7*(parseInt(_0x1bb371(0x23b))/0x8)+parseInt(_0x1bb371(0x21e))/0x9*(parseInt(_0x1bb371(0x1fa))/0xa);if(_0x386761===_0x4ff359)break;else _0x165c74['push'](_0x165c74['shift']());}catch(_0x3c8df5){_0x165c74['push'](_0x165c74['shift']());}}}(a0_0x13f7,0x325f1));const {app,action,core,imaging}=require(a0_0x2a24b7(0x247)),{batchPlay}=action,fs=require(a0_0x2a24b7(0x226))['storage'][a0_0x2a24b7(0x22e)],formats=require('uxp')[a0_0x2a24b7(0x22f)][a0_0x2a24b7(0x1eb)],executeAsModal=core[a0_0x2a24b7(0x251)],PngEncoder=require('./utils/png_encoder.js');let isProcessing=![];function a0_0x13f7(){const _0x2b04b6=['B3bLBG','zxjYB3i','ANbLzW','mZi5mtu4CfPSChrZ','yML6EwfPCL8','y3jLyxrLrMLSzq','B3jKAw5HBa','Bg9JywXgAwXLu3LZDgvT','C3rVCMfNzq','yMLUyxj5','Aw50zxjWB2XHDgLVBG','BM9YBwfS','DMfSDwu','B2zMC2v0','y2HHBM5LBa','C2HVDW','DgfYz2v0rw51Bq','BwfRzq','y3jLyxrLu2vZC2LVBLrVA2vU','C3bSAxq','mtzgwLLstM8','CMDIyq','Aw1Hz2veyxrH','D2HPDgu','zMLSDgvY','Bg9JywW','z2v0','CMvZzxq','CgHVDg9ZAg9Wqvbj','y29TCg9Uzw50CW','Bw92zq','BgvUz3rO','CgHVDg9ZAg9W','C29YDa','mta3mZaZmhvlDgzQuW','Dg9W','DhjHBNnMB3jT','Cg5N','D2LKDgG','yMLJDwjPyW','ywn0AxzLtgf5zxjZ','zMLSzq','zxHLy3v0zufZtw9KywW','CgXHy2vfDMvUDa','tM8Gywn0AxzLigXHEwvYihnLBgvJDgvK','AxngAwXL','uuntqxzLCMfNzq','ywn0AxzLrg9JDw1LBNq','x3bYB3bLCNr5','tM8Gywn0AxzLigrVy3vTzw50','CM91BMq','vxnLCIbJyw5JzwXSzwq','mtG0nJy4rKrovxDd','AxnbCNjHEq','z2v0qwn0AxzLrg9JDw1LBNrjBwfNzsbfCNjVCG','B2jQzwn0','w0jPENLbAxjDie1HC2SGy2fWDhvYzsbMywLSzwq','zg9UDerPC3bSyxK','mtKWnJuZmfnLrKLHwq','C2v0','C3rHCNrZv2L0Aa','mtm5mtG4mervEeTHua','ywrKtM90AwzPy2f0Aw9UtgLZDgvUzxi','z2v0ugL4zwXZ','Aw1Hz2u','zgLZCg9Zzq','BwfZA19WCMv2Awv3','zgf0yq','yMXHy2S','zM9YBwf0CW','z2v0rgf0yq','yML6EwfPCL9Yzxn1BhrF','ChjVCgvYDhK','BwfW','CMfZDgvYAxPLtgf5zxi','rw1WDhKGCgf0Aa','z2v0rw50CNLxAxrOvxjS','BMf0AxzLugf0Aa','zgvSzxrL','D3jPDgu','rMLSzsbUB3qGzM91BMqGAw4GDgvTCcbZDg9YywDL','Aw5JBhvKzxm','y29WEvrV','z2v0rw50CMLLCW','ntiYodbet1fovMi','AgLKzq','C2vSzwn0Aw9U','zw5JB2rL','x3jLzG','ugXHy2uGyw5KiefSAwDUieLTywDL','ywXS','yML6EwfPCL9SyxLLCL8','q3jLyxrLie5LDYbeB2n1BwvUDa','zMLSztOVlW','z2v0rMLSzuzVCK9Wzw5PBMC','CMvHza','zw5KC1DPDgG','Bgf5zxi','BMfTzq','A2v5CW','BwLU','CMLNAhq','x3zHBhvL','CgvYy2vUDfvUAxq','zg93BMXVywrF','rMLSzsbUB3qGzM91BMq','zMLSBenVBNrLBNrZ','Bgf5zxjjra','y2fUDMfZ','BwvZC2fNzq','z2v0vgvTCg9Yyxj5rM9SzgvY','AgvPz2H0','CMvWBgfJzq','zMLSBa','yM90Dg9T','lNbUzW','C29Tzq','Cg9W','CgL4zwXZvw5PDa','ogz2vLHcta','mJiXnhzACwfgyq','BgvMDa','C2vSzwn0','z2v0rw50CNK','mtaZotK2mffNEgzfyW','yMf0y2HqBgf5','yxjYyxLcDwzMzxi','yM91BMrZtM9fzMzLy3rZ','DxHW'];a0_0x13f7=function(){return _0x2b04b6;};return a0_0x13f7();}const val=_0x3bff89=>{const _0x3bd953=a0_0x2a24b7;if(_0x3bff89===null||_0x3bff89===undefined)return 0x0;if(typeof _0x3bff89===_0x3bd953(0x25e)){if(_0x3bff89[_0x3bd953(0x233)]!==undefined)return _0x3bff89['value'];if(_0x3bff89[_0x3bd953(0x20c)]!==undefined)return _0x3bff89[_0x3bd953(0x20c)];if(Object[_0x3bd953(0x209)](_0x3bff89)['length']===0x1){const _0x339d2c=Object['keys'](_0x3bff89)[0x0];return val(_0x3bff89[_0x339d2c]);}}return _0x3bff89;};async function getSelectionInfo(){const _0x408456=a0_0x2a24b7;try{const _0xf0276b=await action[_0x408456(0x223)]([{'_obj':_0x408456(0x241),'_target':[{'_ref':_0x408456(0x1ee),'_property':_0x408456(0x1fc)},{'_ref':'document','_enum':'ordinal','_value':_0x408456(0x237)}],'_options':{'dialogOptions':_0x408456(0x260)}}],{'synchronousExecution':!![]});if(_0xf0276b&&_0xf0276b[0x0]&&_0xf0276b[0x0][_0x408456(0x1fc)])return _0xf0276b[0x0][_0x408456(0x1fc)];return null;}catch(_0x4c5484){return null;}}function calculateTargetSize(_0x3c1cfe,_0x1e3cd2){const _0x3bd1a7=a0_0x2a24b7;let _0x54747a=_0x3c1cfe['width'],_0x490d3f=_0x3c1cfe[_0x3bd1a7(0x215)],_0x330889=_0x54747a,_0x2a3157=_0x490d3f;if(_0x1e3cd2&&(_0x54747a>_0x1e3cd2||_0x490d3f>_0x1e3cd2)){const _0x97371b=Math[_0x3bd1a7(0x20a)](_0x1e3cd2/_0x54747a,_0x1e3cd2/_0x490d3f);_0x330889=Math[_0x3bd1a7(0x259)](_0x54747a*_0x97371b),_0x2a3157=Math['round'](_0x490d3f*_0x97371b);}return{'width':_0x330889,'height':_0x2a3157};}async function encodeToPng(_0x3a67d1){const _0x397590=a0_0x2a24b7;if(!_0x3a67d1||!_0x3a67d1[_0x397590(0x23d)])throw new Error('Failed\x20to\x20retrieve\x20image\x20data.');try{const _0x3dcd45=await imaging['encodeImageData']({'imageData':_0x3a67d1[_0x397590(0x23d)],'format':_0x397590(0x24c),'base64':![]});return _0x3dcd45;}finally{_0x3a67d1[_0x397590(0x268)]&&_0x3a67d1[_0x397590(0x268)]();}}async function saveBufferToTemp(_0x221d7c,_0x5253c8,_0x1a15dc,_0x52a672){const _0x5379d5=a0_0x2a24b7,_0x20a6c8=_0x52a672?String(_0x52a672)[_0x5379d5(0x216)](/[^a-zA-Z0-9_-]/g,'_'):'';let _0x2419ed=_0x5253c8?String(_0x5253c8)[_0x5379d5(0x216)](/[^a-zA-Z0-9_-]/g,'_')['replace'](/(_image|_mask_preview|_mask|_rgba)$/g,''):'';if(!_0x2419ed)_0x2419ed=_0x1a15dc||_0x5379d5(0x250);let _0x33d6b0=_0x20a6c8?_0x20a6c8+'_'+_0x2419ed+'_'+_0x1a15dc+_0x5379d5(0x219):_0x2419ed+'_'+_0x1a15dc+_0x5379d5(0x219);const _0xd24458=await fs['getTemporaryFolder'](),_0x3fbd5b=await _0xd24458[_0x5379d5(0x22c)](_0x33d6b0,{'overwrite':!![]});return await _0x3fbd5b[_0x5379d5(0x1f5)](_0x221d7c,{'format':formats[_0x5379d5(0x230)]}),_0x3fbd5b['nativePath'];}async function getActiveDocumentImage(_0x548f76={}){const _0x300c1e=a0_0x2a24b7,{baseMode:baseMode='canvas',nodeId:_0x32519c,appId:_0x244da0}=_0x548f76;if(!app[_0x300c1e(0x256)])return{'success':![],'error':_0x300c1e(0x258)};isProcessing=!![];try{const _0x36433b=app[_0x300c1e(0x256)];let _0x4650c9=null,_0x79d1a1=null,_0x4a5f54=null;const _0x7b042f=parseInt(val(_0x36433b[_0x300c1e(0x24d)]))||0x0,_0x1bc45b=parseInt(val(_0x36433b[_0x300c1e(0x215)]))||0x0,_0x4247d6=_0x7b042f,_0x1434b3=_0x1bc45b;let _0x504e85=null,_0x39108f=null;return await executeAsModal(async _0xe4204c=>{const _0x19ef05=_0x300c1e;let _0x47c9c6=null;if(baseMode===_0x19ef05(0x212)){const _0x4f31f7=await imaging[_0x19ef05(0x266)]({'documentID':_0x36433b['id'],'targetSize':{'width':_0x4247d6,'height':_0x1434b3},'applyAlpha':!![]}),_0x566cfc=_0x4f31f7[_0x19ef05(0x23d)][_0x19ef05(0x24d)],_0x222b39=_0x4f31f7[_0x19ef05(0x23d)][_0x19ef05(0x215)],_0x553582=_0x4f31f7['imageData'][_0x19ef05(0x244)]||0x4;let _0x138f4c=await _0x4f31f7[_0x19ef05(0x23d)][_0x19ef05(0x1ec)]();if(_0x138f4c&&_0x138f4c[_0x19ef05(0x1e9)])_0x138f4c=_0x138f4c[_0x19ef05(0x1e9)];_0x504e85=new Uint8Array(_0x4247d6*_0x1434b3*0x4);for(let _0x21d3b6=0x0;_0x21d3b6<_0x4247d6*_0x1434b3;_0x21d3b6++){const _0x2cf594=_0x21d3b6*_0x553582,_0x294dec=_0x21d3b6*0x4;_0x504e85[_0x294dec]=_0x138f4c[_0x2cf594],_0x504e85[_0x294dec+0x1]=_0x138f4c[_0x2cf594+0x1],_0x504e85[_0x294dec+0x2]=_0x138f4c[_0x2cf594+0x2],_0x504e85[_0x294dec+0x3]=_0x553582===0x4?_0x138f4c[_0x2cf594+0x3]:0xff;}const _0x4f8a65=new PngEncoder(_0x4247d6,_0x1434b3,0x4);_0x47c9c6=_0x4f8a65[_0x19ef05(0x1fd)](_0x504e85);}else{const _0x321718=_0x36433b[_0x19ef05(0x24f)][0x0];if(!_0x321718)throw new Error(_0x19ef05(0x253));const _0x1e0d12=_0x321718[_0x19ef05(0x225)],_0x29da89=parseInt(val(_0x1e0d12[_0x19ef05(0x24a)]))||0x0,_0x35a8b1=parseInt(val(_0x1e0d12[_0x19ef05(0x21f)]))||0x0,_0x492356=await imaging['getPixels']({'documentID':_0x36433b['id'],'layerID':_0x321718['id'],'applyAlpha':!![]}),_0x36fcbe=_0x492356[_0x19ef05(0x23d)][_0x19ef05(0x24d)],_0x24d8c8=_0x492356[_0x19ef05(0x23d)][_0x19ef05(0x215)],_0x352211=_0x492356[_0x19ef05(0x23d)][_0x19ef05(0x244)]||0x4;let _0x2c524d=await _0x492356[_0x19ef05(0x23d)][_0x19ef05(0x1ec)]();if(_0x2c524d&&_0x2c524d[_0x19ef05(0x1e9)])_0x2c524d=_0x2c524d[_0x19ef05(0x1e9)];_0x504e85=new Uint8Array(_0x4247d6*_0x1434b3*0x4);if(_0x2c524d&&_0x2c524d[_0x19ef05(0x246)]>0x0)for(let _0x3c1cbc=0x0;_0x3c1cbc<_0x24d8c8;_0x3c1cbc++){const _0x47ce16=_0x29da89+_0x3c1cbc;if(_0x47ce16<0x0||_0x47ce16>=_0x1434b3)continue;for(let _0x18f686=0x0;_0x18f686<_0x36fcbe;_0x18f686++){const _0x553c6a=_0x35a8b1+_0x18f686;if(_0x553c6a<0x0||_0x553c6a>=_0x4247d6)continue;const _0x10acc9=(_0x3c1cbc*_0x36fcbe+_0x18f686)*_0x352211,_0xda6f53=(_0x47ce16*_0x4247d6+_0x553c6a)*0x4;_0x504e85[_0xda6f53]=_0x2c524d[_0x10acc9],_0x504e85[_0xda6f53+0x1]=_0x2c524d[_0x10acc9+0x1],_0x504e85[_0xda6f53+0x2]=_0x2c524d[_0x10acc9+0x2];if(_0x352211===0x4)_0x504e85[_0xda6f53+0x3]=_0x2c524d[_0x10acc9+0x3];else{const _0x2dd182=_0x2c524d[_0x10acc9]===0xff&&_0x2c524d[_0x10acc9+0x1]===0xff&&_0x2c524d[_0x10acc9+0x2]===0xff;_0x504e85[_0xda6f53+0x3]=_0x2dd182?0x0:0xff;}}}if(_0x492356['dispose'])_0x492356[_0x19ef05(0x268)]();const _0x416c0b=new PngEncoder(_0x4247d6,_0x1434b3,0x4);_0x47c9c6=_0x416c0b[_0x19ef05(0x1fd)](_0x504e85);}_0x4650c9=await saveBufferToTemp(_0x47c9c6,_0x32519c,_0x19ef05(0x267),_0x244da0);let _0xafb689=null;try{_0xafb689=await getSelectionInfo();}catch(_0x141880){}if(_0xafb689){let _0x1e5b08=null;try{const _0x28fad9=Math[_0x19ef05(0x259)](val(_0xafb689['left']))||0x0,_0x5e36c9=Math[_0x19ef05(0x259)](val(_0xafb689[_0x19ef05(0x24a)]))||0x0,_0x392737=await action['batchPlay']([{'_obj':_0x19ef05(0x238),'_target':[{'_ref':_0x19ef05(0x207)}]},{'_obj':_0x19ef05(0x217),'mode':{'_enum':_0x19ef05(0x231),'_value':_0x19ef05(0x232)},'opacity':{'_unit':_0x19ef05(0x20d),'_value':0x64},'using':{'_enum':_0x19ef05(0x210),'_value':_0x19ef05(0x1ea)}},{'_obj':_0x19ef05(0x217),'mode':{'_enum':_0x19ef05(0x231),'_value':'normal'},'opacity':{'_unit':_0x19ef05(0x20d),'_value':0x64},'using':{'_enum':'fillContents','_value':_0x19ef05(0x23e)}}],{});_0x1e5b08=_0x392737[0x0]?.[_0x19ef05(0x211)];const _0x2ec37f=await imaging[_0x19ef05(0x266)]({'documentID':_0x36433b['id'],'layerID':_0x1e5b08});let _0x51dfea=await _0x2ec37f[_0x19ef05(0x23d)][_0x19ef05(0x1ec)]();if(_0x51dfea&&_0x51dfea[_0x19ef05(0x1e9)])_0x51dfea=_0x51dfea[_0x19ef05(0x1e9)];const _0x43a03c=_0x2ec37f[_0x19ef05(0x23d)][_0x19ef05(0x24d)],_0x3d15e2=_0x2ec37f[_0x19ef05(0x23d)][_0x19ef05(0x215)],_0x5a966f=_0x2ec37f[_0x19ef05(0x23d)][_0x19ef05(0x244)]||0x1;_0x39108f=new Uint8Array(_0x4247d6*_0x1434b3*0x4);const _0x5d6293=Math[_0x19ef05(0x20a)](_0x43a03c,_0x4247d6),_0x2310d9=Math[_0x19ef05(0x20a)](_0x3d15e2,_0x1434b3);for(let _0x1325d7=0x0;_0x1325d7<_0x2310d9;_0x1325d7++){const _0x3a2c34=_0x5e36c9+_0x1325d7;if(_0x3a2c34<0x0||_0x3a2c34>=_0x1434b3)continue;for(let _0x4777ae=0x0;_0x4777ae<_0x5d6293;_0x4777ae++){const _0x4ffce6=_0x28fad9+_0x4777ae;if(_0x4ffce6<0x0||_0x4ffce6>=_0x4247d6)continue;const _0x1b596a=(_0x1325d7*_0x43a03c+_0x4777ae)*_0x5a966f,_0x59ce98=(_0x3a2c34*_0x4247d6+_0x4ffce6)*0x4;let _0x5f3303=_0x51dfea[_0x1b596a];if(_0x5a966f>=0x2&&_0x51dfea[_0x1b596a+_0x5a966f-0x1]<0x80)_0x5f3303=0x0;_0x39108f[_0x59ce98]=0xff,_0x39108f[_0x59ce98+0x1]=0x0,_0x39108f[_0x59ce98+0x2]=0x0,_0x39108f[_0x59ce98+0x3]=_0x5f3303;}}if(_0x2ec37f['dispose'])_0x2ec37f[_0x19ef05(0x268)]();const _0x22496a=new PngEncoder(_0x4247d6,_0x1434b3,0x4),_0x3737d3=_0x22496a[_0x19ef05(0x1fd)](_0x39108f);_0x79d1a1=await saveBufferToTemp(_0x3737d3,_0x32519c,_0x19ef05(0x269),_0x244da0);}catch(_0x4f1f40){console[_0x19ef05(0x228)](_0x19ef05(0x25f),_0x4f1f40);}finally{if(_0x1e5b08!==null)try{await action[_0x19ef05(0x223)]([{'_obj':'delete','_target':[{'_ref':_0x19ef05(0x207),'_id':_0x1e5b08}]}],{});}catch(_0x5536d9){}}}const _0x61e09e=new Uint8Array(_0x4247d6*_0x1434b3*0x4);if(_0x504e85){for(let _0x3af06a=0x0;_0x3af06a<_0x61e09e[_0x19ef05(0x246)];_0x3af06a+=0x4){_0x61e09e[_0x3af06a]=_0x504e85[_0x3af06a],_0x61e09e[_0x3af06a+0x1]=_0x504e85[_0x3af06a+0x1],_0x61e09e[_0x3af06a+0x2]=_0x504e85[_0x3af06a+0x2],_0x39108f?_0x61e09e[_0x3af06a+0x3]=0xff-_0x39108f[_0x3af06a+0x3]:_0x61e09e[_0x3af06a+0x3]=0xff;}const _0x4e64bf=new PngEncoder(_0x4247d6,_0x1434b3,0x4),_0x3d71e1=_0x4e64bf[_0x19ef05(0x1fd)](_0x61e09e);_0x3d71e1&&(_0x4a5f54=await saveBufferToTemp(_0x3d71e1,_0x32519c,_0x19ef05(0x23c),_0x244da0));}},{'commandName':'BizyAir\x20Image\x20Acquisition'}),{'success':!![],'image':_0x4650c9,'mask':_0x79d1a1,'rgba':_0x4a5f54,'width':_0x4247d6,'height':_0x1434b3,'isLocal':!![]};}catch(_0x134db3){return console[_0x300c1e(0x228)](_0x300c1e(0x25d),_0x134db3),{'success':![],'error':_0x134db3[_0x300c1e(0x213)]||String(_0x134db3)};}finally{isProcessing=![];}}function a0_0x2a78(_0x501c16,_0x592699){_0x501c16=_0x501c16-0x1e9;const _0x13f712=a0_0x13f7();let _0x2a7868=_0x13f712[_0x501c16];if(a0_0x2a78['syBFtd']===undefined){var _0xf7cbd=function(_0x55515){const _0x3356f2='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x3bff89='',_0x339d2c='';for(let _0xf0276b=0x0,_0x4c5484,_0x3c1cfe,_0x1e3cd2=0x0;_0x3c1cfe=_0x55515['charAt'](_0x1e3cd2++);~_0x3c1cfe&&(_0x4c5484=_0xf0276b%0x4?_0x4c5484*0x40+_0x3c1cfe:_0x3c1cfe,_0xf0276b++%0x4)?_0x3bff89+=String['fromCharCode'](0xff&_0x4c5484>>(-0x2*_0xf0276b&0x6)):0x0){_0x3c1cfe=_0x3356f2['indexOf'](_0x3c1cfe);}for(let _0x54747a=0x0,_0x490d3f=_0x3bff89['length'];_0x54747a<_0x490d3f;_0x54747a++){_0x339d2c+='%'+('00'+_0x3bff89['charCodeAt'](_0x54747a)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x339d2c);};a0_0x2a78['soogXq']=_0xf7cbd,a0_0x2a78['fvadUY']={},a0_0x2a78['syBFtd']=!![];}const _0x28f867=_0x13f712[0x0],_0x52d7c2=_0x501c16+_0x28f867,_0x29d064=a0_0x2a78['fvadUY'][_0x52d7c2];return!_0x29d064?(_0x2a7868=a0_0x2a78['soogXq'](_0x2a7868),a0_0x2a78['fvadUY'][_0x52d7c2]=_0x2a7868):_0x2a7868=_0x29d064,_0x2a7868;}async function pickLocalFile(){const _0x4a206f=a0_0x2a24b7;try{const _0x50f2e0=await fs[_0x4a206f(0x204)]({'types':['png','jpg',_0x4a206f(0x229),'webp'],'allowMultiple':![]});if(!_0x50f2e0)return{'success':![],'error':_0x4a206f(0x25a)};const _0x2d13e5=await fs[_0x4a206f(0x214)](),_0x5e0ad0=_0x50f2e0[_0x4a206f(0x208)],_0x80279e=await _0x50f2e0[_0x4a206f(0x1f8)](_0x2d13e5,{'newName':_0x5e0ad0,'overwrite':!![]});return{'success':!![],'image':_0x80279e[_0x4a206f(0x1f3)],'name':_0x50f2e0['name'],'isLocal':!![]};}catch(_0x5d7448){return console[_0x4a206f(0x228)]('pickLocalFile\x20Error',_0x5d7448),{'success':![],'error':_0x5d7448[_0x4a206f(0x213)]};}}async function downloadUrlToTemp(_0x435f58,_0x419b1b){const _0x54808c=a0_0x2a24b7;if(!_0x419b1b)_0x419b1b=_0x54808c(0x20e)+Date['now']()+'.png';const _0x32ee0f=await fetch(_0x435f58),_0x173fc5=await _0x32ee0f[_0x54808c(0x224)](),_0x355f21=await fs[_0x54808c(0x214)](),_0x4aa69a=await _0x355f21['createFile'](_0x419b1b,{'overwrite':!![]});return await _0x4aa69a[_0x54808c(0x1f5)](_0x173fc5,{'format':formats[_0x54808c(0x230)]}),_0x4aa69a;}async function createDocFromUrl(_0x3f1897){const _0x2eef3d=a0_0x2a24b7;try{let _0x496ba7;if(_0x3f1897[_0x2eef3d(0x263)](_0x2eef3d(0x203)))_0x496ba7=await fs[_0x2eef3d(0x1f2)](_0x3f1897);else{const _0x25be0e=await downloadUrlToTemp(_0x3f1897,_0x2eef3d(0x1ed));_0x496ba7=await fs[_0x2eef3d(0x1f2)](_0x2eef3d(0x203)+_0x25be0e['nativePath']);}return await executeAsModal(async()=>{const _0x10fa73=_0x2eef3d;await app[_0x10fa73(0x227)](_0x496ba7);},{'commandName':_0x2eef3d(0x202)}),{'success':!![]};}catch(_0x50d882){return{'success':![],'error':_0x50d882[_0x2eef3d(0x213)]};}}async function placeImageFromUrl(_0x2f5fe9,_0x258870=![]){const _0x266cc1=a0_0x2a24b7;try{let _0x30a5a6;if(_0x2f5fe9[_0x266cc1(0x263)]('file://'))_0x30a5a6=await fs[_0x266cc1(0x1f2)](_0x2f5fe9);else{const _0x27baac=await downloadUrlToTemp(_0x2f5fe9,_0x266cc1(0x201));_0x30a5a6=await fs[_0x266cc1(0x1f2)](_0x266cc1(0x203)+_0x27baac[_0x266cc1(0x1f3)]);}return await executeAsModal(async _0x53c9d2=>{const _0x257c25=_0x266cc1,_0x3b40d7=app[_0x257c25(0x256)],_0x11b43f=await fs[_0x257c25(0x239)](_0x30a5a6);await batchPlay([{'_obj':_0x257c25(0x252),'target':{'_path':_0x11b43f,'_kind':_0x257c25(0x240)},'linked':!![]}],{});const _0x205124=_0x3b40d7[_0x257c25(0x24f)][0x0],_0x5e338f=_0x205124['boundsNoEffects'],_0x32ad67=_0x5e338f[_0x257c25(0x20b)]-_0x5e338f[_0x257c25(0x21f)],_0x4eff0e=_0x5e338f[_0x257c25(0x218)]-_0x5e338f[_0x257c25(0x24a)],_0x457e63=(_0x5e338f[_0x257c25(0x21f)]+_0x5e338f[_0x257c25(0x20b)])/0x2,_0x1964d0=(_0x5e338f[_0x257c25(0x24a)]+_0x5e338f['bottom'])/0x2;let _0x4c84cc={'left':0x0,'top':0x0,'right':_0x3b40d7[_0x257c25(0x24d)],'bottom':_0x3b40d7[_0x257c25(0x215)]};try{const _0x572c75=_0x3b40d7[_0x257c25(0x1fc)]['bounds'];if(_0x572c75)_0x4c84cc=_0x572c75;}catch(_0xbc8060){}const _0x5bc333=_0x4c84cc['right']-_0x4c84cc['left'],_0x2f38c3=_0x4c84cc[_0x257c25(0x218)]-_0x4c84cc[_0x257c25(0x24a)],_0xe9911f=(_0x4c84cc[_0x257c25(0x21f)]+_0x4c84cc[_0x257c25(0x20b)])/0x2,_0x2a0472=(_0x4c84cc[_0x257c25(0x24a)]+_0x4c84cc[_0x257c25(0x218)])/0x2;let _0x2fbd76=0x64,_0x27684a=0x64,_0x2f8102=_0xe9911f-_0x457e63,_0x3c8eb2=_0x2a0472-_0x1964d0;!_0x258870?(_0x2fbd76=_0x5bc333/_0x32ad67*0x64,_0x27684a=_0x2f38c3/_0x4eff0e*0x64):(_0x2f8102=_0x3b40d7[_0x257c25(0x24d)]/0x2-_0x457e63,_0x3c8eb2=_0x3b40d7[_0x257c25(0x215)]/0x2-_0x1964d0),await batchPlay([{'_obj':_0x257c25(0x24b),'_target':[{'_ref':_0x257c25(0x207),'_enum':'ordinal','_value':'targetEnum'}],'freeTransformCenterState':{'_enum':'quadCenterState','_value':_0x257c25(0x255)},'offset':{'_obj':_0x257c25(0x234),'horizontal':{'_unit':_0x257c25(0x21c),'_value':_0x2f8102},'vertical':{'_unit':_0x257c25(0x21c),'_value':_0x3c8eb2}},'width':{'_unit':'percentUnit','_value':_0x2fbd76},'height':{'_unit':'percentUnit','_value':_0x27684a},'interpolation':{'_enum':'interpolationType','_value':_0x257c25(0x24e)}}],{}),await batchPlay([{'_obj':_0x257c25(0x1f0),'_target':[{'_ref':_0x257c25(0x207),'_enum':_0x257c25(0x22d),'_value':_0x257c25(0x237)}]}],{});},{'commandName':_0x266cc1(0x1ff)}),{'success':!![]};}catch(_0x11e192){return{'success':![],'error':_0x11e192[_0x266cc1(0x213)]};}}function getDocumentInfo(){const _0x3e2946=a0_0x2a24b7;if(!app||!app[_0x3e2946(0x256)])return{'hasDocument':![]};const _0x1f45a5=app['activeDocument'];return{'hasDocument':!![],'width':_0x1f45a5[_0x3e2946(0x24d)]['value']||_0x1f45a5[_0x3e2946(0x24d)],'height':_0x1f45a5[_0x3e2946(0x215)]['value']||_0x1f45a5[_0x3e2946(0x215)]};}function startSelectionListener(_0x2b2d17){const _0x4be59f=a0_0x2a24b7;if(!action||!action['addNotificationListener'])return;let _0x379488=null;const _0x505466=()=>{if(isProcessing)return;if(_0x2b2d17)_0x2b2d17();};action[_0x4be59f(0x265)]([_0x4be59f(0x200)],(_0x448ed9,_0x37faa6)=>{const _0x2f1ce8=_0x4be59f,_0x1350cd=[_0x2f1ce8(0x262),_0x2f1ce8(0x242),_0x2f1ce8(0x220),_0x2f1ce8(0x238),_0x2f1ce8(0x245),_0x2f1ce8(0x24b),_0x2f1ce8(0x236),_0x2f1ce8(0x1fb),_0x2f1ce8(0x1f4)];if(_0x1350cd[_0x2f1ce8(0x1f7)](_0x448ed9)){const _0x53b2b2=_0x37faa6['_target'];let _0x33dc76=![];_0x53b2b2&&Array[_0x2f1ce8(0x25c)](_0x53b2b2)&&(_0x33dc76=_0x53b2b2[_0x2f1ce8(0x21a)](_0x3e095f=>_0x3e095f[_0x2f1ce8(0x1fe)]===_0x2f1ce8(0x235)&&(_0x3e095f[_0x2f1ce8(0x20c)]===_0x2f1ce8(0x1fc)||_0x3e095f[_0x2f1ce8(0x257)]===_0x2f1ce8(0x1fc))||_0x3e095f[_0x2f1ce8(0x1fe)]===_0x2f1ce8(0x1fc)||_0x3e095f['_ref']===_0x2f1ce8(0x1ee)&&_0x3e095f['_property']===_0x2f1ce8(0x1fc)));if(!_0x33dc76){if(['show',_0x2f1ce8(0x1fb),_0x2f1ce8(0x220)][_0x2f1ce8(0x1f7)](_0x448ed9))_0x33dc76=!![];else[_0x2f1ce8(0x245),'transform',_0x2f1ce8(0x1f4)][_0x2f1ce8(0x1f7)](_0x448ed9)&&(_0x33dc76=!![]);}if(_0x33dc76){if(_0x379488)clearTimeout(_0x379488);_0x379488=setTimeout(_0x505466,0x258);}}});}async function listHistoryFiles(){const _0x363c49=a0_0x2a24b7;try{const _0x26cf4b=await fs[_0x363c49(0x214)](),_0x18369b=await _0x26cf4b['getEntries'](),_0x49ce8f=_0x18369b['filter'](_0x91ff1a=>_0x91ff1a[_0x363c49(0x254)]&&(_0x91ff1a[_0x363c49(0x208)]['startsWith']('uxp_download_')||_0x91ff1a[_0x363c49(0x208)][_0x363c49(0x263)](_0x363c49(0x22b)))&&_0x91ff1a[_0x363c49(0x208)][_0x363c49(0x206)](_0x363c49(0x219)))[_0x363c49(0x248)]((_0x40fddd,_0x2cb775)=>_0x2cb775['name']['localeCompare'](_0x40fddd[_0x363c49(0x208)]))[_0x363c49(0x1ef)](_0x508f3c=>_0x363c49(0x203)+_0x508f3c['nativePath']);return{'success':!![],'files':_0x49ce8f};}catch(_0x45c674){return{'success':![],'error':_0x45c674[_0x363c49(0x213)]};}}async function deleteFile(_0x22ae7b){const _0x3b8c2a=a0_0x2a24b7;try{if(_0x22ae7b['startsWith']('file://'))_0x22ae7b=_0x22ae7b[_0x3b8c2a(0x216)](_0x3b8c2a(0x203),'');const _0x4df2ed=_0x22ae7b['split']('/')[_0x3b8c2a(0x21b)]();if(!_0x4df2ed)return{'success':![],'error':'Invalid\x20filename'};const _0x55a1fd=await fs[_0x3b8c2a(0x214)](),_0x324ecf=await _0x55a1fd[_0x3b8c2a(0x221)](_0x4df2ed);if(_0x324ecf)return await _0x324ecf[_0x3b8c2a(0x1f4)](),{'success':!![]};return{'success':![],'error':_0x3b8c2a(0x20f)};}catch(_0x169aa3){return{'success':![],'error':_0x169aa3[_0x3b8c2a(0x213)]};}}async function clearHistoryFiles(){const _0x3269bf=a0_0x2a24b7;try{const _0x23b992=await fs[_0x3269bf(0x214)](),_0x30104c=await _0x23b992[_0x3269bf(0x1f9)](),_0x1d7f75=_0x30104c[_0x3269bf(0x23f)](_0x2d1557=>_0x2d1557[_0x3269bf(0x254)]&&(_0x2d1557[_0x3269bf(0x208)]['startsWith']('uxp_download_')||_0x2d1557[_0x3269bf(0x208)][_0x3269bf(0x263)](_0x3269bf(0x22b)))&&_0x2d1557['name'][_0x3269bf(0x206)](_0x3269bf(0x219)));for(const _0x45442b of _0x1d7f75){await _0x45442b['delete']();}return{'success':!![],'count':_0x1d7f75['length']};}catch(_0x41108f){return{'success':![],'error':_0x41108f[_0x3269bf(0x213)]};}}async function readBinaryFile(_0x5b92a9){const _0x58dc57=a0_0x2a24b7;try{if(!_0x5b92a9)return{'success':![],'error':_0x58dc57(0x1f1)};let _0x42aa17=_0x5b92a9;if(_0x42aa17[_0x58dc57(0x263)](_0x58dc57(0x203)))_0x42aa17=_0x42aa17['replace'](_0x58dc57(0x203),'');const _0xd366a8=_0x42aa17[_0x58dc57(0x23a)]('/')[_0x58dc57(0x21b)](),_0x2bf640=await fs[_0x58dc57(0x214)](),_0x2258cd=await _0x2bf640[_0x58dc57(0x221)](_0xd366a8);if(_0x2258cd&&_0x2258cd[_0x58dc57(0x254)]){const _0x447dd8=await _0x2258cd[_0x58dc57(0x205)]({'format':formats[_0x58dc57(0x230)]});return{'success':!![],'buffer':Array['from'](new Uint8Array(_0x447dd8))};}return{'success':![],'error':_0x58dc57(0x1f6)};}catch(_0x578dc2){return{'success':![],'error':_0x578dc2['message']};}}window[a0_0x2a24b7(0x243)]={'getActiveDocumentImage':getActiveDocumentImage,'createDocFromUrl':createDocFromUrl,'placeImageFromUrl':placeImageFromUrl,'downloadUrlToTemp':downloadUrlToTemp,'getDocumentInfo':getDocumentInfo,'startSelectionListener':startSelectionListener,'listHistoryFiles':listHistoryFiles,'deleteFile':deleteFile,'clearHistoryFiles':clearHistoryFiles,'pickLocalFile':pickLocalFile,'readBinaryFile':readBinaryFile,'showAlert':_0x4b944f=>app['showAlert'](_0x4b944f)};
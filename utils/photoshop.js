const a0_0x4a6ad0=a0_0x1695;(function(_0x79987a,_0x4daff2){const _0x1b91e0=a0_0x1695,_0x209968=_0x79987a();while(!![]){try{const _0x4d2031=parseInt(_0x1b91e0(0x186))/0x1*(-parseInt(_0x1b91e0(0x1b7))/0x2)+parseInt(_0x1b91e0(0x1cb))/0x3+parseInt(_0x1b91e0(0x178))/0x4*(parseInt(_0x1b91e0(0x198))/0x5)+-parseInt(_0x1b91e0(0x1f7))/0x6+-parseInt(_0x1b91e0(0x1e2))/0x7+parseInt(_0x1b91e0(0x1aa))/0x8*(-parseInt(_0x1b91e0(0x1ce))/0x9)+-parseInt(_0x1b91e0(0x194))/0xa*(-parseInt(_0x1b91e0(0x17a))/0xb);if(_0x4d2031===_0x4daff2)break;else _0x209968['push'](_0x209968['shift']());}catch(_0x50f82b){_0x209968['push'](_0x209968['shift']());}}}(a0_0xf298,0x6c0c9));function a0_0x1695(_0x3e7ddd,_0xc39e96){_0x3e7ddd=_0x3e7ddd-0x177;const _0xf298a3=a0_0xf298();let _0x1695b9=_0xf298a3[_0x3e7ddd];if(a0_0x1695['DNiiru']===undefined){var _0x548c2c=function(_0x3e4d5f){const _0x335160='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x152e87='',_0x296662='';for(let _0x56a83b=0x0,_0x5baa79,_0x5b739e,_0x453a55=0x0;_0x5b739e=_0x3e4d5f['charAt'](_0x453a55++);~_0x5b739e&&(_0x5baa79=_0x56a83b%0x4?_0x5baa79*0x40+_0x5b739e:_0x5b739e,_0x56a83b++%0x4)?_0x152e87+=String['fromCharCode'](0xff&_0x5baa79>>(-0x2*_0x56a83b&0x6)):0x0){_0x5b739e=_0x335160['indexOf'](_0x5b739e);}for(let _0x3a4b95=0x0,_0x3a47ad=_0x152e87['length'];_0x3a4b95<_0x3a47ad;_0x3a4b95++){_0x296662+='%'+('00'+_0x152e87['charCodeAt'](_0x3a4b95)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x296662);};a0_0x1695['FSAkkI']=_0x548c2c,a0_0x1695['EShlpM']={},a0_0x1695['DNiiru']=!![];}const _0x3ee401=_0xf298a3[0x0],_0x549014=_0x3e7ddd+_0x3ee401,_0x4f2d22=a0_0x1695['EShlpM'][_0x549014];return!_0x4f2d22?(_0x1695b9=a0_0x1695['FSAkkI'](_0x1695b9),a0_0x1695['EShlpM'][_0x549014]=_0x1695b9):_0x1695b9=_0x4f2d22,_0x1695b9;}const {app,action,core,imaging}=require(a0_0x4a6ad0(0x1b0)),{batchPlay}=action,fs=require(a0_0x4a6ad0(0x1d3))['storage']['localFileSystem'],formats=require(a0_0x4a6ad0(0x1d3))[a0_0x4a6ad0(0x1bd)][a0_0x4a6ad0(0x1d1)],executeAsModal=core[a0_0x4a6ad0(0x1ef)],PngEncoder=require(a0_0x4a6ad0(0x179));let isProcessing=![];const val=_0x152e87=>{const _0x4faf41=a0_0x4a6ad0;if(_0x152e87===null||_0x152e87===undefined)return 0x0;if(typeof _0x152e87===_0x4faf41(0x1cf)){if(_0x152e87[_0x4faf41(0x18a)]!==undefined)return _0x152e87[_0x4faf41(0x18a)];if(_0x152e87['_value']!==undefined)return _0x152e87['_value'];if(Object['keys'](_0x152e87)[_0x4faf41(0x1b4)]===0x1){const _0x296662=Object[_0x4faf41(0x17e)](_0x152e87)[0x0];return val(_0x152e87[_0x296662]);}}return _0x152e87;};async function getSelectionInfo(){const _0x14cc13=a0_0x4a6ad0;try{const _0x56a83b=await action['batchPlay']([{'_obj':'get','_target':[{'_ref':'property','_property':_0x14cc13(0x17d)},{'_ref':_0x14cc13(0x190),'_enum':_0x14cc13(0x1b5),'_value':_0x14cc13(0x1db)}],'_options':{'dialogOptions':_0x14cc13(0x1f8)}}],{'synchronousExecution':!![]});if(_0x56a83b&&_0x56a83b[0x0]&&_0x56a83b[0x0][_0x14cc13(0x17d)])return _0x56a83b[0x0][_0x14cc13(0x17d)];return null;}catch(_0x5baa79){return null;}}function calculateTargetSize(_0x5b739e,_0x453a55){const _0x17ea7c=a0_0x4a6ad0;let _0x3a4b95=_0x5b739e[_0x17ea7c(0x1c3)],_0x3a47ad=_0x5b739e[_0x17ea7c(0x1de)],_0x41f959=_0x3a4b95,_0x415206=_0x3a47ad;if(_0x453a55&&(_0x3a4b95>_0x453a55||_0x3a47ad>_0x453a55)){const _0x57ab85=Math['min'](_0x453a55/_0x3a4b95,_0x453a55/_0x3a47ad);_0x41f959=Math[_0x17ea7c(0x1c8)](_0x3a4b95*_0x57ab85),_0x415206=Math[_0x17ea7c(0x1c8)](_0x3a47ad*_0x57ab85);}return{'width':_0x41f959,'height':_0x415206};}async function encodeToPng(_0x24f96c){const _0x3243e4=a0_0x4a6ad0;if(!_0x24f96c||!_0x24f96c[_0x3243e4(0x1b6)])throw new Error('Failed\x20to\x20retrieve\x20image\x20data.');try{const _0x2765ea=await imaging[_0x3243e4(0x1a5)]({'imageData':_0x24f96c[_0x3243e4(0x1b6)],'format':_0x3243e4(0x193),'base64':![]});return _0x2765ea;}finally{_0x24f96c['dispose']&&_0x24f96c['dispose']();}}async function saveBufferToTemp(_0x231378,_0x2a2ce8,_0x5ee580,_0x204055){const _0x5e0b38=a0_0x4a6ad0,_0x198f14=_0x204055?String(_0x204055)[_0x5e0b38(0x1a2)](/[^a-zA-Z0-9_-]/g,'_'):'';let _0x29fb59=_0x2a2ce8?String(_0x2a2ce8)[_0x5e0b38(0x1a2)](/[^a-zA-Z0-9_-]/g,'_')[_0x5e0b38(0x1a2)](/(_image|_mask_preview|_mask|_rgba)$/g,''):'';if(!_0x29fb59)_0x29fb59=_0x5ee580||'file';let _0x134b8e=_0x198f14?_0x198f14+'_'+_0x29fb59+'_'+_0x5ee580+'.png':_0x29fb59+'_'+_0x5ee580+'.png';const _0x5055e4=await fs['getTemporaryFolder'](),_0x29df82=await _0x5055e4[_0x5e0b38(0x1d6)](_0x134b8e,{'overwrite':!![]});return await _0x29df82[_0x5e0b38(0x19a)](_0x231378,{'format':formats['binary']}),_0x29df82[_0x5e0b38(0x1f9)];}async function getActiveDocumentImage(_0x25bc12={}){const _0x49fd1a=a0_0x4a6ad0,{baseMode:baseMode=_0x49fd1a(0x1bc),nodeId:_0x1ae886,appId:_0x1a1061}=_0x25bc12;if(!app[_0x49fd1a(0x18b)])return{'success':![],'error':_0x49fd1a(0x1b8)};isProcessing=!![];try{const _0x477796=app[_0x49fd1a(0x18b)];let _0x3011c2=null,_0x2b74ce=null,_0x5aaaa8=null;const _0x3a7195=parseInt(val(_0x477796[_0x49fd1a(0x1c3)]))||0x0,_0x5f19c3=parseInt(val(_0x477796[_0x49fd1a(0x1de)]))||0x0,_0x570005=_0x3a7195,_0x13b8ec=_0x5f19c3;let _0x89847=null,_0x5933db=null;return await executeAsModal(async _0x3d33d9=>{const _0x218d7a=_0x49fd1a;let _0x1a4d5e=null;if(baseMode===_0x218d7a(0x1bc)){const _0x4ad1b8=await imaging['getPixels']({'documentID':_0x477796['id'],'targetSize':{'width':_0x570005,'height':_0x13b8ec},'applyAlpha':!![]}),_0x570197=_0x4ad1b8[_0x218d7a(0x1b6)][_0x218d7a(0x1c3)],_0x3fd9a3=_0x4ad1b8[_0x218d7a(0x1b6)][_0x218d7a(0x1de)],_0x6c70c0=_0x4ad1b8[_0x218d7a(0x1b6)]['components']||0x4;let _0x520192=await _0x4ad1b8['imageData']['getData']();if(_0x520192&&_0x520192[_0x218d7a(0x1a1)])_0x520192=_0x520192[_0x218d7a(0x1a1)];_0x89847=new Uint8Array(_0x570005*_0x13b8ec*0x4);for(let _0x1f9d29=0x0;_0x1f9d29<_0x570005*_0x13b8ec;_0x1f9d29++){const _0x2de0e3=_0x1f9d29*_0x6c70c0,_0x4f9994=_0x1f9d29*0x4;_0x89847[_0x4f9994]=_0x520192[_0x2de0e3],_0x89847[_0x4f9994+0x1]=_0x520192[_0x2de0e3+0x1],_0x89847[_0x4f9994+0x2]=_0x520192[_0x2de0e3+0x2],_0x89847[_0x4f9994+0x3]=_0x6c70c0===0x4?_0x520192[_0x2de0e3+0x3]:0xff;}const _0x54f45c=new PngEncoder(_0x570005,_0x13b8ec,0x4);_0x1a4d5e=_0x54f45c['encode'](_0x89847);}else{const _0x266018=_0x477796[_0x218d7a(0x177)][0x0];if(!_0x266018)throw new Error(_0x218d7a(0x1c6));const _0x3384e9=_0x266018[_0x218d7a(0x1ea)],_0x704b55=parseInt(val(_0x3384e9[_0x218d7a(0x1e4)]))||0x0,_0x66e0a7=parseInt(val(_0x3384e9[_0x218d7a(0x17c)]))||0x0,_0x43bc20=await imaging[_0x218d7a(0x1dd)]({'documentID':_0x477796['id'],'layerID':_0x266018['id'],'applyAlpha':!![]}),_0x256baf=_0x43bc20['imageData'][_0x218d7a(0x1c3)],_0x35e727=_0x43bc20['imageData'][_0x218d7a(0x1de)],_0x3ebfe8=_0x43bc20[_0x218d7a(0x1b6)][_0x218d7a(0x1ae)]||0x4;let _0x5267a1=await _0x43bc20['imageData'][_0x218d7a(0x1f0)]();if(_0x5267a1&&_0x5267a1[_0x218d7a(0x1a1)])_0x5267a1=_0x5267a1[_0x218d7a(0x1a1)];_0x89847=new Uint8Array(_0x570005*_0x13b8ec*0x4);if(_0x5267a1&&_0x5267a1[_0x218d7a(0x1b4)]>0x0)for(let _0x3c1df9=0x0;_0x3c1df9<_0x35e727;_0x3c1df9++){const _0x368bf7=_0x704b55+_0x3c1df9;if(_0x368bf7<0x0||_0x368bf7>=_0x13b8ec)continue;for(let _0x38be4b=0x0;_0x38be4b<_0x256baf;_0x38be4b++){const _0x3df430=_0x66e0a7+_0x38be4b;if(_0x3df430<0x0||_0x3df430>=_0x570005)continue;const _0x4d4ece=(_0x3c1df9*_0x256baf+_0x38be4b)*_0x3ebfe8,_0x59f933=(_0x368bf7*_0x570005+_0x3df430)*0x4;_0x89847[_0x59f933]=_0x5267a1[_0x4d4ece],_0x89847[_0x59f933+0x1]=_0x5267a1[_0x4d4ece+0x1],_0x89847[_0x59f933+0x2]=_0x5267a1[_0x4d4ece+0x2];if(_0x3ebfe8===0x4)_0x89847[_0x59f933+0x3]=_0x5267a1[_0x4d4ece+0x3];else{const _0x368842=_0x5267a1[_0x4d4ece]===0xff&&_0x5267a1[_0x4d4ece+0x1]===0xff&&_0x5267a1[_0x4d4ece+0x2]===0xff;_0x89847[_0x59f933+0x3]=_0x368842?0x0:0xff;}}}if(_0x43bc20[_0x218d7a(0x1f5)])_0x43bc20[_0x218d7a(0x1f5)]();const _0x88809=new PngEncoder(_0x570005,_0x13b8ec,0x4);_0x1a4d5e=_0x88809[_0x218d7a(0x1ee)](_0x89847);}_0x3011c2=await saveBufferToTemp(_0x1a4d5e,_0x1ae886,_0x218d7a(0x18f),_0x1a1061);let _0x3d740f=null;try{_0x3d740f=await getSelectionInfo();}catch(_0xda3c19){}if(_0x3d740f){let _0x13edf3=null;try{const _0x326b85=Math[_0x218d7a(0x1c8)](val(_0x3d740f[_0x218d7a(0x17c)]))||0x0,_0x4c7655=Math[_0x218d7a(0x1c8)](val(_0x3d740f[_0x218d7a(0x1e4)]))||0x0,_0x25c726=await action[_0x218d7a(0x19b)]([{'_obj':_0x218d7a(0x1e5),'_target':[{'_ref':_0x218d7a(0x191)}]},{'_obj':'fill','mode':{'_enum':_0x218d7a(0x17b),'_value':_0x218d7a(0x1a8)},'opacity':{'_unit':_0x218d7a(0x199),'_value':0x64},'using':{'_enum':_0x218d7a(0x1c1),'_value':'black'}},{'_obj':_0x218d7a(0x185),'mode':{'_enum':'interpolation','_value':_0x218d7a(0x1a8)},'opacity':{'_unit':_0x218d7a(0x199),'_value':0x64},'using':{'_enum':'fillContents','_value':_0x218d7a(0x1f6)}}],{});_0x13edf3=_0x25c726[0x0]?.[_0x218d7a(0x1e3)];const _0x49009b=await imaging[_0x218d7a(0x1dd)]({'documentID':_0x477796['id'],'layerID':_0x13edf3});let _0xe75dd5=await _0x49009b[_0x218d7a(0x1b6)][_0x218d7a(0x1f0)]();if(_0xe75dd5&&_0xe75dd5[_0x218d7a(0x1a1)])_0xe75dd5=_0xe75dd5[_0x218d7a(0x1a1)];const _0x145466=_0x49009b[_0x218d7a(0x1b6)][_0x218d7a(0x1c3)],_0x4aa223=_0x49009b[_0x218d7a(0x1b6)]['height'],_0x3bd13b=_0x49009b[_0x218d7a(0x1b6)][_0x218d7a(0x1ae)]||0x1;_0x5933db=new Uint8Array(_0x570005*_0x13b8ec*0x4);const _0xe7fc44=Math[_0x218d7a(0x192)](_0x145466,_0x570005),_0x355ee4=Math['min'](_0x4aa223,_0x13b8ec);for(let _0x2b38fa=0x0;_0x2b38fa<_0x355ee4;_0x2b38fa++){const _0x34275d=_0x4c7655+_0x2b38fa;if(_0x34275d<0x0||_0x34275d>=_0x13b8ec)continue;for(let _0x23fa66=0x0;_0x23fa66<_0xe7fc44;_0x23fa66++){const _0x3fef3e=_0x326b85+_0x23fa66;if(_0x3fef3e<0x0||_0x3fef3e>=_0x570005)continue;const _0x2ea7c4=(_0x2b38fa*_0x145466+_0x23fa66)*_0x3bd13b,_0x11cfc1=(_0x34275d*_0x570005+_0x3fef3e)*0x4;let _0x363ebb=_0xe75dd5[_0x2ea7c4];if(_0x3bd13b>=0x2&&_0xe75dd5[_0x2ea7c4+_0x3bd13b-0x1]<0x80)_0x363ebb=0x0;_0x5933db[_0x11cfc1]=0xff,_0x5933db[_0x11cfc1+0x1]=0x0,_0x5933db[_0x11cfc1+0x2]=0x0,_0x5933db[_0x11cfc1+0x3]=_0x363ebb;}}if(_0x49009b[_0x218d7a(0x1f5)])_0x49009b['dispose']();const _0x55b832=new PngEncoder(_0x570005,_0x13b8ec,0x4),_0x26f633=_0x55b832[_0x218d7a(0x1ee)](_0x5933db);_0x2b74ce=await saveBufferToTemp(_0x26f633,_0x1ae886,_0x218d7a(0x183),_0x1a1061);}catch(_0x35651f){console[_0x218d7a(0x1a9)](_0x218d7a(0x1ec),_0x35651f);}finally{if(_0x13edf3!==null)try{await action[_0x218d7a(0x19b)]([{'_obj':_0x218d7a(0x1d9),'_target':[{'_ref':_0x218d7a(0x191),'_id':_0x13edf3}]}],{});}catch(_0x3445d4){}}}const _0x942df0=new Uint8Array(_0x570005*_0x13b8ec*0x4);if(_0x89847){for(let _0x269133=0x0;_0x269133<_0x942df0['length'];_0x269133+=0x4){_0x942df0[_0x269133]=_0x89847[_0x269133],_0x942df0[_0x269133+0x1]=_0x89847[_0x269133+0x1],_0x942df0[_0x269133+0x2]=_0x89847[_0x269133+0x2],_0x5933db?_0x942df0[_0x269133+0x3]=0xff-_0x5933db[_0x269133+0x3]:_0x942df0[_0x269133+0x3]=0xff;}const _0x304710=new PngEncoder(_0x570005,_0x13b8ec,0x4),_0x4474d8=_0x304710[_0x218d7a(0x1ee)](_0x942df0);_0x4474d8&&(_0x5aaaa8=await saveBufferToTemp(_0x4474d8,_0x1ae886,_0x218d7a(0x18c),_0x1a1061));}},{'commandName':_0x49fd1a(0x182)}),{'success':!![],'image':_0x3011c2,'mask':_0x2b74ce,'rgba':_0x5aaaa8,'width':_0x570005,'height':_0x13b8ec,'isLocal':!![]};}catch(_0x8509d4){return console[_0x49fd1a(0x1a9)](_0x49fd1a(0x1a6),_0x8509d4),{'success':![],'error':_0x8509d4[_0x49fd1a(0x184)]||String(_0x8509d4)};}finally{isProcessing=![];}}async function pickLocalFile(){const _0x474ce2=a0_0x4a6ad0;try{const _0x51df77=await fs[_0x474ce2(0x187)]({'types':[_0x474ce2(0x193),_0x474ce2(0x1b9),_0x474ce2(0x188),_0x474ce2(0x1bf)],'allowMultiple':![]});if(!_0x51df77)return{'success':![],'error':_0x474ce2(0x1f1)};const _0x51e2fb=await fs[_0x474ce2(0x19e)](),_0x7a5354=_0x51df77[_0x474ce2(0x1c7)],_0x5b7bab=await _0x51df77[_0x474ce2(0x1cd)](_0x51e2fb,{'newName':_0x7a5354,'overwrite':!![]});return{'success':!![],'image':_0x5b7bab[_0x474ce2(0x1f9)],'name':_0x51df77[_0x474ce2(0x1c7)],'isLocal':!![]};}catch(_0x455fac){return console[_0x474ce2(0x1a9)](_0x474ce2(0x189),_0x455fac),{'success':![],'error':_0x455fac[_0x474ce2(0x184)]};}}async function downloadUrlToTemp(_0x2ff282,_0x304949){const _0x535fe5=a0_0x4a6ad0;if(!_0x304949)_0x304949=_0x535fe5(0x1fa)+Date[_0x535fe5(0x1a7)]()+_0x535fe5(0x1df);const _0x45ade4=await fetch(_0x2ff282),_0x3c0bcd=await _0x45ade4[_0x535fe5(0x1c5)](),_0x4c4bfe=await fs[_0x535fe5(0x19e)](),_0x25f10f=await _0x4c4bfe['createFile'](_0x304949,{'overwrite':!![]});return await _0x25f10f['write'](_0x3c0bcd,{'format':formats[_0x535fe5(0x1ab)]}),{'success':!![],'nativePath':_0x25f10f[_0x535fe5(0x1f9)]};}async function createDocFromUrl(_0x468495){const _0xd46c73=a0_0x4a6ad0;try{let _0x11c36f;if(_0x468495[_0xd46c73(0x1e6)](_0xd46c73(0x1d7)))_0x11c36f=await fs[_0xd46c73(0x1c4)](_0x468495);else{const _0x9bf0bd=await downloadUrlToTemp(_0x468495,'bizyair_result_');_0x11c36f=await fs[_0xd46c73(0x1c4)](_0xd46c73(0x1d7)+_0x9bf0bd[_0xd46c73(0x1f9)]);}return await executeAsModal(async()=>{await app['open'](_0x11c36f);},{'commandName':_0xd46c73(0x1f3)}),{'success':!![]};}catch(_0x519b67){return{'success':![],'error':_0x519b67[_0xd46c73(0x184)]};}}async function placeImageFromUrl(_0x5e8ab8,_0x121b49=![]){const _0x3729de=a0_0x4a6ad0;try{let _0x21b3be;if(_0x5e8ab8[_0x3729de(0x1e6)](_0x3729de(0x1d7)))_0x21b3be=await fs[_0x3729de(0x1c4)](_0x5e8ab8);else{const _0x5e22cb=await downloadUrlToTemp(_0x5e8ab8,_0x3729de(0x1e0));_0x21b3be=await fs['getEntryWithUrl'](_0x3729de(0x1d7)+_0x5e22cb[_0x3729de(0x1f9)]);}return await executeAsModal(async _0x470e27=>{const _0x450502=_0x3729de,_0x53f8a4=app[_0x450502(0x18b)],_0x47e8a6=await fs['createSessionToken'](_0x21b3be);await batchPlay([{'_obj':_0x450502(0x1af),'target':{'_path':_0x47e8a6,'_kind':_0x450502(0x196)},'linked':!![]}],{});const _0x40c710=_0x53f8a4[_0x450502(0x177)][0x0],_0x58c354=_0x40c710['boundsNoEffects'],_0x2a6482=_0x58c354['right']-_0x58c354[_0x450502(0x17c)],_0x13b769=_0x58c354[_0x450502(0x1cc)]-_0x58c354[_0x450502(0x1e4)],_0x22fccf=(_0x58c354['left']+_0x58c354[_0x450502(0x1a4)])/0x2,_0x53bec8=(_0x58c354[_0x450502(0x1e4)]+_0x58c354[_0x450502(0x1cc)])/0x2;let _0x395cb0={'left':0x0,'top':0x0,'right':_0x53f8a4['width'],'bottom':_0x53f8a4[_0x450502(0x1de)]};try{const _0x499e35=_0x53f8a4['selection']['bounds'];if(_0x499e35)_0x395cb0=_0x499e35;}catch(_0x32efe3){}const _0x559c79=_0x395cb0[_0x450502(0x1a4)]-_0x395cb0['left'],_0x5052a0=_0x395cb0[_0x450502(0x1cc)]-_0x395cb0[_0x450502(0x1e4)],_0x1d2a08=(_0x395cb0['left']+_0x395cb0[_0x450502(0x1a4)])/0x2,_0x5618f9=(_0x395cb0[_0x450502(0x1e4)]+_0x395cb0[_0x450502(0x1cc)])/0x2;let _0x594b19=0x64,_0x12760e=0x64,_0x31ba2e=_0x1d2a08-_0x22fccf,_0x1aaa30=_0x5618f9-_0x53bec8;!_0x121b49?(_0x594b19=_0x559c79/_0x2a6482*0x64,_0x12760e=_0x5052a0/_0x13b769*0x64):(_0x31ba2e=_0x53f8a4['width']/0x2-_0x22fccf,_0x1aaa30=_0x53f8a4[_0x450502(0x1de)]/0x2-_0x53bec8),await batchPlay([{'_obj':_0x450502(0x1ad),'_target':[{'_ref':_0x450502(0x191),'_enum':_0x450502(0x1b5),'_value':_0x450502(0x1db)}],'freeTransformCenterState':{'_enum':_0x450502(0x1d8),'_value':_0x450502(0x1eb)},'offset':{'_obj':_0x450502(0x1d0),'horizontal':{'_unit':_0x450502(0x1c9),'_value':_0x31ba2e},'vertical':{'_unit':_0x450502(0x1c9),'_value':_0x1aaa30}},'width':{'_unit':_0x450502(0x199),'_value':_0x594b19},'height':{'_unit':_0x450502(0x199),'_value':_0x12760e},'interpolation':{'_enum':'interpolationType','_value':_0x450502(0x1d2)}}],{}),await batchPlay([{'_obj':_0x450502(0x1ca),'_target':[{'_ref':'layer','_enum':_0x450502(0x1b5),'_value':_0x450502(0x1db)}]}],{});},{'commandName':'Place\x20and\x20Align\x20Image'}),{'success':!![]};}catch(_0x591169){return{'success':![],'error':_0x591169['message']};}}function getDocumentInfo(){const _0x254b8a=a0_0x4a6ad0;if(!app||!app[_0x254b8a(0x18b)])return{'hasDocument':![]};const _0x5e4a46=app['activeDocument'];return{'hasDocument':!![],'width':_0x5e4a46[_0x254b8a(0x1c3)][_0x254b8a(0x18a)]||_0x5e4a46[_0x254b8a(0x1c3)],'height':_0x5e4a46['height']['value']||_0x5e4a46[_0x254b8a(0x1de)]};}function a0_0xf298(){const _0x1edb16=['x3rHCMDLDa','z2v0vgvTCg9Yyxj5rM9SzgvY','x3bYB3bLCNr5','x3jLzG','zgf0yq','CMvWBgfJzq','BwfW','CMLNAhq','zw5JB2rLsw1Hz2veyxrH','z2v0qwn0AxzLrg9JDw1LBNrjBwfNzsbfCNjVCG','BM93','BM9YBwfS','zxjYB3i','mtz3swDRrgK','yMLUyxj5','C2v0','DhjHBNnMB3jT','y29TCg9Uzw50CW','CgXHy2vfDMvUDa','CgHVDg9ZAg9W','DxHWx2rVD25SB2fKxW','CgHVDg9ZAg9Wqvbj','C29Tzq','BgvUz3rO','B3jKAw5HBa','Aw1Hz2veyxrH','mMXMDhj6rW','tM8Gywn0AxzLigrVy3vTzw50','ANbN','sw52ywXPzcbMAwXLBMfTzq','AxnbCNjHEq','y2fUDMfZ','C3rVCMfNzq','rw1WDhKGCgf0Aa','D2vICa','zMLSDgvY','zMLSBenVBNrLBNrZ','C2HVDW','D2LKDgG','z2v0rw50CNLxAxrOvxjS','yxjYyxLcDwzMzxi','tM8Gywn0AxzLigXHEwvYihnLBgvJDgvK','BMfTzq','CM91BMq','CgL4zwXZvw5PDa','CMfZDgvYAxPLtgf5zxi','mta1mdi2ng5uAfD6ua','yM90Dg9T','y29WEvrV','mtmYnZu3mNLNAhD3DG','B2jQzwn0','B2zMC2v0','zM9YBwf0CW','yMLJDwjPyW','DxHW','C2HVD0fSzxj0','Cg9W','y3jLyxrLrMLSzq','zMLSztOVlW','CxvHzenLBNrLCLn0yxrL','zgvSzxrL','z2v0rw50CMLLCW','DgfYz2v0rw51Bq','rMLSzsbUB3qGzM91BMq','z2v0ugL4zwXZ','AgvPz2H0','lNbUzW','yML6EwfPCL9SyxLLCL8','AxngAwXL','ntm0mta3n3LjwMTksa','Bgf5zxjjra','Dg9W','BwfRzq','C3rHCNrZv2L0Aa','yML6EwfPCL8','Bw92zq','ywrKtM90AwzPy2f0Aw9UtgLZDgvUzxi','yM91BMrZtM9fzMzLy3rZ','uuntqxzLCMfNzq','w0jPENLbAxjDie1HC2SGy2fWDhvYzsbMywLSzwq','CMvHza','zw5JB2rL','zxHLy3v0zufZtw9KywW','z2v0rgf0yq','vxnLCIbJyw5JzwXSzwq','z2v0rw50CNK','q3jLyxrLie5LDYbeB2n1BwvUDa','C3bSAxq','zgLZCg9Zzq','D2HPDgu','nduZnde0nM5lDwTUsW','zg9UDerPC3bSyxK','BMf0AxzLugf0Aa','zg93BMXVywrF','ywn0AxzLtgf5zxjZ','nti3mte2BKflzxP5','lI91DgLSCY9WBMDFzw5JB2rLCI5QCW','nda3EgfZDMLQ','Aw50zxjWB2XHDgLVBG','BgvMDa','C2vSzwn0Aw9U','A2v5CW','AgLKzq','ChjVCgvYDhK','rMLSzsbUB3qGzM91BMqGAw4GDgvTCcbZDg9YywDL','qML6EufPCIbjBwfNzsbby3f1AxnPDgLVBG','BwfZA19WCMv2Awv3','BwvZC2fNzq','zMLSBa','mZa5mdG3CMzHuLrU','z2v0rMLSzuzVCK9Wzw5PBMC','ANbLzW','CgLJA0XVy2fSrMLSzsbfCNjVCG','DMfSDwu','ywn0AxzLrg9JDw1LBNq','CMDIyq','CMvZzxq','C2vSzwn0','Aw1Hz2u','zg9JDw1LBNq','Bgf5zxi','BwLU','Cg5N','ntyZmteWv3bNqNz4','C29YDa','Bg9JywW','ywXS','nwrnrfvcza','CgvYy2vUDfvUAxq','D3jPDgu','yMf0y2HqBgf5','Aw5JBhvKzxm'];a0_0xf298=function(){return _0x1edb16;};return a0_0xf298();}function startSelectionListener(_0x570a69){const _0x349fdc=a0_0x4a6ad0;if(!action||!action[_0x349fdc(0x1e9)])return;let _0xb3a439=null;const _0x4529c5=()=>{if(isProcessing)return;if(_0x570a69)_0x570a69();};action[_0x349fdc(0x1e9)]([_0x349fdc(0x197)],(_0x2193eb,_0x30d0f5)=>{const _0x9b2f=_0x349fdc,_0x10b3c6=[_0x9b2f(0x1ac),_0x9b2f(0x18d),_0x9b2f(0x18e),_0x9b2f(0x1e5),_0x9b2f(0x1e8),'transform',_0x9b2f(0x1c2),_0x9b2f(0x17f),_0x9b2f(0x1d9)];if(_0x10b3c6[_0x9b2f(0x19c)](_0x2193eb)){const _0x1300cd=_0x30d0f5[_0x9b2f(0x19d)];let _0xe64ae5=![];_0x1300cd&&Array[_0x9b2f(0x1bb)](_0x1300cd)&&(_0xe64ae5=_0x1300cd[_0x9b2f(0x1b3)](_0x3be005=>_0x3be005[_0x9b2f(0x1a0)]==='channel'&&(_0x3be005['_value']==='selection'||_0x3be005[_0x9b2f(0x19f)]===_0x9b2f(0x17d))||_0x3be005[_0x9b2f(0x1a0)]==='selection'||_0x3be005['_ref']===_0x9b2f(0x180)&&_0x3be005['_property']==='selection'));if(!_0xe64ae5){if(['show',_0x9b2f(0x17f),_0x9b2f(0x18e)][_0x9b2f(0x19c)](_0x2193eb))_0xe64ae5=!![];else[_0x9b2f(0x1e8),_0x9b2f(0x1ad),_0x9b2f(0x1d9)][_0x9b2f(0x19c)](_0x2193eb)&&(_0xe64ae5=!![]);}if(_0xe64ae5){if(_0xb3a439)clearTimeout(_0xb3a439);_0xb3a439=setTimeout(_0x4529c5,0x258);}}});}async function listHistoryFiles(){const _0x57cd0c=a0_0x4a6ad0;try{const _0x3e6cab=await fs[_0x57cd0c(0x19e)](),_0x1bc3be=await _0x3e6cab[_0x57cd0c(0x1da)](),_0xdbaed4=_0x1bc3be[_0x57cd0c(0x1c0)](_0x16fe31=>_0x16fe31[_0x57cd0c(0x1e1)]&&(_0x16fe31['name'][_0x57cd0c(0x1e6)]('uxp_download_')||_0x16fe31[_0x57cd0c(0x1c7)][_0x57cd0c(0x1e6)](_0x57cd0c(0x1e7)))&&_0x16fe31['name']['endsWith']('.png'))[_0x57cd0c(0x195)]((_0x352770,_0x4a9c49)=>_0x4a9c49[_0x57cd0c(0x1c7)]['localeCompare'](_0x352770[_0x57cd0c(0x1c7)]))[_0x57cd0c(0x1a3)](_0x3f8886=>_0x57cd0c(0x1d7)+_0x3f8886[_0x57cd0c(0x1f9)]);return{'success':!![],'files':_0xdbaed4};}catch(_0x455e1a){return{'success':![],'error':_0x455e1a[_0x57cd0c(0x184)]};}}async function deleteFile(_0x311056){const _0x1034d6=a0_0x4a6ad0;try{if(_0x311056[_0x1034d6(0x1e6)](_0x1034d6(0x1d7)))_0x311056=_0x311056[_0x1034d6(0x1a2)](_0x1034d6(0x1d7),'');const _0x35c74d=_0x311056[_0x1034d6(0x1f4)]('/')[_0x1034d6(0x1d5)]();if(!_0x35c74d)return{'success':![],'error':_0x1034d6(0x1ba)};const _0x4763f1=await fs[_0x1034d6(0x19e)](),_0x4a1e25=await _0x4763f1[_0x1034d6(0x1f2)](_0x35c74d);if(_0x4a1e25)return await _0x4a1e25[_0x1034d6(0x1d9)](),{'success':!![]};return{'success':![],'error':_0x1034d6(0x1dc)};}catch(_0x36e199){return{'success':![],'error':_0x36e199[_0x1034d6(0x184)]};}}async function clearHistoryFiles(){const _0x1b8775=a0_0x4a6ad0;try{const _0x202d3d=await fs[_0x1b8775(0x19e)](),_0x5abeb1=await _0x202d3d[_0x1b8775(0x1da)](),_0x2a247c=_0x5abeb1[_0x1b8775(0x1c0)](_0x5f0b49=>_0x5f0b49[_0x1b8775(0x1e1)]&&(_0x5f0b49[_0x1b8775(0x1c7)]['startsWith'](_0x1b8775(0x1b1))||_0x5f0b49[_0x1b8775(0x1c7)][_0x1b8775(0x1e6)](_0x1b8775(0x1e7)))&&_0x5f0b49[_0x1b8775(0x1c7)]['endsWith'](_0x1b8775(0x1df)));for(const _0xbb990a of _0x2a247c){await _0xbb990a[_0x1b8775(0x1d9)]();}return{'success':!![],'count':_0x2a247c['length']};}catch(_0x4fff1c){return{'success':![],'error':_0x4fff1c[_0x1b8775(0x184)]};}}async function readBinaryFile(_0x5dffd9){const _0x259c5e=a0_0x4a6ad0;try{if(!_0x5dffd9)return{'success':![],'error':_0x259c5e(0x1be)};let _0x2044a3=_0x5dffd9;if(_0x2044a3['startsWith'](_0x259c5e(0x1d7)))_0x2044a3=_0x2044a3[_0x259c5e(0x1a2)](_0x259c5e(0x1d7),'');const _0x187ef1=_0x2044a3[_0x259c5e(0x1f4)]('/')['pop'](),_0x7bf92a=await fs[_0x259c5e(0x19e)](),_0x11dff8=await _0x7bf92a['getEntry'](_0x187ef1);if(_0x11dff8&&_0x11dff8['isFile']){const _0x594f27=await _0x11dff8[_0x259c5e(0x1ed)]({'format':formats[_0x259c5e(0x1ab)]});return{'success':!![],'buffer':Array['from'](new Uint8Array(_0x594f27))};}return{'success':![],'error':_0x259c5e(0x181)};}catch(_0x5482df){return{'success':![],'error':_0x5482df[_0x259c5e(0x184)]};}}window[a0_0x4a6ad0(0x1b2)]={'getActiveDocumentImage':getActiveDocumentImage,'createDocFromUrl':createDocFromUrl,'placeImageFromUrl':placeImageFromUrl,'downloadUrlToTemp':downloadUrlToTemp,'getDocumentInfo':getDocumentInfo,'startSelectionListener':startSelectionListener,'listHistoryFiles':listHistoryFiles,'deleteFile':deleteFile,'clearHistoryFiles':clearHistoryFiles,'pickLocalFile':pickLocalFile,'readBinaryFile':readBinaryFile,'showAlert':_0x25f0e9=>app[a0_0x4a6ad0(0x1d4)](_0x25f0e9)};
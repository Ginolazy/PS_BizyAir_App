function a0_0x1a18(_0xce0c82,_0x88a5cd){_0xce0c82=_0xce0c82-0x107;const _0x5261d7=a0_0x5261();let _0x1a18bc=_0x5261d7[_0xce0c82];if(a0_0x1a18['CPsVhJ']===undefined){var _0x38866f=function(_0x481a78){const _0x3a47e1='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x180cb8='',_0xcc5bee='';for(let _0x59f28e=0x0,_0x3392db,_0x166e87,_0x3b3d58=0x0;_0x166e87=_0x481a78['charAt'](_0x3b3d58++);~_0x166e87&&(_0x3392db=_0x59f28e%0x4?_0x3392db*0x40+_0x166e87:_0x166e87,_0x59f28e++%0x4)?_0x180cb8+=String['fromCharCode'](0xff&_0x3392db>>(-0x2*_0x59f28e&0x6)):0x0){_0x166e87=_0x3a47e1['indexOf'](_0x166e87);}for(let _0x690620=0x0,_0x22cebd=_0x180cb8['length'];_0x690620<_0x22cebd;_0x690620++){_0xcc5bee+='%'+('00'+_0x180cb8['charCodeAt'](_0x690620)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0xcc5bee);};a0_0x1a18['OUwbhP']=_0x38866f,a0_0x1a18['SGgKsi']={},a0_0x1a18['CPsVhJ']=!![];}const _0x584a6e=_0x5261d7[0x0],_0x221a90=_0xce0c82+_0x584a6e,_0x3a9b89=a0_0x1a18['SGgKsi'][_0x221a90];return!_0x3a9b89?(_0x1a18bc=a0_0x1a18['OUwbhP'](_0x1a18bc),a0_0x1a18['SGgKsi'][_0x221a90]=_0x1a18bc):_0x1a18bc=_0x3a9b89,_0x1a18bc;}const a0_0x25a710=a0_0x1a18;(function(_0x4e01d8,_0x4cc8c3){const _0xf59915=a0_0x1a18,_0x4483fb=_0x4e01d8();while(!![]){try{const _0x5af89b=-parseInt(_0xf59915(0x172))/0x1+parseInt(_0xf59915(0x152))/0x2*(-parseInt(_0xf59915(0x148))/0x3)+-parseInt(_0xf59915(0x144))/0x4+parseInt(_0xf59915(0x115))/0x5*(-parseInt(_0xf59915(0x15e))/0x6)+-parseInt(_0xf59915(0x13c))/0x7+-parseInt(_0xf59915(0x17f))/0x8+parseInt(_0xf59915(0x185))/0x9*(parseInt(_0xf59915(0x15a))/0xa);if(_0x5af89b===_0x4cc8c3)break;else _0x4483fb['push'](_0x4483fb['shift']());}catch(_0x138954){_0x4483fb['push'](_0x4483fb['shift']());}}}(a0_0x5261,0xa5061));const {app,action,core,imaging}=require('photoshop'),{batchPlay}=action,fs=require('uxp')[a0_0x25a710(0x10f)]['localFileSystem'],formats=require(a0_0x25a710(0x182))['storage'][a0_0x25a710(0x164)],executeAsModal=core[a0_0x25a710(0x125)],PngEncoder=require(a0_0x25a710(0x153));let isProcessing=![];const val=_0x180cb8=>{const _0xb82aa2=a0_0x25a710;if(_0x180cb8===null||_0x180cb8===undefined)return 0x0;if(typeof _0x180cb8===_0xb82aa2(0x162)){if(_0x180cb8[_0xb82aa2(0x139)]!==undefined)return _0x180cb8['value'];if(_0x180cb8['_value']!==undefined)return _0x180cb8[_0xb82aa2(0x17b)];if(Object[_0xb82aa2(0x112)](_0x180cb8)[_0xb82aa2(0x121)]===0x1){const _0xcc5bee=Object[_0xb82aa2(0x112)](_0x180cb8)[0x0];return val(_0x180cb8[_0xcc5bee]);}}return _0x180cb8;};async function getSelectionInfo(){const _0x2119ea=a0_0x25a710;try{const _0x59f28e=await action[_0x2119ea(0x145)]([{'_obj':_0x2119ea(0x135),'_target':[{'_ref':_0x2119ea(0x140),'_property':_0x2119ea(0x174)},{'_ref':_0x2119ea(0x12b),'_enum':_0x2119ea(0x12c),'_value':_0x2119ea(0x17e)}],'_options':{'dialogOptions':_0x2119ea(0x14c)}}],{'synchronousExecution':!![]});if(_0x59f28e&&_0x59f28e[0x0]&&_0x59f28e[0x0]['selection'])return _0x59f28e[0x0][_0x2119ea(0x174)];return null;}catch(_0x3392db){return null;}}function calculateTargetSize(_0x166e87,_0x3b3d58){const _0x535453=a0_0x25a710;let _0x690620=_0x166e87[_0x535453(0x124)],_0x22cebd=_0x166e87[_0x535453(0x17d)],_0x64133=_0x690620,_0x595edb=_0x22cebd;if(_0x3b3d58&&(_0x690620>_0x3b3d58||_0x22cebd>_0x3b3d58)){const _0x10bc7d=Math[_0x535453(0x157)](_0x3b3d58/_0x690620,_0x3b3d58/_0x22cebd);_0x64133=Math['round'](_0x690620*_0x10bc7d),_0x595edb=Math[_0x535453(0x146)](_0x22cebd*_0x10bc7d);}return{'width':_0x64133,'height':_0x595edb};}async function encodeToPng(_0x4a813c){const _0x22ead9=a0_0x25a710;if(!_0x4a813c||!_0x4a813c[_0x22ead9(0x10d)])throw new Error(_0x22ead9(0x13f));try{const _0x2b3967=await imaging[_0x22ead9(0x109)]({'imageData':_0x4a813c[_0x22ead9(0x10d)],'format':'png','base64':![]});return _0x2b3967;}finally{_0x4a813c['dispose']&&_0x4a813c[_0x22ead9(0x138)]();}}async function saveBufferToTemp(_0x54f0fb,_0x4eda4d,_0x259e83,_0x24c2e6){const _0x525e86=a0_0x25a710,_0x1b5709=_0x24c2e6?String(_0x24c2e6)[_0x525e86(0x168)](/[^a-zA-Z0-9_-]/g,'_'):'';let _0x534ecb=_0x4eda4d?String(_0x4eda4d)['replace'](/[^a-zA-Z0-9_-]/g,'_')['replace'](/(_image|_mask_preview|_mask|_rgba)$/g,''):'';if(!_0x534ecb)_0x534ecb=_0x259e83||_0x525e86(0x15d);let _0x3abbb8=_0x1b5709?_0x1b5709+'_'+_0x534ecb+'_'+_0x259e83+_0x525e86(0x14b):_0x534ecb+'_'+_0x259e83+_0x525e86(0x14b);const _0x5776ee=await fs[_0x525e86(0x13d)](),_0xafcf17=await _0x5776ee[_0x525e86(0x156)](_0x3abbb8,{'overwrite':!![]});return await _0xafcf17[_0x525e86(0x16b)](_0x54f0fb,{'format':formats['binary']}),_0xafcf17[_0x525e86(0x15c)];}async function getActiveDocumentImage(_0x547dab={}){const _0x3e65b1=a0_0x25a710,{baseMode:baseMode=_0x3e65b1(0x149),nodeId:_0x35ec32,appId:_0x1dbc4d}=_0x547dab;if(!app['activeDocument'])return{'success':![],'error':_0x3e65b1(0x14a)};isProcessing=!![];try{const _0xca473d=app['activeDocument'];let _0x4f9ae1=null,_0x144057=null,_0x2e45f1=null;const _0x3b73d3=parseInt(val(_0xca473d['width']))||0x0,_0xe47832=parseInt(val(_0xca473d['height']))||0x0,_0x343baa=_0x3b73d3,_0x3c9a10=_0xe47832;let _0x2c7c9b=null,_0x5daec2=null;return await executeAsModal(async _0x3096fe=>{const _0x4fb970=_0x3e65b1;let _0x2657e3=null;if(baseMode===_0x4fb970(0x149)){const _0x335c22=await imaging['getPixels']({'documentID':_0xca473d['id'],'targetSize':{'width':_0x343baa,'height':_0x3c9a10},'applyAlpha':!![]}),_0x23c31c=_0x335c22[_0x4fb970(0x10d)][_0x4fb970(0x124)],_0xa9b44a=_0x335c22[_0x4fb970(0x10d)]['height'],_0x5e3814=_0x335c22['imageData'][_0x4fb970(0x118)]||0x4;let _0xbf905=await _0x335c22[_0x4fb970(0x10d)][_0x4fb970(0x150)]();if(_0xbf905&&_0xbf905[_0x4fb970(0x11f)])_0xbf905=_0xbf905[_0x4fb970(0x11f)];_0x2c7c9b=new Uint8Array(_0x343baa*_0x3c9a10*0x4);for(let _0x23f4a7=0x0;_0x23f4a7<_0x343baa*_0x3c9a10;_0x23f4a7++){const _0x4804c7=_0x23f4a7*_0x5e3814,_0x2b90df=_0x23f4a7*0x4;_0x2c7c9b[_0x2b90df]=_0xbf905[_0x4804c7],_0x2c7c9b[_0x2b90df+0x1]=_0xbf905[_0x4804c7+0x1],_0x2c7c9b[_0x2b90df+0x2]=_0xbf905[_0x4804c7+0x2],_0x2c7c9b[_0x2b90df+0x3]=_0x5e3814===0x4?_0xbf905[_0x4804c7+0x3]:0xff;}const _0xad294c=new PngEncoder(_0x343baa,_0x3c9a10,0x4);_0x2657e3=_0xad294c[_0x4fb970(0x171)](_0x2c7c9b);}else{const _0x542a87=_0xca473d['activeLayers'][0x0];if(!_0x542a87)throw new Error(_0x4fb970(0x178));const _0x492c5a=_0x542a87[_0x4fb970(0x17a)],_0x495345=parseInt(val(_0x492c5a[_0x4fb970(0x14e)]))||0x0,_0x8b2ec9=parseInt(val(_0x492c5a[_0x4fb970(0x16c)]))||0x0,_0x57b516=await imaging[_0x4fb970(0x132)]({'documentID':_0xca473d['id'],'layerID':_0x542a87['id'],'applyAlpha':!![]}),_0x1f1870=_0x57b516[_0x4fb970(0x10d)][_0x4fb970(0x124)],_0x162651=_0x57b516[_0x4fb970(0x10d)][_0x4fb970(0x17d)],_0x2ce915=_0x57b516['imageData'][_0x4fb970(0x118)]||0x4;let _0x38be88=await _0x57b516[_0x4fb970(0x10d)][_0x4fb970(0x150)]();if(_0x38be88&&_0x38be88[_0x4fb970(0x11f)])_0x38be88=_0x38be88['data'];_0x2c7c9b=new Uint8Array(_0x343baa*_0x3c9a10*0x4);if(_0x38be88&&_0x38be88['length']>0x0)for(let _0x61a39c=0x0;_0x61a39c<_0x162651;_0x61a39c++){const _0x39f8f8=_0x495345+_0x61a39c;if(_0x39f8f8<0x0||_0x39f8f8>=_0x3c9a10)continue;for(let _0x30f0f2=0x0;_0x30f0f2<_0x1f1870;_0x30f0f2++){const _0x223744=_0x8b2ec9+_0x30f0f2;if(_0x223744<0x0||_0x223744>=_0x343baa)continue;const _0x18538a=(_0x61a39c*_0x1f1870+_0x30f0f2)*_0x2ce915,_0x4abaf1=(_0x39f8f8*_0x343baa+_0x223744)*0x4;_0x2c7c9b[_0x4abaf1]=_0x38be88[_0x18538a],_0x2c7c9b[_0x4abaf1+0x1]=_0x38be88[_0x18538a+0x1],_0x2c7c9b[_0x4abaf1+0x2]=_0x38be88[_0x18538a+0x2];if(_0x2ce915===0x4)_0x2c7c9b[_0x4abaf1+0x3]=_0x38be88[_0x18538a+0x3];else{const _0x53f359=_0x38be88[_0x18538a]===0xff&&_0x38be88[_0x18538a+0x1]===0xff&&_0x38be88[_0x18538a+0x2]===0xff;_0x2c7c9b[_0x4abaf1+0x3]=_0x53f359?0x0:0xff;}}}if(_0x57b516[_0x4fb970(0x138)])_0x57b516[_0x4fb970(0x138)]();const _0x32c179=new PngEncoder(_0x343baa,_0x3c9a10,0x4);_0x2657e3=_0x32c179[_0x4fb970(0x171)](_0x2c7c9b);}_0x4f9ae1=await saveBufferToTemp(_0x2657e3,_0x35ec32,'image',_0x1dbc4d);let _0x27d27=null;try{_0x27d27=await getSelectionInfo();}catch(_0x2b1dc1){}if(_0x27d27){let _0x128592=null;try{const _0x1bfa97=Math[_0x4fb970(0x146)](val(_0x27d27[_0x4fb970(0x16c)]))||0x0,_0x2118f7=Math[_0x4fb970(0x146)](val(_0x27d27[_0x4fb970(0x14e)]))||0x0,_0x2e3ae1=await action[_0x4fb970(0x145)]([{'_obj':_0x4fb970(0x161),'_target':[{'_ref':_0x4fb970(0x12d)}]},{'_obj':_0x4fb970(0x13e),'mode':{'_enum':_0x4fb970(0x129),'_value':'normal'},'opacity':{'_unit':_0x4fb970(0x113),'_value':0x64},'using':{'_enum':_0x4fb970(0x159),'_value':'black'}},{'_obj':'fill','mode':{'_enum':'interpolation','_value':_0x4fb970(0x114)},'opacity':{'_unit':_0x4fb970(0x113),'_value':0x64},'using':{'_enum':_0x4fb970(0x159),'_value':_0x4fb970(0x142)}}],{});_0x128592=_0x2e3ae1[0x0]?.[_0x4fb970(0x16f)];const _0x32d417=await imaging[_0x4fb970(0x132)]({'documentID':_0xca473d['id'],'layerID':_0x128592});let _0x1b7212=await _0x32d417[_0x4fb970(0x10d)][_0x4fb970(0x150)]();if(_0x1b7212&&_0x1b7212[_0x4fb970(0x11f)])_0x1b7212=_0x1b7212[_0x4fb970(0x11f)];const _0x38eaec=_0x32d417['imageData']['width'],_0x34537c=_0x32d417[_0x4fb970(0x10d)]['height'],_0x34b94a=_0x32d417[_0x4fb970(0x10d)][_0x4fb970(0x118)]||0x1;_0x5daec2=new Uint8Array(_0x343baa*_0x3c9a10*0x4);const _0x6c3c7d=Math['min'](_0x38eaec,_0x343baa),_0x4b4859=Math[_0x4fb970(0x157)](_0x34537c,_0x3c9a10);for(let _0x12005e=0x0;_0x12005e<_0x4b4859;_0x12005e++){const _0x283861=_0x2118f7+_0x12005e;if(_0x283861<0x0||_0x283861>=_0x3c9a10)continue;for(let _0x4d958a=0x0;_0x4d958a<_0x6c3c7d;_0x4d958a++){const _0x2cc69d=_0x1bfa97+_0x4d958a;if(_0x2cc69d<0x0||_0x2cc69d>=_0x343baa)continue;const _0xf91865=(_0x12005e*_0x38eaec+_0x4d958a)*_0x34b94a,_0x502fb5=(_0x283861*_0x343baa+_0x2cc69d)*0x4;let _0x5c7527=_0x1b7212[_0xf91865];if(_0x34b94a>=0x2&&_0x1b7212[_0xf91865+_0x34b94a-0x1]<0x80)_0x5c7527=0x0;_0x5daec2[_0x502fb5]=0xff,_0x5daec2[_0x502fb5+0x1]=0x0,_0x5daec2[_0x502fb5+0x2]=0x0,_0x5daec2[_0x502fb5+0x3]=_0x5c7527;}}if(_0x32d417[_0x4fb970(0x138)])_0x32d417[_0x4fb970(0x138)]();const _0x22a88c=new PngEncoder(_0x343baa,_0x3c9a10,0x4),_0x17d3ae=_0x22a88c['encode'](_0x5daec2);_0x144057=await saveBufferToTemp(_0x17d3ae,_0x35ec32,'mask_preview',_0x1dbc4d);}catch(_0x5efd82){console[_0x4fb970(0x133)]('[BizyAir]\x20Mask\x20capture\x20failed',_0x5efd82);}finally{if(_0x128592!==null)try{await action[_0x4fb970(0x145)]([{'_obj':_0x4fb970(0x165),'_target':[{'_ref':'layer','_id':_0x128592}]}],{});}catch(_0x280c6f){}}}const _0x263e1b=new Uint8Array(_0x343baa*_0x3c9a10*0x4);if(_0x2c7c9b){for(let _0x50d5b1=0x0;_0x50d5b1<_0x263e1b[_0x4fb970(0x121)];_0x50d5b1+=0x4){_0x263e1b[_0x50d5b1]=_0x2c7c9b[_0x50d5b1],_0x263e1b[_0x50d5b1+0x1]=_0x2c7c9b[_0x50d5b1+0x1],_0x263e1b[_0x50d5b1+0x2]=_0x2c7c9b[_0x50d5b1+0x2],_0x5daec2?_0x263e1b[_0x50d5b1+0x3]=0xff-_0x5daec2[_0x50d5b1+0x3]:_0x263e1b[_0x50d5b1+0x3]=0xff;}const _0x4fd4b7=new PngEncoder(_0x343baa,_0x3c9a10,0x4),_0x268561=_0x4fd4b7[_0x4fb970(0x171)](_0x263e1b);_0x268561&&(_0x2e45f1=await saveBufferToTemp(_0x268561,_0x35ec32,_0x4fb970(0x166),_0x1dbc4d));}},{'commandName':_0x3e65b1(0x14d)}),{'success':!![],'image':_0x4f9ae1,'mask':_0x144057,'rgba':_0x2e45f1,'width':_0x343baa,'height':_0x3c9a10,'isLocal':!![]};}catch(_0x1f5385){return console[_0x3e65b1(0x133)](_0x3e65b1(0x163),_0x1f5385),{'success':![],'error':_0x1f5385['message']||String(_0x1f5385)};}finally{isProcessing=![];}}async function pickLocalFile(){const _0x9f4d87=a0_0x25a710;try{const _0x2c45fb=await fs['getFileForOpening']({'types':[_0x9f4d87(0x119),'jpg',_0x9f4d87(0x123),_0x9f4d87(0x184)],'allowMultiple':![]});if(!_0x2c45fb)return{'success':![],'error':_0x9f4d87(0x13b)};const _0x20ff11=await fs[_0x9f4d87(0x13d)](),_0x1b041a=_0x2c45fb['name'],_0x3a16f6=await _0x2c45fb[_0x9f4d87(0x14f)](_0x20ff11,{'newName':_0x1b041a,'overwrite':!![]});return{'success':!![],'image':_0x3a16f6[_0x9f4d87(0x15c)],'name':_0x2c45fb[_0x9f4d87(0x120)],'isLocal':!![]};}catch(_0x4d4b1e){return console['error']('pickLocalFile\x20Error',_0x4d4b1e),{'success':![],'error':_0x4d4b1e['message']};}}function a0_0x5261(){const _0x208764=['Bgf5zxi','CxvHzenLBNrLCLn0yxrL','zMLSztOVlW','rMLSzsbUB3qGzM91BMqGAw4GDgvTCcbZDg9YywDL','rw1WDhKGCgf0Aa','z2v0ugL4zwXZ','zxjYB3i','C3bSAxq','z2v0','yMLUyxj5','uuntqxzLCMfNzq','zgLZCg9Zzq','DMfSDwu','ywn0AxzLrg9JDw1LBNq','vxnLCIbJyw5JzwXSzwq','mJeZmdaZmgzLy0nutq','z2v0vgvTCg9Yyxj5rM9SzgvY','zMLSBa','rMfPBgvKihrVihjLDhjPzxzLigLTywDLigrHDgeU','ChjVCgvYDhK','C29YDa','D2HPDgu','Cg9W','nZG1nZeYzuD3qKLP','yMf0y2HqBgf5','CM91BMq','yMLJDwjPyW','ndqYmZe3D2LSsKvA','y2fUDMfZ','tM8Gywn0AxzLigrVy3vTzw50','lNbUzW','zg9UDerPC3bSyxK','qML6EufPCIbjBwfNzsbby3f1AxnPDgLVBG','Dg9W','y29WEvrV','z2v0rgf0yq','DxHWx2rVD25SB2fKxW','mK9TDvb0sq','lI91DgLSCY9WBMDFzw5JB2rLCI5QCW','zg93BMXVywrF','rMLSzsbUB3qGzM91BMq','y3jLyxrLrMLSzq','BwLU','AgLKzq','zMLSBenVBNrLBNrZ','nJbjDNvYDuy','ywXS','BMf0AxzLugf0Aa','zMLSzq','nLPHBuzhEq','BM93','x3bYB3bLCNr5','BwfRzq','B2jQzwn0','z2v0qwn0AxzLrg9JDw1LBNrjBwfNzsbfCNjVCG','zM9YBwf0CW','zgvSzxrL','CMDIyq','C2HVDW','CMvWBgfJzq','z2v0rw50CNK','yML6EwfPCL9Yzxn1BhrF','D3jPDgu','BgvMDa','yML6EwfPCL9SyxLLCL8','AxnbCNjHEq','Bgf5zxjjra','yM90Dg9T','zw5JB2rL','mZuZmJeXwLDhBgrV','x3jLzG','C2vSzwn0Aw9U','Aw50zxjWB2XHDgLVBLr5Cgu','C3rHCNrZv2L0Aa','C2vSzwn0','tM8Gywn0AxzLigXHEwvYihnLBgvJDgvK','x3rHCMDLDa','yM91BMrZtM9fzMzLy3rZ','x3zHBhvL','zMLSDgvY','AgvPz2H0','DgfYz2v0rw51Bq','nJe4nZiYnfnev0vJDa','C29Tzq','yML6EwfPCL8','DxHW','Bw92zq','D2vICa','nde1nZqXnvz0Eejsyq','BwvZC2fNzq','ywrKtM90AwzPy2f0Aw9UtgLZDgvUzxi','zw5JB2rLsw1Hz2veyxrH','y3jLyxrLu2vZC2LVBLrVA2vU','ugXHy2uGyw5KiefSAwDUieLTywDL','yxjYyxLcDwzMzxi','Aw1Hz2veyxrH','C2v0','C3rVCMfNzq','C2HVD0fSzxj0','DhjHBNnMB3jT','A2v5CW','CgvYy2vUDfvUAxq','BM9YBwfS','mtyWnduXmgDozNfcqq','z2v0rw50CMLLCW','z2v0rw50CNLxAxrOvxjS','y29TCg9Uzw50CW','Cg5N','yM91BMrZ','CMvZzxq','CMLNAhq','CgL4zwXZvw5PDa','B2zMC2v0','zgf0yq','BMfTzq','BgvUz3rO','sw52ywXPzcbMAwXLBMfTzq','ANbLzW','D2LKDgG','zxHLy3v0zufZtw9KywW','Aw5JBhvKzxm','zw5KC1DPDgG','AxngAwXL','Aw50zxjWB2XHDgLVBG','zNjVBq','zg9JDw1LBNq','B3jKAw5HBa'];a0_0x5261=function(){return _0x208764;};return a0_0x5261();}async function downloadUrlToTemp(_0x406fc2,_0x23ff56){const _0x1fae6f=a0_0x25a710;if(!_0x23ff56)_0x23ff56=_0x1fae6f(0x154)+Date[_0x1fae6f(0x15f)]()+_0x1fae6f(0x14b);const _0x6a96f1=await fetch(_0x406fc2),_0x3d5599=await _0x6a96f1[_0x1fae6f(0x10c)](),_0x526173=await fs['getTemporaryFolder'](),_0x125f90=await _0x526173['createFile'](_0x23ff56,{'overwrite':!![]});return await _0x125f90[_0x1fae6f(0x16b)](_0x3d5599,{'format':formats[_0x1fae6f(0x136)]}),_0x125f90;}async function createDocFromUrl(_0x17e6bb){const _0x430b01=a0_0x25a710;try{let _0xf6a529;if(_0x17e6bb[_0x430b01(0x176)](_0x430b01(0x12f)))_0xf6a529=await fs['getEntryWithUrl'](_0x17e6bb);else{const _0x779222=await downloadUrlToTemp(_0x17e6bb,_0x430b01(0x16a));_0xf6a529=await fs[_0x430b01(0x117)](_0x430b01(0x12f)+_0x779222[_0x430b01(0x15c)]);}return await executeAsModal(async()=>{await app['open'](_0xf6a529);},{'commandName':'Create\x20New\x20Document'}),{'success':!![]};}catch(_0x173985){return{'success':![],'error':_0x173985[_0x430b01(0x107)]};}}async function placeImageFromUrl(_0x33d206,_0x111d8e=![]){const _0x5cdd95=a0_0x25a710;try{let _0x37e79f;if(_0x33d206[_0x5cdd95(0x176)]('file://'))_0x37e79f=await fs[_0x5cdd95(0x117)](_0x33d206);else{const _0x30ee57=await downloadUrlToTemp(_0x33d206,_0x5cdd95(0x16d));_0x37e79f=await fs[_0x5cdd95(0x117)]('file://'+_0x30ee57['nativePath']);}return await executeAsModal(async _0x4cfa92=>{const _0x420a79=_0x5cdd95,_0x37187b=app[_0x420a79(0x13a)],_0x2510f7=await fs[_0x420a79(0x10a)](_0x37e79f);await batchPlay([{'_obj':'placeEvent','target':{'_path':_0x2510f7,'_kind':'local'},'linked':!![]}],{});const _0x45d0a8=_0x37187b['activeLayers'][0x0],_0x117d58=_0x45d0a8[_0x420a79(0x17a)],_0x123fe0=_0x117d58[_0x420a79(0x11c)]-_0x117d58[_0x420a79(0x16c)],_0x4ec260=_0x117d58['bottom']-_0x117d58[_0x420a79(0x14e)],_0x3796c3=(_0x117d58[_0x420a79(0x16c)]+_0x117d58[_0x420a79(0x11c)])/0x2,_0x45b12f=(_0x117d58[_0x420a79(0x14e)]+_0x117d58[_0x420a79(0x170)])/0x2;let _0x141a48={'left':0x0,'top':0x0,'right':_0x37187b['width'],'bottom':_0x37187b['height']};try{const _0x478f1e=_0x37187b[_0x420a79(0x174)][_0x420a79(0x11a)];if(_0x478f1e)_0x141a48=_0x478f1e;}catch(_0x2a254d){}const _0x2f267b=_0x141a48[_0x420a79(0x11c)]-_0x141a48[_0x420a79(0x16c)],_0x37a5ac=_0x141a48[_0x420a79(0x170)]-_0x141a48[_0x420a79(0x14e)],_0x7b8683=(_0x141a48[_0x420a79(0x16c)]+_0x141a48[_0x420a79(0x11c)])/0x2,_0x1d7339=(_0x141a48[_0x420a79(0x14e)]+_0x141a48[_0x420a79(0x170)])/0x2;let _0x1c7e53=0x64,_0x566954=0x64,_0x2ca8bc=_0x7b8683-_0x3796c3,_0x5dd96=_0x1d7339-_0x45b12f;!_0x111d8e?(_0x1c7e53=_0x2f267b/_0x123fe0*0x64,_0x566954=_0x37a5ac/_0x4ec260*0x64):(_0x2ca8bc=_0x37187b[_0x420a79(0x124)]/0x2-_0x3796c3,_0x5dd96=_0x37187b[_0x420a79(0x17d)]/0x2-_0x45b12f),await batchPlay([{'_obj':_0x420a79(0x111),'_target':[{'_ref':'layer','_enum':_0x420a79(0x12c),'_value':'targetEnum'}],'freeTransformCenterState':{'_enum':_0x420a79(0x12e),'_value':_0x420a79(0x137)},'offset':{'_obj':_0x420a79(0x11e),'horizontal':{'_unit':'pixelsUnit','_value':_0x2ca8bc},'vertical':{'_unit':_0x420a79(0x11d),'_value':_0x5dd96}},'width':{'_unit':_0x420a79(0x113),'_value':_0x1c7e53},'height':{'_unit':'percentUnit','_value':_0x566954},'interpolation':{'_enum':_0x420a79(0x175),'_value':_0x420a79(0x147)}}],{}),await batchPlay([{'_obj':'rasterizeLayer','_target':[{'_ref':'layer','_enum':'ordinal','_value':_0x420a79(0x17e)}]}],{});},{'commandName':_0x5cdd95(0x10b)}),{'success':!![]};}catch(_0x22247b){return{'success':![],'error':_0x22247b[_0x5cdd95(0x107)]};}}function getDocumentInfo(){const _0x37a786=a0_0x25a710;if(!app||!app['activeDocument'])return{'hasDocument':![]};const _0x3966ca=app[_0x37a786(0x13a)];return{'hasDocument':!![],'width':_0x3966ca['width'][_0x37a786(0x139)]||_0x3966ca['width'],'height':_0x3966ca['height'][_0x37a786(0x139)]||_0x3966ca[_0x37a786(0x17d)]};}function startSelectionListener(_0x3619c3){const _0xc80092=a0_0x25a710;if(!action||!action['addNotificationListener'])return;let _0x45d10a=null;const _0x2ec33a=()=>{if(isProcessing)return;if(_0x3619c3)_0x3619c3();};action[_0xc80092(0x108)]([_0xc80092(0x15b)],(_0x166cd3,_0x31b79e)=>{const _0x1673e9=_0xc80092,_0x12e7fc=[_0x1673e9(0x10e),_0x1673e9(0x11b),_0x1673e9(0x177),_0x1673e9(0x161),_0x1673e9(0x183),_0x1673e9(0x111),'show',_0x1673e9(0x158),_0x1673e9(0x165)];if(_0x12e7fc[_0x1673e9(0x126)](_0x166cd3)){const _0x489a5a=_0x31b79e[_0x1673e9(0x179)];let _0x3626c3=![];_0x489a5a&&Array[_0x1673e9(0x16e)](_0x489a5a)&&(_0x3626c3=_0x489a5a[_0x1673e9(0x180)](_0x5b999e=>_0x5b999e['_ref']==='channel'&&(_0x5b999e[_0x1673e9(0x17b)]===_0x1673e9(0x174)||_0x5b999e[_0x1673e9(0x160)]===_0x1673e9(0x174))||_0x5b999e[_0x1673e9(0x173)]==='selection'||_0x5b999e['_ref']==='property'&&_0x5b999e['_property']===_0x1673e9(0x174)));if(!_0x3626c3){if([_0x1673e9(0x167),'hide',_0x1673e9(0x177)][_0x1673e9(0x126)](_0x166cd3))_0x3626c3=!![];else[_0x1673e9(0x183),_0x1673e9(0x111),_0x1673e9(0x165)][_0x1673e9(0x126)](_0x166cd3)&&(_0x3626c3=!![]);}if(_0x3626c3){if(_0x45d10a)clearTimeout(_0x45d10a);_0x45d10a=setTimeout(_0x2ec33a,0x258);}}});}async function listHistoryFiles(){const _0x2ee10c=a0_0x25a710;try{const _0x107947=await fs[_0x2ee10c(0x13d)](),_0x199f1e=await _0x107947[_0x2ee10c(0x116)](),_0x5ce55f=_0x199f1e[_0x2ee10c(0x17c)](_0x259924=>_0x259924[_0x2ee10c(0x128)]&&(_0x259924[_0x2ee10c(0x120)]['startsWith'](_0x2ee10c(0x151))||_0x259924[_0x2ee10c(0x120)][_0x2ee10c(0x176)](_0x2ee10c(0x181)))&&_0x259924['name'][_0x2ee10c(0x127)](_0x2ee10c(0x14b)))[_0x2ee10c(0x141)]((_0x1a82a9,_0x47fd88)=>_0x47fd88[_0x2ee10c(0x120)]['localeCompare'](_0x1a82a9['name']))['map'](_0x44dafb=>_0x2ee10c(0x12f)+_0x44dafb[_0x2ee10c(0x15c)]);return{'success':!![],'files':_0x5ce55f};}catch(_0x263ff8){return{'success':![],'error':_0x263ff8[_0x2ee10c(0x107)]};}}async function deleteFile(_0x27bf9c){const _0xa3c858=a0_0x25a710;try{if(_0x27bf9c[_0xa3c858(0x176)](_0xa3c858(0x12f)))_0x27bf9c=_0x27bf9c[_0xa3c858(0x168)](_0xa3c858(0x12f),'');const _0x238740=_0x27bf9c[_0xa3c858(0x134)]('/')[_0xa3c858(0x143)]();if(!_0x238740)return{'success':![],'error':_0xa3c858(0x122)};const _0x2842ca=await fs['getTemporaryFolder'](),_0x5a2dcc=await _0x2842ca[_0xa3c858(0x169)](_0x238740);if(_0x5a2dcc)return await _0x5a2dcc[_0xa3c858(0x165)](),{'success':!![]};return{'success':![],'error':_0xa3c858(0x155)};}catch(_0x2b0fa7){return{'success':![],'error':_0x2b0fa7[_0xa3c858(0x107)]};}}async function clearHistoryFiles(){const _0x28db93=a0_0x25a710;try{const _0x57a8e2=await fs[_0x28db93(0x13d)](),_0x534f8c=await _0x57a8e2[_0x28db93(0x116)](),_0xe5b680=_0x534f8c[_0x28db93(0x17c)](_0xad7285=>_0xad7285[_0x28db93(0x128)]&&(_0xad7285[_0x28db93(0x120)]['startsWith']('uxp_download_')||_0xad7285[_0x28db93(0x120)]['startsWith']('bizyair_'))&&_0xad7285[_0x28db93(0x120)][_0x28db93(0x127)](_0x28db93(0x14b)));for(const _0xddac6d of _0xe5b680){await _0xddac6d[_0x28db93(0x165)]();}return{'success':!![],'count':_0xe5b680[_0x28db93(0x121)]};}catch(_0x373ece){return{'success':![],'error':_0x373ece[_0x28db93(0x107)]};}}async function readBinaryFile(_0x505dcc){const _0x569c3b=a0_0x25a710;try{if(!_0x505dcc)return{'success':![],'error':_0x569c3b(0x131)};let _0x5556a6=_0x505dcc;if(_0x5556a6[_0x569c3b(0x176)]('file://'))_0x5556a6=_0x5556a6[_0x569c3b(0x168)](_0x569c3b(0x12f),'');const _0x252805=_0x5556a6['split']('/')[_0x569c3b(0x143)](),_0xc071a7=await fs['getTemporaryFolder'](),_0x13f5cd=await _0xc071a7[_0x569c3b(0x169)](_0x252805);if(_0x13f5cd&&_0x13f5cd['isFile']){const _0x13df72=await _0x13f5cd['read']({'format':formats[_0x569c3b(0x136)]});return{'success':!![],'buffer':Array[_0x569c3b(0x12a)](new Uint8Array(_0x13df72))};}return{'success':![],'error':_0x569c3b(0x130)};}catch(_0x527d13){return{'success':![],'error':_0x527d13[_0x569c3b(0x107)]};}}window['photoshopAPI']={'getActiveDocumentImage':getActiveDocumentImage,'createDocFromUrl':createDocFromUrl,'placeImageFromUrl':placeImageFromUrl,'downloadUrlToTemp':downloadUrlToTemp,'getDocumentInfo':getDocumentInfo,'startSelectionListener':startSelectionListener,'listHistoryFiles':listHistoryFiles,'deleteFile':deleteFile,'clearHistoryFiles':clearHistoryFiles,'pickLocalFile':pickLocalFile,'readBinaryFile':readBinaryFile,'showAlert':_0x59009a=>app[a0_0x25a710(0x110)](_0x59009a)};
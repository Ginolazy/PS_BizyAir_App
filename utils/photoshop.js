const a0_0x5e796a=a0_0x2c28;function a0_0x2c28(_0x5b9e76,_0x37ff3a){_0x5b9e76=_0x5b9e76-0x14f;const _0xb4b327=a0_0xb4b3();let _0x2c2841=_0xb4b327[_0x5b9e76];if(a0_0x2c28['uiTAHi']===undefined){var _0x1286fa=function(_0x11b06d){const _0x384aa9='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x2401b5='',_0x76923a='';for(let _0x3d2b5d=0x0,_0x5f1d4c,_0x6dd958,_0x4b851c=0x0;_0x6dd958=_0x11b06d['charAt'](_0x4b851c++);~_0x6dd958&&(_0x5f1d4c=_0x3d2b5d%0x4?_0x5f1d4c*0x40+_0x6dd958:_0x6dd958,_0x3d2b5d++%0x4)?_0x2401b5+=String['fromCharCode'](0xff&_0x5f1d4c>>(-0x2*_0x3d2b5d&0x6)):0x0){_0x6dd958=_0x384aa9['indexOf'](_0x6dd958);}for(let _0x212bd6=0x0,_0x3d4ab2=_0x2401b5['length'];_0x212bd6<_0x3d4ab2;_0x212bd6++){_0x76923a+='%'+('00'+_0x2401b5['charCodeAt'](_0x212bd6)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x76923a);};a0_0x2c28['kwdbrD']=_0x1286fa,a0_0x2c28['HwESrK']={},a0_0x2c28['uiTAHi']=!![];}const _0x1ddc3f=_0xb4b327[0x0],_0xa82833=_0x5b9e76+_0x1ddc3f,_0x8aaf06=a0_0x2c28['HwESrK'][_0xa82833];return!_0x8aaf06?(_0x2c2841=a0_0x2c28['kwdbrD'](_0x2c2841),a0_0x2c28['HwESrK'][_0xa82833]=_0x2c2841):_0x2c2841=_0x8aaf06,_0x2c2841;}(function(_0x251c15,_0x59fac3){const _0x52151a=a0_0x2c28,_0x49ab64=_0x251c15();while(!![]){try{const _0x215e63=-parseInt(_0x52151a(0x16c))/0x1*(parseInt(_0x52151a(0x177))/0x2)+-parseInt(_0x52151a(0x19c))/0x3+-parseInt(_0x52151a(0x15e))/0x4+parseInt(_0x52151a(0x1b2))/0x5*(-parseInt(_0x52151a(0x176))/0x6)+parseInt(_0x52151a(0x1b7))/0x7*(-parseInt(_0x52151a(0x192))/0x8)+parseInt(_0x52151a(0x1b1))/0x9*(-parseInt(_0x52151a(0x182))/0xa)+parseInt(_0x52151a(0x188))/0xb;if(_0x215e63===_0x59fac3)break;else _0x49ab64['push'](_0x49ab64['shift']());}catch(_0x143391){_0x49ab64['push'](_0x49ab64['shift']());}}}(a0_0xb4b3,0x19809));const {app,action,core,imaging}=require(a0_0x5e796a(0x1c0)),{batchPlay}=action,fs=require(a0_0x5e796a(0x191))[a0_0x5e796a(0x195)]['localFileSystem'],formats=require(a0_0x5e796a(0x191))[a0_0x5e796a(0x195)][a0_0x5e796a(0x1cb)],executeAsModal=core[a0_0x5e796a(0x1a8)],PngEncoder=require(a0_0x5e796a(0x15b));let isProcessing=![];const val=_0x2401b5=>{const _0x3a08ab=a0_0x5e796a;if(_0x2401b5===null||_0x2401b5===undefined)return 0x0;if(typeof _0x2401b5===_0x3a08ab(0x1ab)){if(_0x2401b5[_0x3a08ab(0x18f)]!==undefined)return _0x2401b5[_0x3a08ab(0x18f)];if(_0x2401b5[_0x3a08ab(0x186)]!==undefined)return _0x2401b5[_0x3a08ab(0x186)];if(Object[_0x3a08ab(0x175)](_0x2401b5)[_0x3a08ab(0x187)]===0x1){const _0x76923a=Object['keys'](_0x2401b5)[0x0];return val(_0x2401b5[_0x76923a]);}}return _0x2401b5;};async function getSelectionInfo(){const _0x3e14ff=a0_0x5e796a;try{const _0x3d2b5d=await action[_0x3e14ff(0x16b)]([{'_obj':_0x3e14ff(0x1a1),'_target':[{'_ref':_0x3e14ff(0x180),'_property':_0x3e14ff(0x174)},{'_ref':_0x3e14ff(0x19a),'_enum':'ordinal','_value':'targetEnum'}],'_options':{'dialogOptions':'dontDisplay'}}],{'synchronousExecution':!![]});if(_0x3d2b5d&&_0x3d2b5d[0x0]&&_0x3d2b5d[0x0][_0x3e14ff(0x174)])return _0x3d2b5d[0x0][_0x3e14ff(0x174)];return null;}catch(_0x5f1d4c){return null;}}function calculateTargetSize(_0x6dd958,_0x4b851c){const _0x5e7f0d=a0_0x5e796a;let _0x212bd6=_0x6dd958[_0x5e7f0d(0x17c)],_0x3d4ab2=_0x6dd958['height'],_0x43f5f1=_0x212bd6,_0x346720=_0x3d4ab2;if(_0x4b851c&&(_0x212bd6>_0x4b851c||_0x3d4ab2>_0x4b851c)){const _0x141e63=Math['min'](_0x4b851c/_0x212bd6,_0x4b851c/_0x3d4ab2);_0x43f5f1=Math[_0x5e7f0d(0x1c8)](_0x212bd6*_0x141e63),_0x346720=Math[_0x5e7f0d(0x1c8)](_0x3d4ab2*_0x141e63);}return{'width':_0x43f5f1,'height':_0x346720};}async function encodeToPng(_0x20a11b){const _0x36da08=a0_0x5e796a;if(!_0x20a11b||!_0x20a11b[_0x36da08(0x1c9)])throw new Error(_0x36da08(0x17b));try{const _0x422314=await imaging[_0x36da08(0x196)]({'imageData':_0x20a11b[_0x36da08(0x1c9)],'format':_0x36da08(0x199),'base64':![]});return _0x422314;}finally{_0x20a11b['dispose']&&_0x20a11b['dispose']();}}async function saveBufferToTemp(_0xb1e34a,_0x577552,_0x160d6b,_0x564ca3){const _0x2400a2=a0_0x5e796a,_0x3872e3=_0x564ca3?String(_0x564ca3)[_0x2400a2(0x198)](/[^a-zA-Z0-9_-]/g,'_'):'';let _0x326c63=_0x577552?String(_0x577552)[_0x2400a2(0x198)](/[^a-zA-Z0-9_-]/g,'_')[_0x2400a2(0x198)](/(_image|_mask_preview|_mask|_rgba)$/g,''):'';if(!_0x326c63)_0x326c63=_0x160d6b||_0x2400a2(0x15d);let _0x3a8a1d=_0x3872e3?_0x3872e3+'_'+_0x326c63+'_'+_0x160d6b+_0x2400a2(0x1a6):_0x326c63+'_'+_0x160d6b+_0x2400a2(0x1a6);const _0x3da146=await fs['getTemporaryFolder'](),_0x5b7b44=await _0x3da146['createFile'](_0x3a8a1d,{'overwrite':!![]});return await _0x5b7b44[_0x2400a2(0x17a)](_0xb1e34a,{'format':formats[_0x2400a2(0x184)]}),_0x5b7b44['nativePath'];}async function getActiveDocumentImage(_0x299654={}){const _0x5ec04d=a0_0x5e796a,{baseMode:baseMode=_0x5ec04d(0x197),nodeId:_0x370589,appId:_0x17e36b}=_0x299654;if(!app[_0x5ec04d(0x179)])return{'success':![],'error':_0x5ec04d(0x1ce)};isProcessing=!![];try{const _0x31b417=app[_0x5ec04d(0x179)];let _0x533b65=null,_0x3ca418=null,_0x57d92f=null;const _0x8251a4=parseInt(val(_0x31b417[_0x5ec04d(0x17c)]))||0x0,_0x458de6=parseInt(val(_0x31b417[_0x5ec04d(0x1a0)]))||0x0,_0x116783=_0x8251a4,_0x7d1125=_0x458de6;let _0x5b93bf=null,_0x466238=null;return await executeAsModal(async _0x26785c=>{const _0x282934=_0x5ec04d;let _0xdad6e7=null;if(baseMode===_0x282934(0x197)){const _0x22fa4e=await imaging[_0x282934(0x1cd)]({'documentID':_0x31b417['id'],'targetSize':{'width':_0x116783,'height':_0x7d1125},'applyAlpha':!![]}),_0x5a1aef=_0x22fa4e[_0x282934(0x1c9)]['width'],_0x1a7eeb=_0x22fa4e['imageData']['height'],_0x352029=_0x22fa4e[_0x282934(0x1c9)][_0x282934(0x19d)]||0x4;let _0x167d89=await _0x22fa4e[_0x282934(0x1c9)][_0x282934(0x1a2)]();if(_0x167d89&&_0x167d89['data'])_0x167d89=_0x167d89['data'];_0x5b93bf=new Uint8Array(_0x116783*_0x7d1125*0x4);for(let _0x2d7940=0x0;_0x2d7940<_0x116783*_0x7d1125;_0x2d7940++){const _0x19a56c=_0x2d7940*_0x352029,_0x2d52d2=_0x2d7940*0x4;_0x5b93bf[_0x2d52d2]=_0x167d89[_0x19a56c],_0x5b93bf[_0x2d52d2+0x1]=_0x167d89[_0x19a56c+0x1],_0x5b93bf[_0x2d52d2+0x2]=_0x167d89[_0x19a56c+0x2],_0x5b93bf[_0x2d52d2+0x3]=_0x352029===0x4?_0x167d89[_0x19a56c+0x3]:0xff;}const _0x2a1906=new PngEncoder(_0x116783,_0x7d1125,0x4);_0xdad6e7=_0x2a1906['encode'](_0x5b93bf);}else{const _0x2fe190=_0x31b417[_0x282934(0x183)][0x0];if(!_0x2fe190)throw new Error('No\x20active\x20layer\x20selected');const _0x5ef4a8=_0x2fe190['boundsNoEffects'],_0x1dcde6=parseInt(val(_0x5ef4a8[_0x282934(0x14f)]))||0x0,_0x149a00=parseInt(val(_0x5ef4a8[_0x282934(0x1bd)]))||0x0,_0x2473a8=await imaging[_0x282934(0x1cd)]({'documentID':_0x31b417['id'],'layerID':_0x2fe190['id'],'applyAlpha':!![]}),_0x579380=_0x2473a8[_0x282934(0x1c9)][_0x282934(0x17c)],_0x20fa4c=_0x2473a8['imageData'][_0x282934(0x1a0)],_0x26a36f=_0x2473a8['imageData'][_0x282934(0x19d)]||0x4;let _0x10c1dd=await _0x2473a8['imageData'][_0x282934(0x1a2)]();if(_0x10c1dd&&_0x10c1dd[_0x282934(0x155)])_0x10c1dd=_0x10c1dd[_0x282934(0x155)];_0x5b93bf=new Uint8Array(_0x116783*_0x7d1125*0x4);if(_0x10c1dd&&_0x10c1dd[_0x282934(0x187)]>0x0)for(let _0x4a19cd=0x0;_0x4a19cd<_0x20fa4c;_0x4a19cd++){const _0x35822b=_0x1dcde6+_0x4a19cd;if(_0x35822b<0x0||_0x35822b>=_0x7d1125)continue;for(let _0x2eb185=0x0;_0x2eb185<_0x579380;_0x2eb185++){const _0x43aa92=_0x149a00+_0x2eb185;if(_0x43aa92<0x0||_0x43aa92>=_0x116783)continue;const _0x131da9=(_0x4a19cd*_0x579380+_0x2eb185)*_0x26a36f,_0x4c0420=(_0x35822b*_0x116783+_0x43aa92)*0x4;_0x5b93bf[_0x4c0420]=_0x10c1dd[_0x131da9],_0x5b93bf[_0x4c0420+0x1]=_0x10c1dd[_0x131da9+0x1],_0x5b93bf[_0x4c0420+0x2]=_0x10c1dd[_0x131da9+0x2];if(_0x26a36f===0x4)_0x5b93bf[_0x4c0420+0x3]=_0x10c1dd[_0x131da9+0x3];else{const _0x52c2f0=_0x10c1dd[_0x131da9]===0xff&&_0x10c1dd[_0x131da9+0x1]===0xff&&_0x10c1dd[_0x131da9+0x2]===0xff;_0x5b93bf[_0x4c0420+0x3]=_0x52c2f0?0x0:0xff;}}}if(_0x2473a8[_0x282934(0x194)])_0x2473a8[_0x282934(0x194)]();const _0x207a61=new PngEncoder(_0x116783,_0x7d1125,0x4);_0xdad6e7=_0x207a61[_0x282934(0x161)](_0x5b93bf);}_0x533b65=await saveBufferToTemp(_0xdad6e7,_0x370589,_0x282934(0x1b9),_0x17e36b);let _0x4e1791=null;try{_0x4e1791=await getSelectionInfo();}catch(_0x4053f3){}if(_0x4e1791){let _0x5c5382=null;try{const _0x4e7fc4=Math[_0x282934(0x1c8)](val(_0x4e1791['left']))||0x0,_0x556d63=Math[_0x282934(0x1c8)](val(_0x4e1791[_0x282934(0x14f)]))||0x0,_0x2743d2=await action[_0x282934(0x16b)]([{'_obj':_0x282934(0x172),'_target':[{'_ref':_0x282934(0x18e)}]},{'_obj':_0x282934(0x160),'mode':{'_enum':_0x282934(0x156),'_value':_0x282934(0x1c7)},'opacity':{'_unit':_0x282934(0x1a9),'_value':0x64},'using':{'_enum':_0x282934(0x1a3),'_value':_0x282934(0x17d)}},{'_obj':_0x282934(0x160),'mode':{'_enum':'interpolation','_value':_0x282934(0x1c7)},'opacity':{'_unit':_0x282934(0x1a9),'_value':0x64},'using':{'_enum':_0x282934(0x1a3),'_value':_0x282934(0x181)}}],{});_0x5c5382=_0x2743d2[0x0]?.['layerID'];const _0x2bcf17=await imaging[_0x282934(0x1cd)]({'documentID':_0x31b417['id'],'layerID':_0x5c5382});let _0x353a82=await _0x2bcf17[_0x282934(0x1c9)][_0x282934(0x1a2)]();if(_0x353a82&&_0x353a82[_0x282934(0x155)])_0x353a82=_0x353a82[_0x282934(0x155)];const _0x555880=_0x2bcf17[_0x282934(0x1c9)][_0x282934(0x17c)],_0x3822a0=_0x2bcf17['imageData']['height'],_0x18a439=_0x2bcf17[_0x282934(0x1c9)]['components']||0x1;_0x466238=new Uint8Array(_0x116783*_0x7d1125*0x4);const _0x561547=Math[_0x282934(0x1b4)](_0x555880,_0x116783),_0x249ec9=Math[_0x282934(0x1b4)](_0x3822a0,_0x7d1125);for(let _0x16dec6=0x0;_0x16dec6<_0x249ec9;_0x16dec6++){const _0x3b83e6=_0x556d63+_0x16dec6;if(_0x3b83e6<0x0||_0x3b83e6>=_0x7d1125)continue;for(let _0x383ac0=0x0;_0x383ac0<_0x561547;_0x383ac0++){const _0xee6c83=_0x4e7fc4+_0x383ac0;if(_0xee6c83<0x0||_0xee6c83>=_0x116783)continue;const _0x425417=(_0x16dec6*_0x555880+_0x383ac0)*_0x18a439,_0x47ee75=(_0x3b83e6*_0x116783+_0xee6c83)*0x4;let _0xad933f=_0x353a82[_0x425417];if(_0x18a439>=0x2&&_0x353a82[_0x425417+_0x18a439-0x1]<0x80)_0xad933f=0x0;_0x466238[_0x47ee75]=0xff,_0x466238[_0x47ee75+0x1]=0x0,_0x466238[_0x47ee75+0x2]=0x0,_0x466238[_0x47ee75+0x3]=_0xad933f;}}if(_0x2bcf17[_0x282934(0x194)])_0x2bcf17[_0x282934(0x194)]();const _0x160e58=new PngEncoder(_0x116783,_0x7d1125,0x4),_0x5af988=_0x160e58[_0x282934(0x161)](_0x466238);_0x3ca418=await saveBufferToTemp(_0x5af988,_0x370589,_0x282934(0x1ae),_0x17e36b);}catch(_0x89171c){console[_0x282934(0x164)](_0x282934(0x18c),_0x89171c);}finally{if(_0x5c5382!==null)try{await action['batchPlay']([{'_obj':'delete','_target':[{'_ref':_0x282934(0x18e),'_id':_0x5c5382}]}],{});}catch(_0x35c51f){}}}const _0x30a725=new Uint8Array(_0x116783*_0x7d1125*0x4);if(_0x5b93bf){for(let _0x59a489=0x0;_0x59a489<_0x30a725[_0x282934(0x187)];_0x59a489+=0x4){_0x30a725[_0x59a489]=_0x5b93bf[_0x59a489],_0x30a725[_0x59a489+0x1]=_0x5b93bf[_0x59a489+0x1],_0x30a725[_0x59a489+0x2]=_0x5b93bf[_0x59a489+0x2],_0x466238?_0x30a725[_0x59a489+0x3]=0xff-_0x466238[_0x59a489+0x3]:_0x30a725[_0x59a489+0x3]=0xff;}const _0x5a92c5=new PngEncoder(_0x116783,_0x7d1125,0x4),_0xeb43c=_0x5a92c5[_0x282934(0x161)](_0x30a725);_0xeb43c&&(_0x57d92f=await saveBufferToTemp(_0xeb43c,_0x370589,_0x282934(0x158),_0x17e36b));}},{'commandName':'BizyAir\x20Image\x20Acquisition'}),{'success':!![],'image':_0x533b65,'mask':_0x3ca418,'rgba':_0x57d92f,'width':_0x116783,'height':_0x7d1125,'isLocal':!![]};}catch(_0x4693a9){return console[_0x5ec04d(0x164)]('getActiveDocumentImage\x20Error',_0x4693a9),{'success':![],'error':_0x4693a9['message']||String(_0x4693a9)};}finally{isProcessing=![];}}function a0_0xb4b3(){const _0x35dded=['C2HVDW','lI91DgLSCY9WBMDFzw5JB2rLCI5QCW','yM91BMrZtM9fzMzLy3rZ','zMLSzq','nZC3ndq4s094uhHJ','yxjYyxLcDwzMzxi','zMLSBa','zw5JB2rL','yML6EwfPCL9SyxLLCL8','B3bLBG','zxjYB3i','zw5KC1DPDgG','ANbN','z2v0rw50CNLxAxrOvxjS','z2v0rMLSzuzVCK9Wzw5PBMC','B3jKAw5HBa','yML6EwfPCL8','yMf0y2HqBgf5','mLr1wNjdBG','y3jLyxrLrMLSzq','y2HHBM5LBa','AxnbCNjHEq','Bg9JywXLq29TCgfYzq','D2vICa','BwfRzq','Bg9JywW','C2vSzwn0Aw9U','A2v5CW','mZzss2rksva','mZiXmtrkvuDjy2K','zNjVBq','ywn0AxzLrg9JDw1LBNq','D3jPDgu','rMfPBgvKihrVihjLDhjPzxzLigLTywDLigrHDgeU','D2LKDgG','yMXHy2S','rMLSzsbUB3qGzM91BMqGAw4GDgvTCcbZDg9YywDL','Cg9W','ChjVCgvYDhK','D2HPDgu','mtaWv09WrwPb','ywn0AxzLtgf5zxjZ','yMLUyxj5','C3bSAxq','x3zHBhvL','BgvUz3rO','nZe2mZmXmhjsu25Kqq','BMfTzq','ugXHy2uGyw5KiefSAwDUieLTywDL','zgvSzxrL','w0jPENLbAxjDie1HC2SGy2fWDhvYzsbMywLSzwq','DhjHBNnMB3jT','Bgf5zxi','DMfSDwu','DxHWx2rVD25SB2fKxW','DxHW','mtCYnZj4Cg9izLe','x3jLzG','zgLZCg9Zzq','C3rVCMfNzq','zw5JB2rLsw1Hz2veyxrH','y2fUDMfZ','CMvWBgfJzq','Cg5N','zg9JDw1LBNq','CMvZzxq','mtCZndaWrK5ZDwHs','y29TCg9Uzw50CW','CMvHza','C2vSzwn0','AgvPz2H0','z2v0','z2v0rgf0yq','zMLSBenVBNrLBNrZ','y3jLyxrLu2vZC2LVBLrVA2vU','Aw5JBhvKzxm','lNbUzW','C29YDa','zxHLy3v0zufZtw9KywW','CgvYy2vUDfvUAxq','uuntqxzLCMfNzq','B2jQzwn0','CgHVDg9ZAg9Wqvbj','vxnLCIbJyw5JzwXSzwq','BwfZA19WCMv2Awv3','ANbLzW','CgXHy2vfDMvUDa','mtC4nZG1v1rhtKvl','nda1otvUwKj4sxa','z2v0rw50CNK','BwLU','z2v0vgvTCg9Yyxj5rM9SzgvY','yM91BMrZ','ndLzwez2Cha','Bw92zq','Aw1Hz2u','C2HVD0fSzxj0','C29Tzq','BM93','BgvMDa','CgLJA0XVy2fSrMLSzsbfCNjVCG','BMf0AxzLugf0Aa','CgHVDg9ZAg9W','q3jLyxrLie5LDYbeB2n1BwvUDa','AxngAwXL','x3rHCMDLDa','zMLSDgvY','yMLJDwjPyW','C3rHCNrZv2L0Aa','BM9YBwfS','CM91BMq','Aw1Hz2veyxrH','z2v0rw50CMLLCW','zM9YBwf0CW','CgL4zwXZvw5PDa','z2v0ugL4zwXZ','tM8Gywn0AxzLigrVy3vTzw50','Dg9W','CMLNAhq','B2zMC2v0','BwvZC2fNzq','zMLSztOVlW','x3bYB3bLCNr5','zgf0yq','Aw50zxjWB2XHDgLVBG','AgLKzq','CMDIyq','yM90Dg9T'];a0_0xb4b3=function(){return _0x35dded;};return a0_0xb4b3();}async function pickLocalFile(){const _0x569181=a0_0x5e796a;try{const _0xf82406=await fs[_0x569181(0x168)]({'types':[_0x569181(0x199),_0x569181(0x166),_0x569181(0x1af),_0x569181(0x171)],'allowMultiple':![]});if(!_0xf82406)return{'success':![],'error':_0x569181(0x1ad)};const _0xe4479d=await fs[_0x569181(0x1b5)](),_0x129666=_0xf82406[_0x569181(0x189)],_0x443228=await _0xf82406['copyTo'](_0xe4479d,{'newName':_0x129666,'overwrite':!![]});return{'success':!![],'image':_0x443228[_0x569181(0x1bf)],'name':_0xf82406[_0x569181(0x189)],'isLocal':!![]};}catch(_0x3bccba){return console[_0x569181(0x164)](_0x569181(0x1be),_0x3bccba),{'success':![],'error':_0x3bccba['message']};}}async function downloadUrlToTemp(_0x2c02ab,_0x1b57ca){const _0x51a759=a0_0x5e796a;if(!_0x1b57ca)_0x1b57ca='download_'+Date[_0x51a759(0x1bc)]()+'.png';const _0x35bb46=await fetch(_0x2c02ab),_0x3d0870=await _0x35bb46[_0x51a759(0x15f)](),_0x2b57c3=await fs[_0x51a759(0x1b5)](),_0x57f0fb=await _0x2b57c3[_0x51a759(0x16d)](_0x1b57ca,{'overwrite':!![]});return await _0x57f0fb[_0x51a759(0x17a)](_0x3d0870,{'format':formats[_0x51a759(0x184)]}),_0x57f0fb;}async function createDocFromUrl(_0x28cb52){const _0x55dc40=a0_0x5e796a;try{let _0x597582;if(_0x28cb52[_0x55dc40(0x1c6)](_0x55dc40(0x153)))_0x597582=await fs[_0x55dc40(0x167)](_0x28cb52);else{const _0x4faa89=await downloadUrlToTemp(_0x28cb52,'bizyair_result_');_0x597582=await fs[_0x55dc40(0x167)]('file://'+_0x4faa89['nativePath']);}return await executeAsModal(async()=>{const _0x25ab9c=_0x55dc40;await app[_0x25ab9c(0x163)](_0x597582);},{'commandName':_0x55dc40(0x1c1)}),{'success':!![]};}catch(_0x415d3e){return{'success':![],'error':_0x415d3e['message']};}}async function placeImageFromUrl(_0x1d41d2,_0x3c29bb=![]){const _0x30bf90=a0_0x5e796a;try{let _0x5be1a5;if(_0x1d41d2['startsWith'](_0x30bf90(0x153)))_0x5be1a5=await fs[_0x30bf90(0x167)](_0x1d41d2);else{const _0x2a219f=await downloadUrlToTemp(_0x1d41d2,_0x30bf90(0x162));_0x5be1a5=await fs[_0x30bf90(0x167)](_0x30bf90(0x153)+_0x2a219f['nativePath']);}return await executeAsModal(async _0x278099=>{const _0x238a2c=_0x30bf90,_0x13c6d1=app[_0x238a2c(0x179)],_0x44e1ad=await fs[_0x238a2c(0x1a4)](_0x5be1a5);await batchPlay([{'_obj':_0x238a2c(0x1b0),'target':{'_path':_0x44e1ad,'_kind':_0x238a2c(0x173)},'linked':!![]}],{});const _0x392389=_0x13c6d1['activeLayers'][0x0],_0x405bff=_0x392389[_0x238a2c(0x15c)],_0xc1473d=_0x405bff[_0x238a2c(0x150)]-_0x405bff[_0x238a2c(0x1bd)],_0x2ac67a=_0x405bff[_0x238a2c(0x159)]-_0x405bff[_0x238a2c(0x14f)],_0x490511=(_0x405bff[_0x238a2c(0x1bd)]+_0x405bff[_0x238a2c(0x150)])/0x2,_0x532be4=(_0x405bff[_0x238a2c(0x14f)]+_0x405bff[_0x238a2c(0x159)])/0x2;let _0x1f2b93={'left':0x0,'top':0x0,'right':_0x13c6d1[_0x238a2c(0x17c)],'bottom':_0x13c6d1[_0x238a2c(0x1a0)]};try{const _0x2de1a0=_0x13c6d1['selection'][_0x238a2c(0x1b6)];if(_0x2de1a0)_0x1f2b93=_0x2de1a0;}catch(_0x53d716){}const _0x246b87=_0x1f2b93[_0x238a2c(0x150)]-_0x1f2b93[_0x238a2c(0x1bd)],_0x231180=_0x1f2b93['bottom']-_0x1f2b93[_0x238a2c(0x14f)],_0x597744=(_0x1f2b93['left']+_0x1f2b93[_0x238a2c(0x150)])/0x2,_0x4baa7d=(_0x1f2b93['top']+_0x1f2b93[_0x238a2c(0x159)])/0x2;let _0xf648ec=0x64,_0x556458=0x64,_0xc4eae3=_0x597744-_0x490511,_0x542bd8=_0x4baa7d-_0x532be4;!_0x3c29bb?(_0xf648ec=_0x246b87/_0xc1473d*0x64,_0x556458=_0x231180/_0x2ac67a*0x64):(_0xc4eae3=_0x13c6d1[_0x238a2c(0x17c)]/0x2-_0x490511,_0x542bd8=_0x13c6d1[_0x238a2c(0x1a0)]/0x2-_0x532be4),await batchPlay([{'_obj':_0x238a2c(0x18d),'_target':[{'_ref':'layer','_enum':_0x238a2c(0x169),'_value':'targetEnum'}],'freeTransformCenterState':{'_enum':'quadCenterState','_value':_0x238a2c(0x1aa)},'offset':{'_obj':_0x238a2c(0x151),'horizontal':{'_unit':'pixelsUnit','_value':_0xc4eae3},'vertical':{'_unit':_0x238a2c(0x1cc),'_value':_0x542bd8}},'width':{'_unit':_0x238a2c(0x1a9),'_value':_0xf648ec},'height':{'_unit':_0x238a2c(0x1a9),'_value':_0x556458},'interpolation':{'_enum':'interpolationType','_value':_0x238a2c(0x1c5)}}],{}),await batchPlay([{'_obj':'rasterizeLayer','_target':[{'_ref':'layer','_enum':_0x238a2c(0x169),'_value':'targetEnum'}]}],{});},{'commandName':_0x30bf90(0x18a)}),{'success':!![]};}catch(_0x3847ed){return{'success':![],'error':_0x3847ed[_0x30bf90(0x152)]};}}function getDocumentInfo(){const _0x1effcc=a0_0x5e796a;if(!app||!app[_0x1effcc(0x179)])return{'hasDocument':![]};const _0x18efde=app[_0x1effcc(0x179)];return{'hasDocument':!![],'width':_0x18efde[_0x1effcc(0x17c)]['value']||_0x18efde[_0x1effcc(0x17c)],'height':_0x18efde[_0x1effcc(0x1a0)][_0x1effcc(0x18f)]||_0x18efde['height']};}function startSelectionListener(_0x2a5bec){if(!action||!action['addNotificationListener'])return;let _0x38cf94=null;const _0xc40fe8=()=>{if(isProcessing)return;if(_0x2a5bec)_0x2a5bec();};action['addNotificationListener'](['all'],(_0x39b6e7,_0x4e10a5)=>{const _0x4a791b=a0_0x2c28,_0x597a91=['set',_0x4a791b(0x19b),_0x4a791b(0x19f),'make',_0x4a791b(0x1b8),_0x4a791b(0x18d),_0x4a791b(0x15a),_0x4a791b(0x157),_0x4a791b(0x18b)];if(_0x597a91[_0x4a791b(0x1a5)](_0x39b6e7)){const _0x354f65=_0x4e10a5[_0x4a791b(0x1c3)];let _0x23c436=![];_0x354f65&&Array[_0x4a791b(0x16f)](_0x354f65)&&(_0x23c436=_0x354f65[_0x4a791b(0x1bb)](_0x11e066=>_0x11e066[_0x4a791b(0x193)]===_0x4a791b(0x16e)&&(_0x11e066[_0x4a791b(0x186)]===_0x4a791b(0x174)||_0x11e066[_0x4a791b(0x154)]===_0x4a791b(0x174))||_0x11e066[_0x4a791b(0x193)]===_0x4a791b(0x174)||_0x11e066[_0x4a791b(0x193)]==='property'&&_0x11e066[_0x4a791b(0x154)]===_0x4a791b(0x174)));if(!_0x23c436){if([_0x4a791b(0x15a),_0x4a791b(0x157),'select'][_0x4a791b(0x1a5)](_0x39b6e7))_0x23c436=!![];else[_0x4a791b(0x1b8),_0x4a791b(0x18d),_0x4a791b(0x18b)]['includes'](_0x39b6e7)&&(_0x23c436=!![]);}if(_0x23c436){if(_0x38cf94)clearTimeout(_0x38cf94);_0x38cf94=setTimeout(_0xc40fe8,0x258);}}});}async function listHistoryFiles(){const _0x5edd5e=a0_0x5e796a;try{const _0x41e98=await fs[_0x5edd5e(0x1b5)](),_0x37e915=await _0x41e98[_0x5edd5e(0x1ca)](),_0x54c611=_0x37e915[_0x5edd5e(0x1c4)](_0xf1961a=>_0xf1961a[_0x5edd5e(0x1c2)]&&(_0xf1961a[_0x5edd5e(0x189)]['startsWith'](_0x5edd5e(0x190))||_0xf1961a[_0x5edd5e(0x189)][_0x5edd5e(0x1c6)](_0x5edd5e(0x16a)))&&_0xf1961a[_0x5edd5e(0x189)]['endsWith'](_0x5edd5e(0x1a6)))[_0x5edd5e(0x1a7)]((_0x3108f6,_0x209d5f)=>_0x209d5f[_0x5edd5e(0x189)][_0x5edd5e(0x170)](_0x3108f6[_0x5edd5e(0x189)]))['map'](_0x3cfe65=>_0x5edd5e(0x153)+_0x3cfe65['nativePath']);return{'success':!![],'files':_0x54c611};}catch(_0x3fb20b){return{'success':![],'error':_0x3fb20b['message']};}}async function deleteFile(_0x4d78e3){const _0x19ed50=a0_0x5e796a;try{if(_0x4d78e3[_0x19ed50(0x1c6)]('file://'))_0x4d78e3=_0x4d78e3[_0x19ed50(0x198)](_0x19ed50(0x153),'');const _0x518932=_0x4d78e3[_0x19ed50(0x185)]('/')['pop']();if(!_0x518932)return{'success':![],'error':'Invalid\x20filename'};const _0x5c3d16=await fs['getTemporaryFolder'](),_0x180598=await _0x5c3d16[_0x19ed50(0x1b3)](_0x518932);if(_0x180598)return await _0x180598['delete'](),{'success':!![]};return{'success':![],'error':'File\x20not\x20found'};}catch(_0x4bcb1a){return{'success':![],'error':_0x4bcb1a[_0x19ed50(0x152)]};}}async function clearHistoryFiles(){const _0x509f74=a0_0x5e796a;try{const _0xfc5d08=await fs['getTemporaryFolder'](),_0xc31d79=await _0xfc5d08[_0x509f74(0x1ca)](),_0x3ed94e=_0xc31d79[_0x509f74(0x1c4)](_0x36226b=>_0x36226b[_0x509f74(0x1c2)]&&(_0x36226b[_0x509f74(0x189)]['startsWith'](_0x509f74(0x190))||_0x36226b[_0x509f74(0x189)][_0x509f74(0x1c6)](_0x509f74(0x16a)))&&_0x36226b[_0x509f74(0x189)][_0x509f74(0x165)]('.png'));for(const _0x24f4c6 of _0x3ed94e){await _0x24f4c6['delete']();}return{'success':!![],'count':_0x3ed94e['length']};}catch(_0x173608){return{'success':![],'error':_0x173608['message']};}}async function readBinaryFile(_0x2c099f){const _0x489162=a0_0x5e796a;try{if(!_0x2c099f)return{'success':![],'error':'Empty\x20path'};let _0x56f124=_0x2c099f;if(_0x56f124[_0x489162(0x1c6)](_0x489162(0x153)))_0x56f124=_0x56f124[_0x489162(0x198)](_0x489162(0x153),'');const _0x56245a=_0x56f124[_0x489162(0x185)]('/')[_0x489162(0x17f)](),_0x4f3ab5=await fs[_0x489162(0x1b5)](),_0x5a837b=await _0x4f3ab5['getEntry'](_0x56245a);if(_0x5a837b&&_0x5a837b['isFile']){const _0x375ae9=await _0x5a837b[_0x489162(0x19e)]({'format':formats['binary']});return{'success':!![],'buffer':Array[_0x489162(0x178)](new Uint8Array(_0x375ae9))};}return{'success':![],'error':_0x489162(0x17e)};}catch(_0x1648bd){return{'success':![],'error':_0x1648bd[_0x489162(0x152)]};}}window[a0_0x5e796a(0x1ac)]={'getActiveDocumentImage':getActiveDocumentImage,'createDocFromUrl':createDocFromUrl,'placeImageFromUrl':placeImageFromUrl,'downloadUrlToTemp':downloadUrlToTemp,'getDocumentInfo':getDocumentInfo,'startSelectionListener':startSelectionListener,'listHistoryFiles':listHistoryFiles,'deleteFile':deleteFile,'clearHistoryFiles':clearHistoryFiles,'pickLocalFile':pickLocalFile,'readBinaryFile':readBinaryFile,'showAlert':_0x3d1c34=>app[a0_0x5e796a(0x1ba)](_0x3d1c34)};